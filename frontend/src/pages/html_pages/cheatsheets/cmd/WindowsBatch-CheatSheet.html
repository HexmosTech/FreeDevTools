<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windowsbatch Cheatsheet</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Windowsbatch Cheatsheet</h1>
        </div>
        <div class="content">
            <div class="markdown-content"><h1>Windows Batch Cheat Sheet</h1>
<p>Prefer <code>REM</code> over <code>::</code> for comments (<code>::</code> is an empty label and may cause problems).<br/>
<code>^</code> is the line continuation character.<br/>
<code>%*</code> contains all the arguments.<br/>
<code>%~nx0</code> is the name of the batch file whereas <code>%0</code> is the command used to call the batch file<br/>
<code>%~d0</code> gives the current drive, e.g. <code>F:\</code><br/>
<code>%~p0</code> gives the current path</p>
<p><code>IF "%~1"==""</code> checks if a parameter was passed. The <code>~</code> removes any surrounding quotes</p>
<p><code>SHIFT</code> changes the parameter position, e.g. <code>shift-test.bat 1 2 3 4 5 6 7 8 9 10</code></p>
<pre class="codehilite"><code class="language-bat">set LAST=%9%
shift
set AFTER_LAST=%9% &lt;--- Gets the 10th argument
echo %LAST%
echo %AFTER_LAST%
</code></pre>

<p><strong>Output</strong>:</p>
<pre class="codehilite"><code>9
10
</code></pre>

<p>Count the number of arguments and print a message if there are too few.</p>
<pre class="codehilite"><code class="language-bat">@echo off
setlocal EnableExtensions EnableDelayedExpansion

set n=0
for %%i in (%*) do (
    set /A n+=1
    set &quot;args[!n!]=%%~i&quot;
)

echo # of parameters: %n%
if /I &quot;%n%&quot; LSS &quot;4&quot; goto error
echo The first parameter is: &quot;!args[1]!&quot;
echo The fourth parameter is: &quot;!args[4]!&quot;
if /I &quot;%args[5]%&quot; == &quot;&quot; echo no 5th argument

:error
set USAGE=&quot;Usage: %~nx0 [one] [two] [three] [four]&quot;
echo %USAGE%

endlocal
</code></pre>

<h3>SETX is Persistent</h3>
<pre class="codehilite"><code class="language-bat">setx /m JAVA_HOME=C:\Program Files\Zulu\zulu-8\
</code></pre>

<p>Where the <code>/m</code> switch sets the variable system wide, e.g. <code>HKEY_LOCAL_MACHINE</code> instead of the deafulat <code>HKEY_CURRENT_USER</code>.</p>
<p><a href="https://superuser.com/a/916652/1100004">What is the difference between SETX and SET in environment variables in Windows</a></p>
<h3>Retrieve IP Address into Variable</h3>
<pre class="codehilite"><code class="language-bat">for /f &quot;delims=[] tokens=2&quot; %%a in ('ping %computername% -4 -n 1 ^| findstr &quot;[&quot;') do (set ip=%%a)
</code></pre>

<p><a href="http://stackoverflow.com/questions/5898763/how-do-i-get-the-ip-address-into-a-batch-file-variable">How do I get the IP address into a batch-file variable?</a></p>
<h3>Ant and Maven Build Shell on Portable Drive</h3>
<p>Directory structure.</p>
<pre class="codehilite"><code class="language-bat">F:\
+--.m2
+--src
|  +--project1
|  +--project2
|  +--project3
+--tools
|  +--ant
|  +--maven
|  +--jdk
\--build.bat
\--mvn_ant_env.bat
</code></pre>

<p>Set up the tools.</p>
<pre class="codehilite"><code class="language-bat">@echo Setting Maven Environment...

set MAVEN_OPTS=-Xms256M -Xmx764M
set JAVA_HOME=%~d0\tools\jdk1.8.0_131
set M2_HOME=%~d0\tools\apache-maven-3.2.3
set ANT_HOME=%~d0\tools\apache-ant-1.9.4
PATH=%PATH%;%JAVA_HOME%\bin;%M2_HOME%\bin;%ANT_HOME%\bin
title Maven and Ant Enabled Shell
cmd
</code></pre>

<p>Now build some projects.</p>
<pre class="codehilite"><code class="language-bat">set HOME=%~d0

cd src\ism_version_0.2\base
call mvn -s %HOME%\.m2\settings.xml -Dmaven.repo.local=%HOME%\.m2\repository clean install
pushd %~dp0

cd src\daas_ags_conn
call mvn -s %HOME%\.m2\settings.xml -Dmaven.repo.local=%HOME%\.m2\repository clean install
pushd %~dp0

cd src\ags6
call ant all

pushd %~dp0
</code></pre>

<h3>References</h3>
<ol>
<li><a href="http://stackoverflow.com/a/12407934/6146580">Which comment style should I use in batch files?</a></li>
<li><a href="http://stackoverflow.com/a/19837690/6146580">Batch-Script - Iterate through arguments</a></li>
<li><a href="http://stackoverflow.com/a/29886675/6146580">How do you utilize more than 9 arguments when calling a label in a CMD batch-script?</a></li>
<li><strong>Arrays</strong>: <a href="http://stackoverflow.com/a/17606350/6146580">Create list or arrays in Windows Batch</a> and <a href="http://stackoverflow.com/a/10167990/6146580">Arrays, linked lists and other data structures in cmd.exe (batch) script</a></li>
<li><a href="http://stackoverflow.com/a/382312/6146580">Get list of passed arguments in Windows batch script (.bat)</a></li>
<li><a href="http://stackoverflow.com/a/14298769/6146580">Using parameters in batch files at DOS command line</a></li>
<li><a href="https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/percent.mspx?mfr=true">Using batch parameters</a></li>
<li><a href="https://web.archive.org/web/20150313200655/http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/percent.mspx?mfr=true">Alternate: Using batch parameters</a></li>
<li><a href="https://superuser.com/a/149958/1100004">Does %* in batch file mean all command line arguments?</a></li>
<li><a href="https://stackoverflow.com/questions/112055/what-does-d0-mean-in-a-windows-batch-file">What does d0 mean</a></li>
<li><a href="https://stackoverflow.com/questions/5034076/what-does-dp0-mean-and-how-does-it-work">What does dp0 mean</a></li>
<li><a href="http://www.computerhope.com/forum/index.php?topic=54333.0">%~dp0 vs %cd%</a></li>
<li><a href="https://steve-jansen.github.io/guides/windows-batch-scripting/part-10-advanced-tricks.html">Windows Batch Scripting: Advanced Tricks</a></li>
</ol></div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>