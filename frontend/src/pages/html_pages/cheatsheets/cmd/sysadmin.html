<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux System Administration Commands - SysAdmin Guide</title>
    <meta name="description" content="Comprehensive guide to essential Linux system administration commands for managing disks, memory, permissions, and more. Learn to use mkdir, df, du, lsblk, lsof, ps, top, and chmod effectively.">
    <meta name="keywords" content="Linux commands, sysadmin, system administration, mkdir, df, du, lsblk, lsof, ps, top, chmod, disk management, memory management, file permissions, command line, bash, shell scripting">
    <link rel="canonical" href="https://yourwebsite.com/cmd/sysadmin.html">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Linux System Administration Commands - SysAdmin Guide">
    <meta property="og:description" content="Comprehensive guide to essential Linux system administration commands for managing disks, memory, permissions, and more. Learn to use mkdir, df, du, lsblk, lsof, ps, top, and chmod effectively.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourwebsite.com/cmd/sysadmin.html">
    <meta property="og:image" content="https://yourwebsite.com/images/sysadmin-og.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Linux System Administration Commands - SysAdmin Guide">
    <meta name="twitter:description" content="Comprehensive guide to essential Linux system administration commands for managing disks, memory, permissions, and more. Learn to use mkdir, df, du, lsblk, lsof, ps, top, and chmod effectively.">
    <meta name="twitter:image" content="https://yourwebsite.com/images/sysadmin-twitter.jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Linux System Administration Commands</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <h2>Command Line Utilities</h2>
                <h3>Directory Creation with `mkdir`</h3>
                <p>The <code>mkdir</code> command is fundamental for creating directories. The <code>-p</code> flag is particularly useful as it allows you to create parent directories as needed, preventing errors if intermediate directories do not exist.</p>
                <p>To create subdirectories even if the parent directories don't exist:</p>
                <pre class="codehilite"><code>$ mkdir -p /tmp/foo/bar/this/dir
</code></pre>
                <p>To create multiple directories with a single command, leveraging brace expansion for efficiency:</p>
                <p>For example, to achieve this structure:</p>
                <pre class="codehilite"><code>/disk1/ebooks/category-tech
/disk1/ebooks/category-motivation
/disk2/ebooks/category-tech
/disk2/ebooks/category-motivation
/disk3/ebooks/category-tech
/disk3/ebooks/category-motivation
</code></pre>
                <p>You can use the following command:</p>
                <pre class="codehilite"><code>mkdir -p /disk{1..5}/ebooks/category-{tech,motivation}
</code></pre>

                <h2>Disk Management Commands</h2>
                <p>Efficiently managing disk space and understanding disk usage are critical sysadmin tasks.</p>
                <h3>Checking Disk Space with `df`</h3>
                <p>To check overall disk space usage:</p>
                <pre class="codehilite"><code class="language-bash">$ df -h
</code></pre>
                <p>The <code>-h</code> flag provides human-readable output (e.g., KB, MB, GB).</p>
                <h3>Viewing Directory Sizes with `du`</h3>
                <p>To see the size of consumption per directory:</p>
                <pre class="codehilite"><code class="language-bash">$ du -sh /path/to/dirs/*
</code></pre>
                <p>The <code>-s</code> flag summarizes the total size for each argument, and <code>-h</code> makes the output human-readable.</p>
                <h3>Mapping Disks with `lsblk`</h3>
                <p>To view disk and SATA input mappings (where 0 typically represents the first port):</p>
                <pre class="codehilite"><code class="language-bash">$ lsblk -o NAME,MODEL,SERIAL,WWN,HCTL
NAME   MODEL              SERIAL   WWN                HCTL
sda    ST4000D0000-000000 XXXXXXXX 0x5000c50000000000 0:0:0:0
sdb    ST4000D0000-000000 XXXXXXXX 0x5000c50000000000 1:0:0:0
└─sdb1                             0x5000c50000000000
sdc    ST4000D0000-000000 XXXXXXXX 0x5000c50000000000 2:0:0:0
└─sdc1                             0x5000c50000000000
</code></pre>
                <p>This command provides detailed information about block devices, including their model, serial number, and host controller target (HCTL).</p>

                <h3>Troubleshooting Unmount Issues</h3>
                <p>When a disk cannot be unmounted, it's usually because it's still in use by one or more processes.</p>
                <pre class="codehilite"><code class="language-bash">umount /data
umount: /data: target is busy.
</code></pre>
                <p>To identify which processes are using a directory, use the <code>lsof</code> (list open files) command. Running <code>sudo lsof /data</code> will list all processes accessing files within the <code>/data</code> directory.</p>
                <pre class="codehilite"><code class="language-bash">sudo lsof /data
COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF     NODE NAME
sudo    21204 root  cwd    DIR  259,3     4096 27525121 /data/tmp
bash    28594 root  cwd    DIR  259,3     4096 27525121 /data/tmp
</code></pre>
                <p>In the example above, a shell session (<code>bash</code> with PID 28594) was actively using the <code>/data/tmp</code> directory. You can either terminate the process using <code>kill 28594</code> or switch to that session and exit the directory.</p>

                <h2>Memory Management and Monitoring</h2>
                <p>Understanding memory usage is crucial for system performance tuning.</p>
                <ul>
                    <li><strong>Free Memory</strong>: This is the memory not currently allocated to any process. A very low amount of free memory isn't necessarily bad, as unused RAM is often wasted.</li>
                    <li><strong>Available Memory</strong>: This represents the memory that can be readily allocated to new or existing processes without resorting to swapping.</li>
                </ul>
                <h3>Memory Statistics and Tools</h3>
                <p>Understanding the difference between VSZ (Virtual Set Size) and RSS (Resident Set Size):</p>
                <pre class="codehilite"><code>The Virtual Set Size (VSZ) is the total amount of virtual memory assigned to a process. It includes all memory the process can access, including swapped-out memory and shared libraries.

The Resident Set Size (RSS) is the amount of physical RAM currently used by a process. This is a more accurate measure of the actual memory footprint of a process.
</code></pre>
                <p>Using <code>ps</code> to sort processes by memory usage (RSS):</p>
                <pre class="codehilite"><code>$ ps aux --sort -rss
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root      2124  0.1 11.4 422028 232864 ?       Ssl  Mar19   0:35 /bin/thanos
</code></pre>
                <p>Examining memory information via <code>/proc/meminfo</code>:</p>
                <pre class="codehilite"><code>$ cat /proc/meminfo
MemTotal:       16424260 kB
MemFree:          173988 kB
MemAvailable:   13493104 kB
Buffers:          253116 kB
Cached:         12950152 kB
</code></pre>
                <p>Using <code>vmstat</code> for system statistics:</p>
                <pre class="codehilite"><code>$ vmstat -s
16424260 K total memory
  2598624 K used memory
  3701676 K active memory
11821540 K inactive memory
   328008 K free memory
   253208 K buffer memory
 13244420 K swap cache
</code></pre>
                <p>Using <code>top</code> for real-time process monitoring:</p>
                <pre class="codehilite"><code>$ top -n 1 -b
top - 07:50:06 up 13 days, 22:22,  1 user,  load average: 0.06, 0.07, 0.02
Tasks: 124 total,   1 running,  73 sleeping,   0 stopped,   0 zombie
%Cpu(s):  2.0 us,  0.4 sy,  0.0 ni, 97.3 id,  0.0 wa,  0.0 hi,  0.2 si,  0.0 st
KiB Mem : 16424260 total,   249368 free,  2597924 used, 13576968 buff/cache
KiB Swap:        0 total,        0 free,        0 used. 13490404 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
15482 user      20   0 7949520 2.150g  24408 S  37.5 13.7  40:35.70 java
</code></pre>
                <p>Explanation of key metrics in <code>top</code>:</p>
                <pre class="codehilite"><code>%MEM: Percentage of physical memory used by the process, directly related to RES.
VIRT: Virtual memory size, encompassing all memory the process can access (shared, swapped, etc.).
RES: Resident Set Size, the amount of physical RAM the process is currently using.
SHR: Shared memory size, the amount of physical shared memory the process can access.
</code></pre>
                <p>To get detailed memory usage per process, you can use the <code>ps_mem.py</code> script:</p>
                <pre class="codehilite"><code>$ wget https://raw.githubusercontent.com/pixelb/ps_mem/master/ps_mem.py
$ sudo python ps_mem.py
</code></pre>

                <h2>File and Directory Permissions</h2>
                <p>Managing permissions is essential for system security and access control.</p>
                <h3>Setting Permissions with `chmod` and Ownership with `chown`</h3>
                <p>Example commands for setting permissions and ownership:</p>
                <pre class="codehilite"><code>$ sudo chmod 755 /disk
$ sudo chown -R ubuntu:ubuntu /disk
$ sudo find /disk/2/htpc -type f -print -exec chmod 644 {} \;
$ sudo find /disk/2/htpc -type d -print -exec chmod 755 {} \;
</code></pre>
                <p><code>chmod 755</code> grants read, write, and execute permissions to the owner, and read and execute to group and others. <code>chown -R</code> recursively changes the owner and group. The <code>find</code> command with <code>-exec</code> allows applying permissions to files (<code>644</code>) and directories (<code>755</code>) selectively.</p>

                <h3>External Resources for Further Learning</h3>
                <ul>
                    <li><a href="https://www.tummy.com/articles/isolating-heavy-load/" target="_blank" rel="noopener noreferrer">Isolating Heavy Load</a></li>
                    <li><a href="https://bobcares.com/blog/high-cpu-utilization/" target="_blank" rel="noopener noreferrer">High CPU Utilization Troubleshooting</a></li>
                    <li><a href="https://coderwall.com/p/utc42q/understanding-iostat" target="_blank" rel="noopener noreferrer">Understanding iostat</a></li>
                    <li><a href="https://www.techrepublic.com/article/how-to-use-the-linux-iostat-command-to-check-on-your-storage-subsystem/" target="_blank" rel="noopener noreferrer">Using the Linux iostat Command</a></li>
                    <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h1" target="_blank" rel="noopener noreferrer">MDN Web Docs: h1 Element</a></li>
                    <li><a href="https://www.w3.org/TR/html52/" target="_blank" rel="noopener noreferrer">W3C HTML5 Specification</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>
