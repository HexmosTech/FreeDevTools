<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iptables Command Examples - Network Firewall Rules</title>
    <meta name="description" content="Learn essential iptables commands for network firewall management. Explore examples for blocking ports, adding comments, and managing rules with auto-refresh and line numbers.">
    <meta name="keywords" content="iptables, firewall, network security, linux firewall, iptables commands, block port, manage rules, network rules, iptables examples, iptables tutorial">
    <link rel="canonical" href="https://yourdomain.com/cmd/iptables.html">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Iptables Command Examples - Network Firewall Rules">
    <meta property="og:description" content="Learn essential iptables commands for network firewall management. Explore examples for blocking ports, adding comments, and managing rules with auto-refresh and line numbers.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/cmd/iptables.html">
    <meta property="og:image" content="https://yourdomain.com/images/iptables-og.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Iptables Command Examples - Network Firewall Rules">
    <meta name="twitter:description" content="Learn essential iptables commands for network firewall management. Explore examples for blocking ports, adding comments, and managing rules with auto-refresh and line numbers.">
    <meta name="twitter:image" content="https://yourdomain.com/images/iptables-twitter.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Iptables Command Examples</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <p>Iptables is a powerful command-line utility for configuring the Linux kernel firewall. It allows administrators to define rules for packet filtering, network address translation (NAT), and other packet mangling operations. Mastering iptables is crucial for securing Linux-based systems and managing network traffic effectively.</p>

                <h2>Monitor Firewall Rule Hits</h2>
                <p>Understanding how often your firewall rules are being hit is essential for performance tuning and security analysis. The <code>watch</code> command combined with <code>iptables -nvL</code> provides a dynamic view of packet and byte counters for each rule.</p>
                <pre><code class="language-bash"># To show hit counts for rules with auto-refresh:
watch --interval 0 'iptables -nvL | grep -v "0     0"'

# To show hit counts for rules with auto-refresh and highlight any changes:
watch -d -n 2 iptables -nvL</code></pre>

                <h2>Block Specific Ports and Hide from Scans</h2>
                <p>Blocking unwanted incoming connections is a fundamental security practice. Iptables can be used to reject traffic to specific ports. Using the <code>--reject-with icmp-port-unreachable</code> option not only blocks the port but also makes it appear closed to port scanners like Nmap, enhancing stealth.</p>
                <pre><code class="language-bash"># To block port 902 on eth0 and hide this port from nmap:
iptables -A INPUT -i eth0 -p tcp --dport 902 -j REJECT --reject-with icmp-port-unreachable

# Explanation of --reject-with options:
# icmp-net-unreachable: Network unreachable
# icmp-host-unreachable: Host unreachable
# icmp-port-unreachable: Port unreachable (hides port from nmap)
# icmp-proto-unreachable: Protocol unreachable
# icmp-net-prohibited: Network prohibited
# icmp-host-prohibited: Host prohibited
# icmp-admin-prohibited: Administratively prohibited
# tcp-reset: Sends a TCP RST packet</code></pre>

                <h2>Add Comments to Firewall Rules</h2>
                <p>As your firewall configuration grows, it becomes increasingly important to document the purpose of each rule. Iptables allows you to add comments to rules, making them easier to understand and manage.</p>
                <pre><code class="language-bash"># To add a comment to a rule:
iptables ... -m comment --comment "This rule is here for this specific reason"</code></pre>

                <h2>Manage Firewall Rules by Line Number</h2>
                <p>Modifying existing rules or inserting new ones at specific positions is often necessary. Iptables provides options to list rules with line numbers and to delete or insert rules based on these numbers.</p>
                <pre><code class="language-bash"># 1) Show all rules in the INPUT chain with line numbers:
iptables -L INPUT --line-numbers
# Alternatively, use the -n option for numeric output:
iptables -nL --line-numbers

# Example output:
# Chain INPUT (policy ACCEPT)
#     num  target prot opt source destination
#     1    ACCEPT     udp  --  anywhere  anywhere             udp dpt:domain
#     2    ACCEPT     tcp  --  anywhere  anywhere             tcp dpt:domain
#     3    ACCEPT     udp  --  anywhere  anywhere             udp dpt:bootps
#     4    ACCEPT     tcp  --  anywhere  anywhere             tcp dpt:bootps

# 2.a) REMOVE (-D) a rule by its line number (e.g., remove rule number 2 from INPUT chain):
iptables -D INPUT 2

# 2.b) INSERT a rule at a specific line number.
# Example: Insert a rule at line 3 in the INPUT chain to accept TCP traffic on port 21 from a specific IP address:
iptables -I INPUT 3 -i eth1 -p tcp --dport 21 -s 123.123.123.123 -j ACCEPT -m comment --comment "Allow FTP from specific IP"</code></pre>

                <h2>Further Reading on Network Security</h2>
                <p>For a deeper understanding of network security and firewall best practices, consult the following resources:</p>
                <ul>
                    <li><a href="https://man7.org/linux/man-pages/man8/iptables.8.html" target="_blank" rel="noopener noreferrer">Iptables Man Page</a> - Official documentation for iptables.</li>
                    <li><a href="https://www.netfilter.org/documentation/index.html" target="_blank" rel="noopener noreferrer">Netfilter Documentation</a> - Information about the Netfilter framework, which iptables is part of.</li>
                    <li><a href="https://www.linux.com/training-tutorials/linux-firewall-basics-using-iptables/" target="_blank" rel="noopener noreferrer">Linux Firewall Basics using Iptables</a> - A tutorial on fundamental iptables usage.</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>