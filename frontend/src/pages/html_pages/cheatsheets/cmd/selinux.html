<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SELinux Commands - Manage and Troubleshoot Security Contexts</title>
    <meta name="description" content="Learn essential SELinux commands to manage security contexts, booleans, and troubleshoot access issues. Includes commands for status, file contexts, and module creation.">
    <meta name="keywords" content="SELinux, security contexts, getenforce, sestatus, setenforce, ls -Z, ps -Z, getsebool, semanage, restorecon, audit2allow, sealert, Linux security, access control">
    <link rel="canonical" href="https://yourdomain.com/cmd/selinux.html">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="SELinux Commands - Manage and Troubleshoot Security Contexts">
    <meta property="og:description" content="Learn essential SELinux commands to manage security contexts, booleans, and troubleshoot access issues. Includes commands for status, file contexts, and module creation.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/cmd/selinux.html">
    <meta property="og:image" content="https://yourdomain.com/path/to/og-image.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SELinux Commands - Manage and Troubleshoot Security Contexts">
    <meta name="twitter:description" content="Learn essential SELinux commands to manage security contexts, booleans, and troubleshoot access issues. Includes commands for status, file contexts, and module creation.">
    <meta name="twitter:image" content="https://yourdomain.com/path/to/twitter-image.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>SELinux Commands</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <p>SELinux (Security-Enhanced Linux) is a security architecture for Linux that provides a flexible mandatory access control (MAC) system. Understanding and managing SELinux is crucial for securing your Linux systems. This guide provides essential commands for checking SELinux status, managing file contexts, booleans, and troubleshooting common issues.</p>

                <h2>Check SELinux Status</h2>
                <p>To determine the current state of SELinux on your system, you can use the following commands:</p>
                <pre><code class="language-bash"># To get the current SELinux mode (Enforcing, Permissive, or Disabled)
getenforce
# or
sestatus
# To view the persistent SELinux configuration
cat /etc/selinux/config</code></pre>

                <h2>Manage SELinux Modes</h2>
                <p>You can temporarily switch SELinux to permissive mode, which logs policy violations but does not enforce them. This is useful for troubleshooting.</p>
                <pre><code class="language-bash"># To set the SELinux status to permissive (temporary)
setenforce 0</code></pre>

                <h2>Manage File and Process Contexts</h2>
                <p>SELinux uses security contexts to define access controls. These commands help you view and manage them.</p>
                <pre><code class="language-bash"># To get the security context of files
ls -Z
# To get the security context of running processes
ps -Z
# To get the security context of network sockets
ss -Z
# To get the security context of users
id -Z</code></pre>

                <h2>Manage SELinux Booleans</h2>
                <p>SELinux booleans are on/off switches that control specific SELinux policy behaviors without requiring a full policy recompile.</p>
                <pre><code class="language-bash"># To list all available SELinux booleans and their current states
getsebool -a

# To set a boolean to a specific state (e.g., 1 for on, 0 for off) and make it permanent
setsebool foo_bar 1 -P

# To view booleans that have been changed from their defaults
sudo cat /var/lib/selinux/targeted/active/booleans.local</code></pre>

                <h2>Manage SELinux File Contexts</h2>
                <p>This section covers commands for setting and restoring file security contexts.</p>
                <pre><code class="language-bash"># To manually set a specific security context for a file
sudo chcon -t foo_bar_t /foo/bar/baz.txt

# To restore the default SELinux context for files and directories recursively
sudo restorecon -vR /foo/bar/

# To define a persistent file context rule using semanage
sudo semanage fcontext -a -t httpd_sys_content_t "/foo(/.*)?"

# Alternatively, to map an existing directory's context to a new location
sudo semanage -a -e /var/www/html /foo

# After using semanage, always run restorecon to apply the new contexts
sudo restorecon -vR /foo</code></pre>

                <h2>Troubleshoot SELinux Issues</h2>
                <p>When SELinux denies access, the `setroubleshoot` package can help diagnose the problem.</p>
                <pre><code class="language-bash"># First, install the setroubleshoot packages
sudo dnf install setroubleshoot setroubleshoot-server

# Check system logs for SELinux denial messages
sudo journalctl -t setroubleshoot</code></pre>

                <h2>Create SELinux Modules</h2>
                <p>For more complex policy adjustments, you can create custom SELinux modules.</p>
                <pre><code class="language-bash"># To create a module, it's often best to start in permissive mode to capture all denials
sudo setenforce 0

# Monitor the audit log for SELinux denials
sudo journalctl
# Search for relevant denials and use audit2allow to generate a policy module
grep foobar /var/log/audit/audit.log | audit2allow -M mypol

# Install the generated SELinux policy module
sudo semodule -i mypol.pp</code></pre>

                <h2>Graphical SELinux Tools</h2>
                <p>For users who prefer a graphical interface, SELinux management tools are available.</p>
                <pre><code class="language-bash"># Install the SELinux GUI tools
sudo dnf install policycoreutils-gui</code></pre>

                <p>By mastering these SELinux commands, you can effectively manage and secure your Linux environment.</p>

                <h2>External Resources</h2>
                <ul>
                    <li><a href="https://selinuxproject.org/page/Main_Page" target="_blank" rel="noopener noreferrer">SELinux Project</a></li>
                    <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_guide/using-selinux" target="_blank" rel="noopener noreferrer">Red Hat Enterprise Linux SELinux Guide</a></li>
                    <li><a href="https://linux-audit.com/how-to-use-audit2allow-to-create-selinux-policy-modules/" target="_blank" rel="noopener noreferrer">Using audit2allow to Create SELinux Policy Modules</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>