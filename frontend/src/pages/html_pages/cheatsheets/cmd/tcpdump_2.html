<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tcpdump Command Examples - Network Packet Analysis</title>
    <meta name="description" content="Explore essential tcpdump command examples for network packet analysis. Learn to capture, filter, and inspect network traffic effectively with this powerful command-line tool.">
    <meta name="keywords" content="tcpdump, network analysis, packet capture, network traffic, command line, linux, unix, network troubleshooting, packet sniffer, tcpdump examples">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://your-website.com/cmd/tcpdump_2.html">
    <meta property="og:title" content="Tcpdump Command Examples - Network Packet Analysis">
    <meta property="og:description" content="Explore essential tcpdump command examples for network packet analysis. Learn to capture, filter, and inspect network traffic effectively with this powerful command-line tool.">
    <meta property="og:image" content="https://your-website.com/path/to/og-image.jpg">
    <meta property="og:url" content="https://your-website.com/cmd/tcpdump_2.html">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Tcpdump Command Examples - Network Packet Analysis">
    <meta name="twitter:description" content="Explore essential tcpdump command examples for network packet analysis. Learn to capture, filter, and inspect network traffic effectively with this powerful command-line tool.">
    <meta name="twitter:image" content="https://your-website.com/path/to/twitter-image.jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Tcpdump Command Examples</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <p>Tcpdump is a powerful command-line packet analyzer that allows users to intercept and display TCP/IP and other packets being transmitted or received over a network. It's an essential tool for network troubleshooting, security analysis, and understanding network behavior.</p>
                
                <h2>Basic Packet Interception</h2>
                <p>Intercepting all packets on a specific network interface is a fundamental use case. The <code>-i</code> flag specifies the interface.</p>
                <pre><code class="language-bash"># Intercepts all packets on eth0
tcpdump -i eth0</code></pre>

                <h2>Filtering Traffic by Host</h2>
                <p>You can easily filter traffic to and from specific IP addresses. This is crucial for isolating communication related to a particular server or client.</p>
                <pre><code class="language-bash"># Intercepts all packets from/to 173.194.40.120 (e.g., google.com)
tcpdump host 173.194.40.120</code></pre>

                <h2>Advanced Filtering with Port and Host</h2>
                <p>Combine host and port filters for more precise traffic capture. The <code>-nn</code> option prevents name resolution, showing raw IP addresses and port numbers.</p>
                <pre><code class="language-bash"># Intercepts all packets on all interfaces from / to 173.194.40.120 port 80
# -nn => Disables name resolution for IP addresses and port numbers.
tcpdump -nn -i any host 173.194.40.120 and port 80</code></pre>

                <h2>Analyzing Packet Content with Grep and Ngrep</h2>
                <p>To inspect the actual data within packets, you can pipe tcpdump's output to tools like <code>grep</code> or use <code>ngrep</code> directly. The <code>-A</code> flag shows packet content in ASCII.</p>
                <pre><code class="language-bash"># Make a grep on tcpdump (ASCII)
# -A => Show only ASCII in packets.
# -s snaplen => Capture only snaplen bytes of data from each packet.
#    By default, tcpdump captures 262144 bytes.
#    Packets truncated because of a limited snapshot are indicated in the
#    output with '[|protocol]'.
tcpdump -i any -A host 173.194.40.120 and port 80 | grep 'User-Agent'

# With ngrep
# -d eth0 => To force eth0 (else ngrep work on all interfaces)
# -s0 => force ngrep to look at the entire packet. (Default snaplen: 65536 bytes)
ngrep 'User-Agent' host 173.194.40.120 and port 80</code></pre>

                <h2>Capturing Traffic to Multiple Hosts or Ports</h2>
                <p>Tcpdump supports complex filtering logic using parentheses and logical operators like <code>or</code> and <code>and</code>.</p>
                <pre><code class="language-bash"># Intercepts all packets on all interfaces from / to 8.8.8.8 or 173.194.40.127 on port 80
tcpdump 'host ( 8.8.8.8 or 173.194.40.127 ) and port 80' -i any</code></pre>

                <h2>Filtering TCP Flags</h2>
                <p>Tcpdump allows filtering based on TCP flags, which is essential for analyzing connection states.</p>
                <pre><code class="language-bash"># Intercepts all packets SYN and FIN of each TCP session.
tcpdump 'tcp[tcpflags] & (tcp-syn|tcp-fin) != 0'

# To display SYN and FIN packets of each TCP session to a host that is not on our network
tcpdump 'tcp[tcpflags] & (tcp-syn|tcp-fin) != 0 and not src and dst net local_addr'

# To display all IPv4 HTTP packets that come or arrive on port 80 and that contain only data (no SYN, FIN no, no packet containing an ACK)
tcpdump 'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)'</code></pre>

                <h2>Saving and Reading Captured Data</h2>
                <p>You can save captured packets to a file for later analysis using the <code>-w</code> flag and read from a capture file with the <code>-r</code> flag.</p>
                <pre><code class="language-bash"># Saving captured data
tcpdump -w file.cap

# Reading from capture file
tcpdump -r file.cap</code></pre>

                <h2>Displaying Packet Content in Hexadecimal</h2>
                <p>Viewing packet data in hexadecimal format can be useful for deep inspection.</p>
                <pre><code class="language-bash"># Show content in hexa
# Change -x to -xx => show extra header (ethernet).
tcpdump -x

# Show content in hexa and ASCII
# Change -X to -XX => show extra header (ethernet).
tcpdump -X</code></pre>

                <h2>Understanding Packet Matching Syntax</h2>
                <p>Tcpdump offers a flexible syntax for defining packet filters. Here are some common examples for port and host matching:</p>
                <pre><code class="language-bash"># Note on packet matching:
# Port matching:
# - portrange 22-23
# - not port 22
# - port ssh
# - dst port 22
# - src port 22
#
# Host matching:
# - dst host 8.8.8.8
# - not dst host 8.8.8.8
# - src net 67.207.148.0 mask 255.255.255.0
# - src net 67.207.148.0/24
</code></pre>

                <h2>Further Resources</h2>
                <p>For more in-depth information and advanced usage, consult the official tcpdump documentation and related network analysis resources.</p>
                <ul>
                    <li><a href="https://www.tcpdump.org/manpages/tcpdump.1.html" target="_blank" rel="noopener noreferrer">Tcpdump Man Page</a></li>
                    <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Identifying_the_user_agent" target="_blank" rel="noopener noreferrer">Understanding User-Agent Strings</a></li>
                    <li><a href="https://www.wireshark.org/docs/dfref/t/tcp.html" target="_blank" rel="noopener noreferrer">Wireshark TCP Protocol Reference</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>