<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bash Cheatsheet - Command Line Utilities & Scripting</title>
    <meta name="description" content="Comprehensive Bash cheatsheet covering essential commands, one-liners, if statements, loops, functions, and output redirection for efficient shell scripting.">
    <meta name="keywords" content="bash, shell scripting, command line, cheatsheet, iptables, if statements, while loops, for loops, functions, redirecting output, tr command, bash commands">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://yourdomain.com/cmd/bash_4.html">
    <meta property="og:title" content="Bash Cheatsheet - Command Line Utilities & Scripting">
    <meta property="og:description" content="Comprehensive Bash cheatsheet covering essential commands, one-liners, if statements, loops, functions, and output redirection for efficient shell scripting.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://yourdomain.com/cmd/bash_4.html">
    <meta property="og:image" content="https://yourdomain.com/path/to/bash-cheatsheet-image.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Bash Cheatsheet - Command Line Utilities & Scripting">
    <meta name="twitter:description" content="Comprehensive Bash cheatsheet covering essential commands, one-liners, if statements, loops, functions, and output redirection for efficient shell scripting.">
    <meta name="twitter:image" content="https://yourdomain.com/path/to/bash-cheatsheet-image.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Bash Cheatsheet</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <h2>Bash Scripting Essentials</h2>
                <p>This Bash cheatsheet provides a quick reference for common command-line utilities and scripting techniques. Master these to enhance your productivity and efficiency in the Linux/Unix environment.</p>
                <p>Explore essential Bash concepts:</p>
                <ul>
                    <li><a href="#one-liners">Useful One-Liners</a></li>
                    <li><a href="#block-bad-ips">Blocking Malicious IPs</a></li>
                    <li><a href="#if-statements">Conditional Logic (If Statements)</a></li>
                    <li><a href="#check-if-args-are-passed">Argument Handling</a></li>
                    <li><a href="#check-if-required-variables-exist">Variable Existence Checks</a></li>
                    <li><a href="#check-if-environment-variables-exists">Environment Variable Checks</a></li>
                    <li><a href="#while-loops">Looping Constructs (While Loops)</a></li>
                    <li><a href="#run-process-for-5-seconds">Time-Limited Process Execution</a></li>
                    <li><a href="#redirecting-outputs">Advanced Output Redirection</a></li>
                    <li><a href="#stdout-stderr">Standard Output and Standard Error</a></li>
                </ul>

                <h2>Core Bash Commands</h2>
                <h3>The `tr` Command for Text Transformation</h3>
                <p>The `tr` command is a powerful utility for translating or deleting characters. It's invaluable for text manipulation in scripts.</p>
                <p>Example: Removing whitespace from a string:</p>
                <pre><code class="language-bash">$ echo 'foo - bar' | tr -d '[:space:]'
foo-bar</code></pre>

                <p>Example: Converting text to uppercase:</p>
                <pre><code class="language-bash">$ echo 'HeLLo' | tr '[:lower:]' '[:upper:]'
HELLO</code></pre>

                <h2>Practical Bash One-Liners</h2>
                <h3>Automated IP Blocking with `iptables`</h3>
                <p>This section demonstrates how to parse log files to identify and block malicious IP addresses using `iptables`, a fundamental firewall utility.</p>
                <p>First, extract suspicious IP addresses from a mail log:</p>
                <pre><code class="language-bash">$ cat /var/log/maillog | grep 'lost connection after AUTH from unknown' | tail -n 5
May 10 11:19:49 srv4 postfix/smtpd[1486]: lost connection after AUTH from unknown[185.36.81.145]
May 10 11:21:41 srv4 postfix/smtpd[1762]: lost connection after AUTH from unknown[185.36.81.164]
May 10 11:21:56 srv4 postfix/smtpd[1762]: lost connection after AUTH from unknown[175.139.231.129]
May 10 11:23:51 srv4 postfix/smtpd[1838]: lost connection after AUTH from unknown[185.211.245.170]
May 10 11:24:02 srv4 postfix/smtpd[1838]: lost connection after AUTH from unknown[185.211.245.170]</code></pre>

                <p>Isolate just the IP addresses:</p>
                <pre><code class="language-bash">cat /var/log/maillog | grep 'lost connection after AUTH from unknown' | cut -d'[' -f3 | cut -d ']' -f1 | tail -n5
185.36.81.164
175.139.231.129
185.211.245.170
185.211.245.170
185.36.81.173</code></pre>

                <p>Obtain a unique list of these IPs:</p>
                <pre><code class="language-bash">$ cat /var/log/maillog | grep 'lost connection after AUTH from unknown' | cut -d'[' -f3 | cut -d ']' -f1 | sort | uniq
103.194.70.16
112.196.77.202
113.172.210.19
113.173.182.119
139.59.224.234</code></pre>

                <p>Apply the `iptables` rule to block each identified IP on port 25 (SMTP):</p>
                <pre><code class="language-bash">$ for ip in $(cat /var/log/maillog | grep 'lost connection after AUTH from unknown' | cut -d'[' -f3 | cut -d ']' -f1 | sort | uniq); do iptables -I INPUT -s ${ip} -p tcp --dport 25 -j DROP; done</code></pre>

                <h2>Conditional Logic in Bash</h2>
                <h3>Checking for Command-Line Arguments</h3>
                <p>Ensure your scripts receive the necessary input by checking if arguments have been provided.</p>
                <pre><code class="language-bash">if [[ $# -eq 0 ]] ; then
    echo 'Error: No arguments provided. Please supply arguments.'
    exit 1
fi
echo 'Arguments received.'</code></pre>

                <h3>Validating Specific Argument Values</h3>
                <p>Verify that the first argument meets specific criteria.</p>
                <pre><code class="language-bash">if [ "$1" == "one" ] || [ "$1" == "two" ]
then
  echo "Argument 1 is either 'one' or 'two'."
  exit 0
else
  echo "Error: Argument 1 must be 'one' or 'two'."
  exit 1
fi
</code></pre>

                <p>Alternatively, check if a variable is set:</p>
                <pre><code class="language-bash">NAME=${1}
if [ -z "${NAME}" ]
  then
    echo "Error: NAME variable is undefined."
    exit 1
  else
    echo "Hello, ${NAME}!"
fi
</code></pre>

                <h3>Verifying Environment Variable Existence</h3>
                <p>Ensure critical environment variables are set before proceeding.</p>
                <pre><code class="language-bash">if [ -z "${OWNER}" ] || [ -z "${NAME}" ]
then
  echo "Error: Required environment variables (OWNER, NAME) are not set."
  exit 1
else
  echo "Required environment variables are present."
fi
</code></pre>

                <h2>Bash Loops for Automation</h2>
                <h3>Executing a Process for a Fixed Duration</h3>
                <p>Control the execution time of background processes using `while` loops and `sleep`.</p>
                <pre><code class="language-bash">set -ex
count=0
echo "Starting process..."
ping localhost &amp; # Start ping in the background
while [ $count -le 5 ]
  do
    sleep 1
    count=$((count + 1))
    echo "Running for: $count seconds"
  done
ps aux | grep ping # Verify the process is running
echo "Process duration complete."
kill $! # Terminate the background process
sleep 2
echo "Process stopped."
</code></pre>

                <h3>Looping Until a State Change with a Timeout</h3>
                <p>Implement robust waiting mechanisms that handle state changes and prevent indefinite execution.</p>
                <pre><code class="language-bash">UPDATE_COMPLETE=false
UPDATE_STATUS="running" # Initial status
MAX_RETRIES=10
current_retry=0

while [ "$UPDATE_COMPLETE" = false ] &amp;&amp; [ "$current_retry" -lt "$MAX_RETRIES" ]
    do
        echo "Checking update status... Retry: $((current_retry + 1))/$MAX_RETRIES"
        sleep 1
        current_retry=$((current_retry + 1))

        # Simulate status checks
        if [ "$current_retry" -eq 7 ]; then
            UPDATE_STATUS="successful"
        fi

        if [ "$UPDATE_STATUS" == "running" ]; then
            echo "Update is still running."
        elif [ "$UPDATE_STATUS" == "successful" ]; then
            UPDATE_COMPLETE=true
            echo "Update completed successfully."
        else
            echo "Error: Unexpected update status '$UPDATE_STATUS'."
            exit 1
        fi
    done

if [ "$UPDATE_COMPLETE" = false ]; then
    echo "Error: Update timed out after $MAX_RETRIES seconds."
    exit 1
fi
echo "Final status confirmed."
</code></pre>

                <h2>`for` Loops for Iteration</h2>
                <h3>Batch Loading Docker Images</h3>
                <p>Efficiently load multiple Docker images from `.tar` files using a `for` loop.</p>
                <pre><code class="language-bash">for image_tar in *.tar; do
  if [ -f "$image_tar" ]; then
    echo "Loading Docker image: $image_tar"
    docker load -i "$image_tar"
  fi
done
</code></pre>

                <h2>Bash Functions for Reusability</h2>
                <p>Encapsulate logic into functions to promote code reuse and modularity.</p>
                <p>Function to greet a user:</p>
                <pre><code class="language-bash">greet_user(){
    local user_name=${1}
    echo "Hello, ${user_name}!"
}
greet_user "Alice"
</code></pre>

                <p>Function accepting multiple arguments:</p>
                <pre><code class="language-bash">display_message(){
    echo "Message: $@"
}
display_message "This is the first part." "And this is the second."
</code></pre>

                <h2>Advanced Output Redirection</h2>
                <h3>Managing Standard Output (stdout) and Standard Error (stderr)</h3>
                <p>Gain fine-grained control over where your command outputs go.</p>
                <p>Discarding standard error:</p>
                <pre><code class="language-bash">grep -irl faker . 2&gt;/dev/null</code></pre>

                <p>Redirecting stdout to one file and stderr to another:</p>
                <pre><code class="language-bash">grep -irl faker . &gt; output.log 2&gt; error.log</code></pre>

                <p>Redirecting stderr to stdout, then redirecting combined output to a file:</p>
                <pre><code class="language-bash">grep -irl faker . &gt; combined_output.log 2&gt;&amp;1</code></pre>

                <p>Redirecting both stdout and stderr to a single file:</p>
                <pre><code class="language-bash">grep -irl faker . &amp;&gt; all_output.log</code></pre>

                <h2>Text Manipulation Techniques</h2>
                <h3>Extracting Substrings from Strings</h3>
                <p>Bash provides efficient ways to manipulate string variables.</p>
                <p>Remove the first 3 characters from a string:</p>
                <pre><code class="language-bash">$ STRING="abcdefghij"
$ echo "${STRING:3}"
defghij</code></pre>

                <h3>Extracting the Last Characters of a String</h3>
                <p>Isolate the trailing characters of a string.</p>
                <p>Using parameter expansion to get the last 3 characters:</p>
                <pre><code class="language-bash">$ STRING="abcdefghij"
$ echo "${STRING: -3}"
hij</code></pre>
                <p>Note: The `tail -c` command can also be used for this purpose on the output of `echo`.</p>

                <p>For more advanced Bash scripting, consult the official Bash manual and resources like the <a href="https://www.gnu.org/software/bash/manual/bash.html" target="_blank" rel="noopener noreferrer">GNU Bash Reference Manual</a> and <a href="https://explainshell.com/" target="_blank" rel="noopener noreferrer">ExplainShell</a>.</p>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>