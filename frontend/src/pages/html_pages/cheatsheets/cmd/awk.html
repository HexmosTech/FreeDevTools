<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15 Awk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>15 Awk</h1>
        </div>
        <div class="content">
            <div class="markdown-content"><h1>15. <code>awk</code></h1>
<ul>
<li>command line utility to find, process and transform text files</li>
<li>the basic syntax is <code>pattern { action }</code></li>
<li>the pattern is compared with every input line. pattern can be any regular expression</li>
<li>when the pattern matches, the action is performed</li>
<li>when no pattern is provided, the action is applied to every line</li>
<li>example -&gt; <code>/^HTTP/ {print}</code><ul>
<li>every line starting with HTTP is printed</li>
</ul>
</li>
<li>there are 2 other important patterns<ul>
<li>BEGIN - specifies actions to be performed, before any line is read</li>
<li>END   - specifies actions to be performed, after all lines are read</li>
<li>Example -&gt; <code>awk 'BEGIN{print "start"} {print} END{print "end"}' file.txt</code></li>
<li>first <em>start</em> is printed, then all lines of file.txt are printed and then <em>end</em> is printed</li>
</ul>
</li>
<li>awk interprets each line as a record of fields</li>
<li>one or more consecutive spaces or tabs are considered as a single delimiter between fields</li>
<li>$1, $2, etc. represents the first field, second field, and so on.</li>
<li>$0 represents the entire input line</li>
<li>awk has 2 data types - strings and integers</li>
<li>awk internally converts variable according to context</li>
<li>awk supports associative arrays. example <code>var[key] = value</code></li>
<li>on integers, basic arithmatic operations (+-*/%) are supported. autoincrement(++) and decrement(--) is also supported.</li>
</ul>
<h2>15.1. Actions</h2>
<ul>
<li>following are few actions that can be performed</li>
</ul>
<table>
<thead>
<tr>
<th>action</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>{ print $0; }</td>
<td>print records</td>
</tr>
<tr>
<td>{ exit; }</td>
<td>ends program</td>
</tr>
<tr>
<td>{ next; }</td>
<td>skips current line</td>
</tr>
<tr>
<td>{a=$1; b="X"}</td>
<td>variable assignment</td>
</tr>
<tr>
<td>{ c[$1] = $2 }</td>
<td>array varaible assignment</td>
</tr>
<tr>
<td>{if (condition) { action } else if (condition) { action } else { action }}</td>
<td>if else conditions</td>
</tr>
<tr>
<td>{ for (i=1; i &lt; x; i++) { action } }</td>
<td>for loop</td>
</tr>
<tr>
<td>{ for (item in c) { action } }</td>
<td>for loop iterating over a list</td>
</tr>
</tbody>
</table>
<h2>15.2. Special variables</h2>
<table>
<thead>
<tr>
<th>variable</th>
<th>desc</th>
</tr>
</thead>
<tbody>
<tr>
<td>FS</td>
<td>Input field separator. can be modified</td>
</tr>
<tr>
<td>RS</td>
<td>Input record separator. default value is newline. can be modified by user</td>
</tr>
<tr>
<td>OFS</td>
<td>Output field separator. can be modified</td>
</tr>
<tr>
<td>ORS</td>
<td>Output record separator. default value is newline. can be modified by user</td>
</tr>
<tr>
<td>NF</td>
<td>Number of fields in the current line (record). cannot be updated by user</td>
</tr>
<tr>
<td>NR</td>
<td>Number of lines processed so far. cannot be updated by user</td>
</tr>
</tbody>
</table>
<p><em>Note: -F option can be used to update the input field separator -&gt; <code>awk -F":"'{ print $1 }' file.txt</code></em></p>
<h2>15.3. Examples</h2>
<ul>
<li>split up “,” (comma) separated fields and print the third field ($3)<br><code>awk -F"," '{print $2}' file.txt</code></li>
<li>print the 3rd field of a csv if the second field ($2) exists and is not empty<br><code>awk -F"," '{if ($2)print $3}' file.txt</code></li>
<li>print the last field in each line<br><code>awk -F"," '{ print $NF }' file.txt</code></li>
<li>print the line after the line matching search pattern<br><code>awk '/pattern/ { i=1; next; } {if(i) {i--; print;}}' file.txt</code></li>
<li>print the line and the 2 lines after the line matching search pattern<br><code>awk '/regexp/ {i=3;} { if(i) {i--; print;}}' file.txt</code></li>
<li>print the lines from a file starting at the line matching <em>start</em> until the line matching <em>stop</em><br><code>awk '/start/,/stop/' file.txt</code></li>
<li>count lines (wc -l)<br><code>awk 'END{print NR}' file.txt</code></li>
<li>print matching lines (grep)<br><code>awk '/pattern/'</code></li>
<li>print non matching lines (grep -v)<br><code>awk '!/pattern/'</code></li>
<li>remove duplicate consecutive lines (uniq)<br><code>awk 'a !~ $0 {print}; {a=$0}' file.txt</code></li>
<li>print first 10 lines of file (head)<br><code>awk 'NR &lt; 11' file.txt</code></li>
<li>print last 10 lines of file (tail)<br><code>awk '{vect[NR]=$0;} END{for(i=NR-9;i&lt;=NR;i++) {print vect[i];}}' file.txt</code></li>
<li>print the total number of bytes used by files<br><code>ls -l | awk '{ x += $5 } END { print "Total bytes: " x }'</code></li>
<li>read a csv(comma separated) file and print the first and third field in semicolon separated format<br><code>awk 'BEGIN{FS=",";OFS=";"}{print $1, $3}' file.txt</code></li>
</ul></div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>