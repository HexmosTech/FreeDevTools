<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promtail Relabel Convert to Capitals - Log Level Conversion Tool</title>
    <meta name="description" content="Convert log levels to lowercase using Promtail's relabeling capabilities. This tool helps standardize log levels for better analysis and filtering in Loki.">
    <meta name="keywords" content="promtail, loki, relabel, convert to capitals, log levels, lowercase, log management, log aggregation, pipeline stages, regex, template, labels">
    <link rel="canonical" href="https://your-website.com/loki/relabel-convert-to-capitals-promtail.html">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Promtail Relabel Convert to Capitals - Log Level Conversion Tool">
    <meta property="og:description" content="Convert log levels to lowercase using Promtail's relabeling capabilities. This tool helps standardize log levels for better analysis and filtering in Loki.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-website.com/loki/relabel-convert-to-capitals-promtail.html">
    <meta property="og:image" content="https://your-website.com/path/to/og-image.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Promtail Relabel Convert to Capitals - Log Level Conversion Tool">
    <meta name="twitter:description" content="Convert log levels to lowercase using Promtail's relabeling capabilities. This tool helps standardize log levels for better analysis and filtering in Loki.">
    <meta name="twitter:image" content="https://your-website.com/path/to/twitter-image.jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Promtail Relabel Convert to Capitals</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <h2>Understanding Promtail Relabeling for Log Levels</h2>
                <p>This document demonstrates how to use Promtail's relabeling configurations to convert log levels from uppercase to lowercase. This is a common requirement for standardizing log data, making it easier to filter, search, and analyze logs within Loki.</p>

                <h2>Promtail Configuration Example</h2>
                <p>Below is a Promtail configuration snippet that utilizes pipeline stages to achieve the conversion of log levels.</p>

                <pre><code class="language-yaml">server:
  http_listen_port: 9080
  grpc_listen_port: 0
positions:
  filename: /var/lib/promtail/positions.yaml
clients:
  - url: https://&lt;LOKI_USERNAME&gt;:&lt;LOKI_PASSWORD&gt;@&lt;LOKI_FQDN&gt;/loki/api/v1/push

scrape_configs:
  - job_name: nginx-info
    static_configs:
    - targets:
        - localhost
      labels:
        job: prod/nginx
        environment: production
        host: demo-app-prod
        level: info
        service_name: demo-app-prod
        __path__: /var/log/nginx/access.log

    pipeline_stages:
    # convert capital log levels to lower case
    - regex:
        expression: "(?P&lt;level&gt;(INFO|WARNING|ERROR))(.*)"
    # set captured values to lowercase
    - template:
        source: level
        template: '{{ ToLower .Value }}'
    # set the renamed values to level label
    - labels:
        level:
</code></pre>

                <h2>Explanation of Pipeline Stages</h2>
                <h3>Regex Stage for Capturing Log Levels</h3>
                <p>The first pipeline stage uses a regular expression to capture log levels that are in uppercase (INFO, WARNING, ERROR). The captured value is named 'level'.</p>

                <h3>Template Stage for Lowercasing</h3>
                <p>The second stage employs a template to convert the captured 'level' value to lowercase using the <code>ToLower</code> function.</p>

                <h3>Labels Stage for Applying Converted Levels</h3>
                <p>Finally, the <code>labels</code> stage takes the lowercased value from the 'level' source and applies it to the 'level' label, effectively standardizing the log level.</p>

                <h2>Benefits of Standardized Log Levels</h2>
                <p>Standardizing log levels to a consistent format (e.g., all lowercase) significantly improves the usability of your log aggregation system. It allows for more straightforward querying and filtering in tools like Loki, enabling faster troubleshooting and more efficient log analysis. This Promtail configuration is a practical example of how to implement such standardization.</p>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>