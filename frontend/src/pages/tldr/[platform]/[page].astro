---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import { generateTldrPlatformStaticPaths } from '../../../lib/tldr-utils';
import TldrPlatform from '../_TldrPlatform.astro';

// Generate static paths for paginated platform routes
export async function getStaticPaths() {
  return await generateTldrPlatformStaticPaths();
}

const { type, page, itemsPerPage, totalPages, commands } = Astro.props;
const { platform } = Astro.params;

// Redirect /tldr/platform/1 to /tldr/platform
if (type === 'pagination' && page === 1) {
  return Astro.redirect(`/freedevtools/tldr/${platform}/`);
}

const currentPage = page;
const totalCommands = commands.length;

// Get commands for current page
const startIndex = (currentPage - 1) * itemsPerPage;
const endIndex = startIndex + itemsPerPage;
const currentPageCommands = commands.slice(startIndex, endIndex);

// Breadcrumb data
const breadcrumbItems = [
  { label: 'Free DevTools', href: '/freedevtools/' },
  { label: 'TLDR', href: '/freedevtools/tldr/' },
  { label: platform, href: `/freedevtools/tldr/${platform}/` },
  { label: `Page ${currentPage}` }
];

// SEO data
const seoTitle = `${platform} Commands - Page ${currentPage} | Online Free DevTools by Hexmos`;
const seoDescription = `Browse page ${currentPage} of ${totalPages} pages in our ${platform} command documentation. Learn ${platform} commands quickly with practical examples.`;
const canonical = `https://hexmos.com/freedevtools/tldr/${platform}/${currentPage}/`;

// Enhanced keywords for paginated platform content
const paginatedPlatformKeywords = [
  `${platform} commands`,
  `${platform} cli`,
  `${platform} documentation`,
  "command line",
  "cli documentation", 
  "terminal commands",
  `page ${currentPage}`,
  "pagination",
  "command reference",
  "cli documentation"
];

---

<BaseLayout 
  name={`${platform} Commands`}
  path={`/freedevtools/tldr/${platform}/${currentPage}/`}
  title={seoTitle}
  description={seoDescription}
  canonical={canonical}
  themeColor="#1e40af"
  showSidebar={false}
  showHeader={true}
  totalItems={totalCommands}
  itemsPerPage={itemsPerPage}
  currentPage={currentPage}
  category={`${platform} Commands`}
  partOf="TLDR"
  partOfUrl="https://hexmos.com/freedevtools/tldr/"
  keywords={paginatedPlatformKeywords}
  features={["Quick Reference", "Platform Specific", "Practical Examples", "No Registration"]}
>
  <TldrPlatform 
    commands={currentPageCommands}
    currentPage={currentPage}
    totalPages={totalPages}
    totalCommands={totalCommands}
    platform={platform}
    breadcrumbItems={breadcrumbItems}
  />
</BaseLayout>
