---
import BaseLayout from '@/layouts/BaseLayout.astro';
import McpServerDetail from '../_McpServerDetail';
import Breadcrumb from '@/components/Breadcrumb';
import serversData from '../../data/servers.json';
import categoriesData from '../../data/categories.json';

export async function getStaticPaths() {
  // Generate static paths for all servers
  const paths = serversData.servers.map((server) => ({
    params: { 
      author: server.author.toLowerCase().replace(/\s+/g, '-'),
      server: server.id
    },
    props: { server }
  }));

  return paths;
}

const { server } = Astro.props;
const category = categoriesData.categories.find(cat => 
  server.categories.includes(cat.id)
);

// Breadcrumb data
const breadcrumbItems = [
  { label: 'Free DevTools', href: '/freedevtools/' },
  { label: 'MCP Directory', href: '/freedevtools/mcp/' },
  { label: 'MCP Servers', href: '/freedevtools/mcp/servers/' },
  { label: server.name }
];

// SEO Data
const title = `${server.name} - MCP Server by ${server.author} | Free DevTools by Hexmos`;
const description = `${server.description} Browse tools, check scores, and get installation instructions for this Model Context Protocol server.`;
const keywords = [
  'mcp server',
  server.name.toLowerCase(),
  server.author.toLowerCase(),
  'model context protocol',
  'ai agent server',
  'open source mcp',
  server.license.toLowerCase(),
  ...server.categories.map(cat => cat.replace('-', ' '))
];

const canonical = `https://hexmos.com/freedevtools/mcp/servers/${server.author.toLowerCase().replace(/\s+/g, '-')}/${server.id}/`;
---

<Breadcrumb items={breadcrumbItems} client:load />

<BaseLayout 
  name={server.name}
  title={title}
  path={canonical}
  description={description}
  canonical={canonical}
  themeColor="#3b82f6"
  keywords={keywords}
  ogImage="https://hexmos.com/freedevtools/tool-banners/mcp-server-banner.png"
  twitterImage="https://hexmos.com/freedevtools/tool-banners/mcp-server-banner.png"
  datePublished="2025-01-30"
  softwareVersion="1.0.0"
  features={[
    `${server.stats.tools} tools available`,
    `${server.license} license`,
    `Security score: ${server.scores.security}`,
    `Quality score: ${server.scores.quality}`,
    'GitHub integration'
  ]}
>
  <McpServerDetail 
    server={server}
    category={category}
    client:load 
  />
</BaseLayout>
