<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>usbguard-daemon.conf - USBGuard daemon configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/usbguard">usbguard_1.1.3+ds-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       usbguard-daemon.conf - USBGuard daemon configuration file

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>usbguard-daemon.conf</b> file is loaded by the USBGuard daemon after it parses its command-line options.
       It is used to configure runtime parameters of the daemon. The default search path is
       <u>/etc/usbguard/usbguard-daemon.conf</u>. It may be overridden using the <b>-c</b> command-line option, see
       <b><a href="../man8/usbguard-daemon.8.html">usbguard-daemon</a></b>(8) for further details.

</pre><h4><b>OPTIONS</b></h4><pre>
       <b>RuleFile</b>=<u>path</u>
           The USBGuard daemon will use this file to load the policy rule set from it and to write new rules
           received via the IPC interface. Default: %sysconfdir%/usbguard/rules.conf

       <b>RuleFolder</b>=<u>path</u>
           The USBGuard daemon will use this folder to load the policy rule set from it and to write new rules
           received via the IPC interface. Usually, we set the option to /etc/usbguard/rules.d/. The USBGuard
           daemon is supposed to behave like any other standard Linux daemon therefore it loads rule files in
           alpha-numeric order. File names inside RuleFolder directory should start with a two-digit number
           prefix indicating the position, in which the rules are scanned by the daemon. Using RuleFile and
           RuleFolder at the same time is permitted. However, modification of the permanent policy is not
           possible if one of the following conditions are met:

           •   Neither RuleFile nor RuleFolder are specified.

           •   RuleFile is not specified, RuleFolder is but it does not contain any files, where we could save
               permanent rules.

       <b>ImplicitPolicyTarget</b>=<u>target</u>
           How to treat USB devices that don’t match any rule in the policy. Target should be one of allow,
           block or reject (logically remove the device node from the system). Default: block

       <b>PresentDevicePolicy</b>=<u>policy</u>
           How to treat USB devices that are already connected when the daemon starts. Policy should be one of
           allow, block, reject, keep (keep whatever state the device is currently in) or apply-policy (evaluate
           the rule set for every present device). Default: apply-policy

       <b>PresentControllerPolicy</b>=<u>policy</u>
           How to treat USB <b>controller</b> devices that are already connected when the daemon starts. One of allow,
           block, reject, keep or apply-policy. Default: keep

       <b>InsertedDevicePolicy</b>=<u>policy</u>
           How to treat USB devices that are already connected <u>after</u> the daemon starts. One of block, reject,
           apply-policy. Default: apply-policy

       <b>AuthorizedDefault</b>=<u>authorizedDefault</u>
           The USBGuard daemon modifies some of the default authorization state attributes of controller
           devices. This setting, enables you to define what value the default authorization is set to.
           Authorized default should be one of keep (do not change authorization state), none (every new device
           starts out deauthorized), all (every new device starts out authorized) or internal (internal devices
           start out authorized, external do not). Default: none

       <b>RestoreControllerDeviceState</b>=<u>boolean</u>
           The USBGuard daemon modifies some attributes of controller devices like the default authorization
           state of new child device instances. Using this setting, you can control whether the daemon will try
           to restore the attribute values to the state before modification on shutdown. Default: false

       <b>DeviceManagerBackend</b>=<u>backend</u>
           Which device manager backend implementation to use. Backend should be one of uevent (default) or
           umockdev (useful for testing). UEvent backend is a netlink based implementation which uses sysfs to
           scan for present devices and an uevent socket for receiving USB device related events. UMockDev based
           device manager is capable of simulating devices based on umockdev-record files. Default: uevent

       <b>IPCAllowedUsers</b>=<u>username</u> [<u>username</u> ...]
           A space delimited list of usernames that the daemon will accept IPC connections from. Default: root

       <b>IPCAllowedGroups</b>=<u>groupname</u> [<u>groupname</u> ...]
           A space delimited list of groupnames that the daemon will accept IPC connections from.

       <b>IPCAccessControlFiles</b>=<u>path</u>
           The files at this location will be interpreted by the daemon as IPC access control definition files.
           See the IPC ACCESS CONTROL section for more details.

       <b>DeviceRulesWithPort</b>=<u>boolean</u>
           Generate device specific rules including the "via-port" attribute. Default: false

       <b>AuditBackend</b>=<u>backend</u>
           USBGuard audit events log backend. The <u>backend</u> value should be one of FileAudit or LinuxAudit.
           Default: FileAudit

       <b>AuditFilePath</b>=<u>filepath</u>
           USBGuard audit events log file path. Required if AuditBackend is set to FileAudit. Default:
           %localstatedir%/log/usbguard/usbguard-audit.log

       <b>HidePII</b>=<u>boolean</u>
           Hides personally identifiable information such as device serial numbers and hashes of descriptors
           (which include the serial number) from audit entries. Default: false

</pre><h4><b>SECURITY</b> <b>CONSIDERATIONS</b></h4><pre>
   <b>IPC</b>
       The daemon provides the USBGuard public IPC interface. Depending on your distribution defaults, access to
       this interface is limited to a certain group or a specific user only. Please set either the
       <b>IPCAllowedUsers</b>, <b>IPCAllowedGroups</b> or <b>IPCAccessControlFiles</b> options to limit access to the IPC interface.
       <b>Do</b> <b>not</b> <b>leave</b> <b>the</b> <b>ACL</b> <b>unconfigured</b> <b>as</b> <b>that</b> <b>will</b> <b>expose</b> <b>the</b> <b>IPC</b> <b>interface</b> <b>to</b> <b>all</b> <b>local</b> <b>users</b> <b>and</b> <b>will</b> <b>allow</b>
       <b>them</b> <b>to</b> <b>manipulate</b> <b>the</b> <b>authorization</b> <b>state</b> <b>of</b> <b>USB</b> <b>devices</b> <b>and</b> <b>modify</b> <b>the</b> <b>USBGuard</b> <b>policy</b>.

   <b>RestoreControllerDeviceState</b> <b>configuration</b> <b>option</b>
       If set to true, the USB authorization policy could be bypassed by performing some sort of attack on the
       daemon (via a local exploit or via a USB device) to make it shutdown and restore to the operating-system
       default state (known to be permissive).

</pre><h4><b>IPC</b> <b>ACCESS</b> <b>CONTROL</b></h4><pre>
       Access to the USBGuard IPC interface can be limited per user or group. Furthermore, by using the IPC
       Access Control files, it is possible to limit the access down to the level of Sections and Privileges as
       explained below.

   <b>Recommended:</b> <b>IPCAccessControlFiles</b>
       When you set <b>IPCAccessControlFiles</b> option, the daemon will look for IPC access control files in the
       directory specified by the set value. Each file in the directory is processed as follows:

        1. The basename of the file is interpreted as a username, UID, groupname or GID. If the name starts with
           : (colon), it is assumed that the rest of the name represents a group identifier (groupname or GID in
           case of a numeric-only string). Otherwise, it is interpreted as a user identifier (username or UID in
           case of numeric-only string).

        2. The contents of the file are parsed as Section=[privilege1][,privilege2] ...  formatted lines which
           specify the section privileges. If a section is omitted, it is assumed that no privileges are given
           for that section.

       Available sections and privileges:

       •   <b>Devices</b>

           •   modify: Change authorization state of devices including permanent changes (i.e. modification of
               device specific rules in the policy).

           •   list: Ability to get a list of recognized devices and their attributes.

           •   listen: Listen to device presence and device policy changes.

       •   <b>Policy</b>

           •   modify: Append rules to or remove any rules from the policy.

           •   list: Ability to view the currently enforced policy.

       •   <b>Exceptions</b>

           •   listen: Receive exception messages.

       •   <b>Parameters</b>

           •   modify: Set values of run-time parameters.

           •   list: Get values of run-time parameters.

           •   listen: Listen to property parameter changes.

       The following is a generally usable and reasonably safe example of an access control file. It allows one
       to modify USB device authorization state (Devices=modify), list USB devices (Devices=list), listen to USB
       device related events (Devices=listen), list USB authorization policy rules (Policy=list) and listen to
       exception events (Exceptions=listen):

           Devices=modify,list,listen
           Policy=list
           Exceptions=listen

       You can create or remove the IPC access control files using usbguard add-user and usbguard remove-user
       CLI commands. See <a href="../man1/usbguard.1.html">usbguard</a>(1) for more details. If you want to create the IPC access control files
       manually, you need to set the files permissions to 0600.

   <b>Legacy:</b> <b>IPCAllowedUsers</b> <b>and</b> <b>IPCAllowedGroups</b>
       Example configuration allowing full IPC access to users <u>root</u>, <u>joe</u> and members of the group <u>wheel</u>:

           IPCAllowedUsers=root joe
           IPCAllowedGroups=wheel

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/usbguard-daemon.8.html">usbguard-daemon</a>(8), <a href="../man5/usbguard-rules.conf.5.html">usbguard-rules.conf</a>(5)

</pre><h4><b>BUGS</b></h4><pre>
       If you find a bug in this software or if you’d like to request a feature to be implemented, please file a
       ticket at https://github.com/USBGuard/usbguard/issues/new.

</pre><h4><b>AUTHOR</b></h4><pre>
       USBGuard was originally written by Daniel Kopeček. Many people have contributed to it.

</pre><h4><b>RESOURCES</b></h4><pre>
       Main web site: https://usbguard.github.io/

</pre><h4><b>COPYING</b></h4><pre>
       License GPLv2+: GNU GPL version 2 or later <a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>. This is free software: you
       are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law.

                                                   01/15/2025                               <u><a href="../man5/USBGUARD-DAEMON.C.5.html">USBGUARD-DAEMON.C</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>