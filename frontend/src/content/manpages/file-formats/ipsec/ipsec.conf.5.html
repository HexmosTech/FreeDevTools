<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ipsec.conf - IPsec configuration and connections</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/strongswan-starter">strongswan-starter_6.0.1-6ubuntu4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ipsec.conf - IPsec configuration and connections

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  optional  <u>ipsec.conf</u>  file  specifies  most configuration and control information for the strongSwan
       IPsec subsystem.  The major exception is secrets for authentication; see <u><a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a></u>(5).  Its  contents
       are not security-sensitive.

       The  file  is  a  text  file,  consisting of one or more <u>sections</u>.  White space followed by <b>#</b> followed by
       anything to the end of the line is a comment and is ignored, as are empty lines which are  not  within  a
       section.

       A  line  which contains <b>include</b> and a file name, separated by white space, is replaced by the contents of
       that file.  If the file name is not a full pathname, it is considered to be  relative  to  the  directory
       containing  the  including file.  Such inclusions can be nested.  Only a single filename may be supplied,
       and it may not contain white space, but it may include shell wildcards (see <u><a href="../man1/sh.1.html">sh</a></u>(1)); for example:

       <b>include</b> <b>ipsec.*.conf</b>

       The intention of the include facility is mostly to permit keeping information on connections, or sets  of
       connections,  separate from the main configuration file.  This permits such connection descriptions to be
       changed, copied to the other security gateways involved, etc., without having to constantly extract  them
       from  the  configuration file and then insert them back into it.  Note also the <b>also</b> parameter (described
       below) which permits splitting a single logical section (e.g.  a  connection  description)  into  several
       actual sections.

       A section begins with a line of the form:

       <u>type</u> <u>name</u>

       where  <u>type</u> indicates what type of section follows, and <u>name</u> is an arbitrary name which distinguishes the
       section from others of the same type.  All subsequent non-empty lines which begin with  white  space  are
       part of the section.  Sections of the same type that share the same name are merged.

       Lines within the section are generally of the form

            <u>parameter</u><b>=</b><u>value</u>

       (note the mandatory preceding white space).  There can be white space on either side of the <b>=</b>.  Parameter
       names are specific to a section type.

       An  empty  <u>value</u>  stands  for  the  system  default  value  (if any) of the parameter, i.e. it is roughly
       equivalent to omitting the parameter line entirely. This may be useful to clear a setting inherited  from
       a  <b>%default</b>  section  or  via  <b>also</b> parameter (see below).  A <u>value</u> may contain single spaces (additional
       white space is reduced to one space).  To preserve white space as written enclose  the  entire  <u>value</u>  in
       double  quotes  (<b>"</b>);  in  such  values  double  quotes themselves may be escaped by prefixing them with <b>\</b>
       characters. A double-quoted string may span multiple lines by ending them with  <b>\</b>  characters  (following
       lines  don't  have  to  begin  with  white space, as that will be preserved). Additionally, the following
       control characters may be encoded in double-quoted strings: \n, \r, \t, \b, \f.

       Numeric values are specified to be either an ``integer'' (a sequence of digits) or a  ``decimal  number''
       (sequence of digits optionally followed by `.' and another sequence of digits).

       There is currently one parameter which is available in any type of section:

       <b>also</b>   the  value is a section name; the parameters of that section are inherited by the current section.
              Parameters in the current section always override inherited parameters, even if  an  <b>also</b>  follows
              after  them.   The specified section must exist and must have the same section type; it doesn't if
              it is defined before or after the current section.  Nesting is permitted, and there  may  be  more
              than  one  <b>also</b>  in  a  single  section  (parameters  from  referenced  sections are inherited and
              overridden in the order of these <b>also</b> parameters).

       A section with name <b>%default</b> specifies defaults for sections of the same type. All parameters in it,  are
       inherited by all other sections of that type.

       Currently there are three types of sections: a <b>config</b> section specifies general configuration information
       for  IPsec, a <b>conn</b> section specifies an IPsec connection, while a <b>ca</b> section specifies special properties
       of a certification authority.

</pre><h4><b>CONN</b> <b>SECTIONS</b></h4><pre>
       A <b>conn</b> section contains a <u>connection</u> <u>specification</u>, defining a network connection to be made using IPsec.
       The name given is arbitrary, and is used to identify the connection.  Here's a simple example:

       <b>conn</b> <b>snt</b>
           <b>left=192.168.0.1</b>
           <b>leftsubnet=10.1.0.0/16</b>
           <b>right=192.168.0.2</b>
           <b>rightsubnet=10.1.0.0/16</b>
           <b>keyingtries=%forever</b>
           <b>auto=add</b>

       A note on terminology: There are two kinds of communications going on: transmission of user  IP  packets,
       and  gateway-to-gateway  negotiations for keying, rekeying, and general control.  The path to control the
       connection is called 'ISAKMP SA' in IKEv1 and 'IKE  SA'  in  the  IKEv2  protocol.  That  what  is  being
       negotiated,  the  kernel level data path, is called 'IPsec SA' or 'Child SA'.  strongSwan previously used
       two separate keying daemons, <u>pluto</u> and <u>charon</u>. This manual does not discuss <u>pluto</u>  options  anymore,  but
       only <u>charon</u> that since strongSwan 5.0 supports both IKEv1 and IKEv2.

       To  avoid  trivial  editing of the configuration file to suit it to each system involved in a connection,
       connection specifications are written in terms of <u>left</u> and <u>right</u> participants, rather than  in  terms  of
       local  and  remote.   Which  participant  is  considered <u>left</u> or <u>right</u> is arbitrary; for every connection
       description an attempt is made to figure out whether the local endpoint should act as the <u>left</u>  or  <u>right</u>
       endpoint.  This  is  done  by  matching the IP addresses defined for both endpoints with the IP addresses
       assigned to local network interfaces. If a match is found then the role (left or right) that  matches  is
       going  to  be  considered  local.   If  no match is found during startup, <u>left</u> is considered local.  This
       permits using identical connection specifications on both ends.   There  are  cases  where  there  is  no
       symmetry;  a  good  convention is to use <u>left</u> for the local side and <u>right</u> for the remote side (the first
       letters are a good mnemonic).

       Many of the parameters relate to one participant or the other; only the ones for <u>left</u>  are  listed  here,
       but  every  parameter  whose name begins with <b>left</b> has a <b>right</b> counterpart, whose description is the same
       but with <b>left</b> and <b>right</b> reversed.

       Parameters are optional unless marked '(required)'.

   <b>CONN</b> <b>PARAMETERS</b>
       Unless otherwise noted, for a connection to work, in general it is necessary for the two  ends  to  agree
       exactly on the values of these parameters.

       <b>aaa_identity</b> = &lt;id&gt;
              defines the identity of the AAA backend used during IKEv2 EAP authentication.  This is required if
              the  EAP client uses a method that verifies the server identity (such as EAP-TLS), but it does not
              match the IKEv2 gateway identity.

       <b>aggressive</b> = yes | <b>no</b>
              whether to use IKEv1 Aggressive or Main Mode (the default).

       <b>ah</b> = &lt;cipher suites&gt;
              comma-separated list of AH algorithms to be used for the connection,  e.g.   <b>sha1-sha256-modp1024</b>.
              The  notation is <b>integrity[-dhgroup]</b>.  For IKEv2, multiple algorithms (separated by -) of the same
              type can be included in a single proposal. IKEv1 only includes the first algorithm in a  proposal.
              Only either the <b>ah</b> or <b>esp</b> keyword may be used, AH+ESP bundles are not supported.

              There  is  no default AH cipher suite since by default ESP is used.  The daemon adds its extensive
              default proposal to the configured value. To restrict it to the configured proposal an exclamation
              mark (<b>!</b>)  can be added at the end.

              If <b>dh-group</b> is specified, CHILD_SA/Quick Mode setup and rekeying include a separate Diffie-Hellman
              exchange (refer to the <b>esp</b> keyword for details).

       <b>also</b> = &lt;name&gt;
              includes conn section <b>&lt;name&gt;</b>.

       <b>auth</b> = &lt;value&gt;
              was used by the <b>pluto</b> IKEv1 daemon to use AH integrity protection for ESP encrypted  packets,  but
              is  not  supported  in charon. The <b>ah</b> keyword specifies algorithms to use for integrity protection
              with AH, but without encryption. AH+ESP bundles are not supported.

       <b>authby</b> = <b>pubkey</b> | rsasig | ecdsasig | psk | secret | never | xauthpsk | xauthrsasig
              how the two security gateways should authenticate each other; acceptable values are <b>psk</b> or  <b>secret</b>
              for  pre-shared  secrets,  <b>pubkey</b>  (the default) for public key signatures as well as the synonyms
              <b>rsasig</b> for RSA digital signatures and <b>ecdsasig</b> for Elliptic Curve DSA signatures.   <b>never</b>  can  be
              used  if  negotiation is never to be attempted or accepted (useful for shunt-only conns).  Digital
              signatures are superior in every way to shared secrets.  IKEv1 additionally  supports  the  values
              <b>xauthpsk</b>  and  <b>xauthrsasig</b>  that  will enable eXtended AUTHentication (XAUTH) in addition to IKEv1
              main mode based on shared secrets or digital RSA  signatures,  respectively.   This  parameter  is
              deprecated,  as  two  peers  do  not  need  to agree on an authentication method in IKEv2. Use the
              <b>leftauth</b> parameter instead to define authentication methods.

       <b>auto</b> = <b>ignore</b> | add | route | start
              what operation, if any, should be done automatically at IPsec startup;  currently-accepted  values
              are  <b>add</b>,  <b>route</b>,  <b>start</b>  and  <b>ignore</b>  (the default).  <b>add</b> loads a connection without starting it.
              <b>route</b> loads a connection and installs kernel traps. If traffic is detected between <b>leftsubnet</b>  and
              <b>rightsubnet</b>,  a connection is established.  <b>start</b> loads a connection and brings it up immediately.
              <b>ignore</b> ignores the connection. This is equal to  deleting  a  connection  from  the  config  file.
              Relevant only locally, other end need not agree on it.

       <b>closeaction</b> = <b>none</b> | clear | hold | restart
              defines  the  action  to take if the remote peer unexpectedly closes a CHILD_SA (see <b>dpdaction</b> for
              meaning of values).  A <b>closeaction</b> <b>should</b> <b>not</b>  <b>be</b>  used  if  the  peer  uses  reauthentication  or
              uniqueids checking, as these events might trigger the defined action when not desired.

       <b>compress</b> = yes | <b>no</b>
              whether  IPComp  compression of content is proposed on the connection (link-level compression does
              not work on encrypted data, so to be effective,  compression  must  be  done  <u>before</u>  encryption);
              acceptable  values  are <b>yes</b> and <b>no</b> (the default). A value of <b>yes</b> causes the daemon to propose both
              compressed and uncompressed, and prefer compressed.  A  value  of  <b>no</b>  prevents  the  daemon  from
              proposing or accepting compression.

       <b>dpdaction</b> = <b>none</b> | clear | hold | restart
              controls  the use of the Dead Peer Detection protocol (DPD, RFC 3706) where R_U_THERE notification
              messages (IKEv1) or empty INFORMATIONAL messages (IKEv2) are periodically sent in order  to  check
              the  liveliness  of  the  IPsec  peer.  The  values  <b>clear</b>, <b>hold</b>, and <b>restart</b> all activate DPD and
              determine the action to perform on a timeout. With <b>clear</b> the connection is closed with no  further
              actions  taken.   <b>hold</b>  installs a trap policy, which will catch matching traffic and tries to re-
              negotiate the connection on demand.  <b>restart</b> will immediately trigger an attempt to re-negotiation
              the connection.  The default is <b>none</b> which disables the active sending of DPD messages.

       <b>dpddelay</b> = <b>30s</b> | &lt;time&gt;
              defines the period time interval with which R_U_THERE messages/INFORMATIONAL exchanges are sent to
              the peer. These are only sent if no other traffic is received. In IKEv2, a value  of  0  sends  no
              additional  INFORMATIONAL  messages  and  uses  only standard messages (such as those to rekey) to
              detect dead peers.

       <b>dpdtimeout</b> = <b>150s</b> | &lt;time&gt;
              defines the timeout interval, after which all connections  to  a  peer  are  deleted  in  case  of
              inactivity.  This  only  applies to IKEv1, in IKEv2 the default retransmission timeout applies, as
              every exchange is used to detect dead peers.

       <b>inactivity</b> = &lt;time&gt;
              defines the timeout interval, after which a CHILD_SA is closed if it did not send or  receive  any
              traffic.  The inactivity counter is reset during CHILD_SA rekeying. This means that the inactivity
              timeout must be smaller than the rekeying interval to have any effect.

       <b>eap_identity</b> = &lt;id&gt;
              defines the identity the client uses to reply to an EAP Identity request.  If defined on  the  EAP
              server,  the defined identity will be used as peer identity during EAP authentication. The special
              value <b>%identity</b> uses the EAP Identity method to ask  the  client  for  an  EAP  identity.  If  not
              defined, the IKEv2 identity will be used as EAP identity.

       <b>esp</b> = &lt;cipher suites&gt;
              comma-separated  list  of  ESP encryption/authentication algorithms to be used for the connection,
              e.g.   <b>aes128-sha256</b>.   The  notation  is  <b>encryption-integrity[-dhgroup][-esnmode]</b>.   For  IKEv2,
              multiple  algorithms (separated by -) of the same type can be included in a single proposal. IKEv1
              only includes the first algorithm in a proposal.  Only either the <b>ah</b> or <b>esp</b> keyword may  be  used,
              AH+ESP bundles are not supported.

              Defaults  to <b>aes128-sha256</b>.  The daemon adds its extensive default proposal to this default or the
              configured value.  To restrict it to the configured proposal an exclamation mark (<b>!</b>)  can be added
              at the end.

              <b>Note</b>: As a responder, the daemon defaults to selecting the first configured proposal  that's  also
              supported  by  the  peer.  This  may  be  changed  via  <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5)  to selecting the first
              acceptable proposal sent by the peer instead. In order to restrict  a  responder  to  only  accept
              specific   cipher   suites,   the   strict   flag   (<b>!</b>,   exclamation  mark)  can  be  used,  e.g:
              aes256-sha512-modp4096!

              If <b>dh-group</b> is specified, CHILD_SA/Quick Mode rekeying and  initial  negotiation  use  a  separate
              Diffie-Hellman  exchange  using  the specified group. However, for IKEv2, the keys of the CHILD_SA
              created implicitly with the IKE_SA will always be derived from the IKE_SA's key material.  So  any
              DH  group  specified  here will only apply when the CHILD_SA is later rekeyed or is created with a
              separate CREATE_CHILD_SA exchange.  Therefore,  a  proposal  mismatch  might  not  immediately  be
              noticed when the SA is established, but may later cause rekeying to fail.

              Valid  values  for <b>esnmode</b> are <b>esn</b> and <b>noesn</b>.  Specifying both negotiates Extended Sequence Number
              support with the peer, the default is <b>noesn.</b>

       <b>forceencaps</b> = yes | <b>no</b>
              force UDP encapsulation for ESP packets even if no NAT situation is detected.  This  may  help  to
              surmount  restrictive  firewalls. In order to force the peer to encapsulate packets, NAT detection
              payloads are faked.

       <b>fragmentation</b> = <b>yes</b>  | accept | force | no
              whether to use IKE fragmentation (proprietary IKEv1 extension or IKEv2 fragmentation  as  per  RFC
              7383).   Acceptable  values  are  <b>yes</b> (the default), <b>accept</b>, <b>force</b> and <b>no</b>.  If set to <b>yes</b>, and the
              peer supports it, oversized IKE messages will be sent in fragments. If set to <b>accept</b>, support  for
              fragmentation is announced to the peer but the daemon does not send its own messages in fragments.
              If  set  to <b>force</b> (only supported for IKEv1) the initial IKE message will already be fragmented if
              required. Finally, setting the option to <b>no</b> will disable announcing support for this feature.

              Note that fragmented IKE messages sent by a peer are always accepted irrespective of the value  of
              this option (even when set to <b>no</b>).

       <b>ike</b> = &lt;cipher suites&gt;
              comma-separated  list  of  IKE/ISAKMP  SA  encryption/authentication  algorithms  to be used, e.g.
              <b>aes128-sha256-modp3072</b>.  The notation is <b>encryption-integrity[-prf]-dhgroup</b>.  If no PRF is  given,
              the  algorithms  defined for integrity are used for the PRF.  The prf keywords are the same as the
              integrity algorithms, but have a <b>prf</b> prefix (such as <b>prfsha1</b>, <b>prfsha256</b> or <b>prfaesxcbc</b>).
              In    IKEv2,    multiple    algorithms    and    proposals    may    be    included,    such    as
              <b>aes128-aes256-sha1-modp3072-modp2048,3des-sha1-md5-modp1024</b>.

              Defaults  to  <b>aes128-sha256-modp3072</b>.   The  daemon  adds  its  extensive default proposal to this
              default or the configured value.  To restrict it to the configured proposal  an  exclamation  mark
              (<b>!</b>)  can be added at the end.

              <b>Note</b>:  As  a responder the daemon accepts the first supported proposal received from the peer.  In
              order to restrict a responder  to  only  accept  specific  cipher  suites,  the  strict  flag  (<b>!</b>,
              exclamation mark) can be used, e.g: <b>aes256-sha512-modp4096!</b>

       <b>ikedscp</b> = <b>000000</b> | &lt;DSCP field&gt;
              Differentiated  Services Field Codepoint to set on outgoing IKE packets sent from this connection.
              The value is a six digit binary encoded string defining the Codepoint to set, as  defined  in  RFC
              2474.

       <b>ikelifetime</b> = <b>3h</b> | &lt;time&gt;
              how  long  the  keying  channel  of  a  connection  (ISAKMP  or  IKE  SA) should last before being
              renegotiated. Also see EXPIRY/REKEY below.

       <b>installpolicy</b> = <b>yes</b> | no
              decides whether IPsec policies are installed in the kernel  by  the  charon  daemon  for  a  given
              connection.  Allows  peaceful  cooperation  e.g.  with  the  Mobile IPv6 daemon mip6d who wants to
              control the kernel policies.  Acceptable values are <b>yes</b> (the default) and <b>no</b>.

       <b>keyexchange</b> = <b>ike</b> | ikev1 | ikev2
              which key exchange protocol should be used to initiate the connection.   Connections  marked  with
              <b>ike</b> use IKEv2 when initiating, but accept any protocol version when responding.

       <b>keyingtries</b> = <b>3</b> | &lt;number&gt; | %forever
              how  many  attempts  (a  whole  number or <b>%forever</b>) should be made to negotiate a connection, or a
              replacement for one, before giving up (default <b>3</b>).  The value  <b>%forever</b>  means  'never  give  up'.
              Relevant only locally, other end need not agree on it.

       <b>left</b> = &lt;ip address&gt; | &lt;fqdn&gt; | <b>%any</b> | &lt;range&gt; | &lt;subnet&gt;
              The  IP address of the left participant's public-network interface or one of several magic values.
              The value <b>%any</b> (the default) for the local endpoint signifies an  address  to  be  filled  in  (by
              automatic keying) during negotiation. If the local peer initiates the connection setup the routing
              table  will  be  queried  to  determine  the  correct local IP address.  In case the local peer is
              responding to a connection setup then any IP address that is assigned to a local interface will be
              accepted.

              The prefix <b>%</b> in front of a fully-qualified domain name  or  an  IP  address  will  implicitly  set
              <b>leftallowany</b>=yes.

              If <b>%any</b> is used for the remote endpoint it literally means any IP address.

              If an <b>FQDN</b> is assigned it is resolved every time a configuration lookup is done. If DNS resolution
              times out, the lookup is delayed for that time.

              To  limit  the  connection  to  a  specific range of hosts, a range ( <b>10.1.0.0-10.2.255.255</b> ) or a
              subnet ( <b>10.1.0.0/16</b> ) can be specified,  and  multiple  addresses,  ranges  and  subnets  can  be
              separated by commas. While one can freely combine these items, to initiate the connection at least
              one non-range/subnet is required.

              Please  note that with the usage of wildcards multiple connection descriptions might match a given
              incoming connection attempt. The most specific description is used in that case.

       <b>leftallowany</b> = yes | <b>no</b>
              a modifier for <b>left</b>, making it behave as <b>%any</b> although a concrete IP address or  domain  name  has
              been assigned.

       <b>leftauth</b> = &lt;auth method&gt;
              Authentication  method  to use locally (left) or require from the remote (right) side.  Acceptable
              values  are  <b>pubkey</b>  for  public  key  authentication  (RSA/ECDSA),   <b>psk</b>   for   pre-shared   key
              authentication,  <b>eap</b>  to (require the) use of the Extensible Authentication Protocol in IKEv2, and
              <b>xauth</b> for IKEv1 eXtended Authentication.

              To require a trustchain public key strength for the remote side, specify the key type followed  by
              the  minimum  strength  in  bits  (for  example  <b>ecdsa-384</b>  or  <b>rsa-2048-ecdsa-256</b>).  To limit the
              acceptable set of hashing algorithms for trustchain validation, append hash algorithms  to  <b>pubkey</b>
              or  a key strength definition (for example <b>pubkey-sha256-sha512</b>, <b>rsa-2048-sha256-sha384-sha512</b>, or
              <b>rsa-2048-sha256-ecdsa-256-sha256-sha384</b>).  Unless  disabled  in  <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5),  or  explicit
              IKEv2  signature  constraints  are  configured (see below), such key types and hash algorithms are
              also applied as constraints against IKEv2 signature authentication  schemes  used  by  the  remote
              side.

              If  both  peers support RFC 7427 ("Signature Authentication in IKEv2") specific hash algorithms to
              be used during IKEv2 authentication may be configured.  The syntax is the same as above, but  with
              ike:  prefix. For example, with <b>ike:pubkey-sha384-sha256</b> a public key signature scheme with either
              SHA-384 or SHA-256 would get used for authentication, in that order  and  depending  on  the  hash
              algorithms  supported  by the peer.  If no specific hash algorithms are configured, the default is
              to prefer an algorithm that matches  or  exceeds  the  strength  of  the  signature  key.   If  no
              constraints  with ike: prefix are configured any signature scheme constraint (without ike: prefix)
              will also apply to IKEv2 authentication, unless this is disabled in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

              To use or require RSASSA-PSS signatures use rsa/pss instead of rsa as in e.g.  <b>ike:rsa/pss-sha256</b>.
              If <b>pubkey</b> or <b>rsa</b> constraints are configured RSASSA-PSS signatures will only  be  used/accepted  if
              enabled in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5).

              For  <b>eap</b>,  an optional EAP method can be appended. Currently defined methods are <b>eap-aka</b>, <b>eap-gtc</b>,
              <b>eap-md5</b>,  <b>eap-mschapv2</b>,  <b>eap-peap</b>,  <b>eap-sim</b>,  <b>eap-tls</b>,  <b>eap-ttls</b>,  <b>eap-dynamic</b>,  and   <b>eap-radius</b>.
              Alternatively,  IANA  assigned  EAP  method  numbers are accepted. Vendor specific EAP methods are
              defined in the form <b>eap-type-vendor</b> (e.g. <b>eap-7-12345</b>).  To  specify  signature  and  trust  chain
              constraints  for  EAP-(T)TLS,  append a colon to the EAP method, followed by the key type/size and
              hash algorithm as discussed above. For <b>xauth,</b> an XAuth authentication backend  can  be  specified,
              such  as <b>xauth-generic</b> or <b>xauth-eap</b>.  If XAuth is used in <b>leftauth</b>, Hybrid authentication is used.
              For traditional XAuth authentication, define XAuth in <b>lefauth2</b>.

       <b>leftauth2</b> = &lt;auth method&gt;
              Same as <b>leftauth</b>, but defines an additional authentication exchange. In IKEv1, only XAuth  can  be
              used  in  the  second authentication round. IKEv2 supports multiple complete authentication rounds
              using "Multiple Authentication Exchanges" defined in RFC 4739. This allows, for example, separated
              authentication of host and user.

       <b>leftca</b> = &lt;issuer dn&gt; | %same
              the distinguished name of a certificate authority which is required to lie in the trust path going
              from the left participant's certificate up to the root certification authority.  <b>%same</b> means  that
              the value configured for the right participant should be reused.

       <b>leftca2</b> = &lt;issuer dn&gt; | %same
              Same as <b>leftca</b>, but for the second authentication round (IKEv2 only).

       <b>leftcert</b> = &lt;path&gt;
              the path to the left participant's X.509 certificate. The file can be encoded either in PEM or DER
              format.  OpenPGP  certificates  are  supported  as well.  Both absolute paths or paths relative to
              <u>/etc/ipsec.d/certs</u> are accepted. By default <b>leftcert</b> sets <b>leftid</b> to the distinguished name of  the
              certificate's  subject.   The left participant's ID can be overridden by specifying a <b>leftid</b> value
              which must be certified by the certificate, though.
              A value in the form <b>%smartcard[&lt;slot</b> <b>nr&gt;[@&lt;module&gt;]]:&lt;keyid&gt;</b> defines  a  specific  certificate  to
              load  from a PKCS#11 backend for this connection. See <a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a>(5) for details about smartcard
              definitions.  <b>leftcert</b>  is  required  only  if  selecting  the  certificate  with  <b>leftid</b>  is  not
              sufficient, for example if multiple certificates use the same subject.
              Multiple  certificate  paths  or  PKCS#11 backends can be specified in a comma separated list. The
              daemon chooses the certificate based on the  received  certificate  requests  if  possible  before
              enforcing the first.

       <b>leftcert2</b> = &lt;path&gt;
              Same as <b>leftcert,</b> but for the second authentication round (IKEv2 only).

       <b>leftcertpolicy</b> = &lt;OIDs&gt;
              Comma  separated  list  of  certificate  policy  OIDs  the peer's certificate must have.  OIDs are
              specified using the numerical dotted representation.

       <b>leftdns</b> = &lt;servers&gt;
              Comma separated list of DNS server addresses to  exchange  as  configuration  attributes.  On  the
              initiator,  a  server  is  a  fixed  IPv4/IPv6 address, or <b>%config4</b>/<b>%config6</b> to request attributes
              without an address. On the responder, only fixed IPv4/IPv6 addresses are allowed  and  define  DNS
              servers assigned to the client.

       <b>leftfirewall</b> = yes | <b>no</b>
              whether  the  left  participant  is  doing  forwarding-firewalling  (including masquerading) using
              iptables for traffic from <u>leftsubnet</u>, which should be turned off (for traffic to the other subnet)
              once the connection is established; acceptable values are <b>yes</b> and <b>no</b> (the default).   May  not  be
              used  in  the  same  connection  description  with  <b>leftupdown</b>.  Implemented as a parameter to the
              default <b>ipsec</b> <b>_updown</b> script.  See notes below.  Relevant only locally, other end need  not  agree
              on it.

              If   one   or  both  security  gateways  are  doing  forwarding  firewalling  (possibly  including
              masquerading), and this is specified using the firewall parameters, tunnels established with IPsec
              are exempted from it so that packets can flow unchanged through the tunnels.  (This means that all
              subnets connected in this manner must have distinct, non-overlapping subnet address blocks.)  This
              is done by the default <b>ipsec</b> <b>_updown</b> script.

              In situations calling for more control, it may be preferable for the user to supply his own <u>updown</u>
              script, which makes the appropriate adjustments for his system.

       <b>leftgroups</b> = &lt;group list&gt;
              a comma separated list of group names. If the <b>leftgroups</b> parameter is present then the  peer  must
              be a member of at least one of the groups defined by the parameter.

       <b>leftgroups2</b> = &lt;group list&gt;
              Same as <b>leftgroups,</b> but for the second authentication round defined with <b>leftauth2.</b>

       <b>lefthostaccess</b> = yes | <b>no</b>
              inserts  a  pair  of  INPUT and OUTPUT iptables rules using the default <b>ipsec</b> <b>_updown</b> script, thus
              allowing access to the host itself in the case where the host's internal interface is part of  the
              negotiated client subnet.  Acceptable values are <b>yes</b> and <b>no</b> (the default).

       <b>leftid</b> = &lt;id&gt;
              how  the left participant should be identified for authentication; defaults to <b>left</b> or the subject
              of the certificate configured with <b>leftcert</b>.  If <b>leftcert</b> is configured the  identity  has  to  be
              confirmed by the certificate.

              Can  be an IP address, a fully-qualified domain name, an email address or a Distinguished Name for
              which the ID type is determined automatically and the  string  is  converted  to  the  appropriate
              encoding. The rules for this conversion are described in IDENTITY PARSING below.

              In  certain special situations the identity parsing above might be inadequate or produce the wrong
              result. Examples are the need to encode a FQDN as KEY_ID or the  string  parser  being  unable  to
              produce  the  correct  binary  ASN.1  encoding  of a certificate's DN.  For these situations it is
              possible to enforce a specific identity type and to provide the binary encoding of  the  identity.
              To  do  this  a  prefix  may  be used, followed by a colon (:). If the number sign (#) follows the
              colon, the remaining data is interpreted as hex encoding, otherwise the string is used  as  is  as
              the  identification data.  <b>Note</b>: The latter implies that no conversion is performed for non-string
              identities.  For example, <u>ipv4:10.0.0.1</u> does not create a valid ID_IPV4_ADDR IKE identity,  as  it
              does  not get converted to binary 0x0a000001. Instead, one could use <u>ipv4:#0a000001</u> to get a valid
              identity, but just using the implicit type with automatic conversion is usually simpler. The  same
              applies  to  the ASN.1 encoded types. The following prefixes are known: <b>ipv4</b>, <b>ipv6</b>, <b>rfc822</b>, <b>email</b>,
              <b>userfqdn</b>, <b>fqdn</b>, <b>dns</b>, <b>asn1dn</b>,  <b>asn1gn</b>  and  <b>keyid</b>.   Custom  type  prefixes  may  be  specified  by
              surrounding the numerical type value by curly brackets.

              For  IKEv2  and <b>rightid</b> the prefix <b>%</b> in front of the identity prevents the daemon from sending IDr
              in its IKE_AUTH request and will allow it to verify the configured identity  against  the  subject
              and  subjectAltNames  contained in the responder's certificate (otherwise it is only compared with
              the IDr returned by the responder).  The IDr sent by the initiator  might  otherwise  prevent  the
              responder from finding a config if it has configured a different value for <b>leftid</b>.

       <b>leftid2</b> = &lt;id&gt;
              identity  to  use  for  a second authentication for the left participant (IKEv2 only); defaults to
              <b>leftid</b>.

       <b>leftikeport</b> = &lt;port&gt;
              UDP port the left participant uses for IKE communication.  If unspecified, port 500 is  used  with
              the  port  floating to 4500 if a NAT is detected or MOBIKE is enabled. Specifying a local IKE port
              different from the default additionally requires a socket  implementation  that  listens  on  this
              port.

       <b>leftprotoport</b> = &lt;protocol&gt;/&lt;port&gt;
              restrict  the  traffic  selector  to a single protocol and/or port. This option is now deprecated,
              protocol/port information can be defined for each subnet directly in <b>leftsubnet</b>.

       <b>leftsigkey</b> = &lt;raw public key&gt; | &lt;path to public key&gt;
              the left participant's public key for public key signature authentication, in PKCS#1 format  using
              hex  (0x prefix) or base64 (0s prefix) encoding. With the optional <b>dns:</b> or <b>ssh:</b> prefix in front of
              0x or 0s, the public key is expected to be in either the RFC 3110 (not the full RR, only  RSA  key
              part) or RFC 4253 public key format, respectively.  Also accepted is the path to a file containing
              the  public  key  in  PEM,  DER  or  SSH  encoding.  Both  absolute  paths  or  paths  relative to
              <u>/etc/ipsec.d/certs</u> are accepted.

       <b>leftsendcert</b> = never | no | <b>ifasked</b> | always | yes
              Accepted values are <b>never</b> or <b>no</b>, <b>always</b> or <b>yes</b>, and <b>ifasked</b> (the default), the latter meaning that
              the peer must send a certificate request payload in order to get a certificate in return.

       <b>leftsourceip</b> = %config4 | %config6 | &lt;ip address&gt;
              Comma separated list of internal source IPs to use in a tunnel, also known as virtual IP.  If  the
              value  is one of the synonyms <b>%config</b>, <b>%cfg</b>, <b>%modeconfig</b>, or <b>%modecfg</b>, an address (from the tunnel
              address family) is requested from the peer. With <b>%config4</b> and <b>%config6</b> an  address  of  the  given
              address family will be requested explicitly.  If an IP address is configured, it will be requested
              from the responder, which is free to respond with a different address.

       <b>rightsourceip</b> = %config | &lt;network&gt;/&lt;netmask&gt; | &lt;from&gt;-&lt;to&gt; | %poolname
              Comma  separated  list of internal source IPs to use in a tunnel for the remote peer. If the value
              is <b>%config</b> on the responder side, the initiator must propose an address which is then echoed back.
              Also supported are address pools expressed as  <u>network</u><b>/</b><u>netmask</u>  and  <u>from</u><b>-</b><u>to</u>  or  the  use  of  an
              external  IP  address pool using %<u>poolname</u>, where <u>poolname</u> is the name of the IP address pool used
              for the lookup.

       <b>leftsubnet</b> = &lt;ip subnet&gt;[[&lt;proto/port&gt;]][,...]
              private subnet behind the left participant, expressed as <u>network</u><b>/</b><u>netmask</u>; if omitted,  essentially
              assumed to be <u>left</u><b>/32</b>, signifying that the left end of the connection goes to the left participant
              only.  Configured  subnets of the peers may differ, the protocol narrows it to the greatest common
              subnet. In IKEv1, this may lead to problems with other implementations,  make  sure  to  configure
              identical  subnets  in  such  configurations. IKEv2 supports multiple subnets separated by commas.
              IKEv1 only interprets the first subnet of such a definition,  unless  the  Cisco  Unity  extension
              plugin  is  enabled. This is due to a limitation of the IKEv1 protocol, which only allows a single
              pair of subnets per CHILD_SA. So to tunnel several subnets a conn entry  has  to  be  defined  and
              brought up for each pair of subnets.

              The  optional  part  after  each  subnet  enclosed in square brackets specifies a protocol/port to
              restrict the selector for that subnet.

              Examples:                     <b>leftsubnet=10.0.0.1[tcp/http],10.0.0.2[6/80]</b>                      or
              <b>leftsubnet=fec1::1[udp],10.0.0.0/16[/53]</b>.   Instead  of  omitting either value <b>%any</b> can be used to
              the same effect, e.g.  <b>leftsubnet=fec1::1[udp/%any],10.0.0.0/16[%any/53]</b>.

              If the protocol is <b>icmp</b> or <b>ipv6-icmp</b> the port is interpreted as ICMP message type if  it  is  less
              than  256  or  as  type  and  code  if  it  is  greater or equal to 256, with the type in the most
              significant 8 bits and the code in the least significant 8 bits.

              The port value can alternatively take the value <b>%opaque</b>  for  RFC  4301  OPAQUE  selectors,  or  a
              numerical  range in the form <b>1024-65535</b>.  None of the kernel backends currently supports opaque or
              port ranges and uses <b>%any</b> for policy installation instead.

              Instead of specifying a subnet, <b>%dynamic</b> can be used to replace it with the  IKE  address,  having
              the  same  effect as omitting <b>leftsubnet</b> completely. Using <b>%dynamic</b> can be used to define multiple
              dynamic selectors, each having a potentially different protocol/port definition.

       <b>leftupdown</b> = &lt;path&gt;
              what ``updown'' script to run to  adjust  routing  and/or  firewalling  when  the  status  of  the
              connection  changes (default <b>ipsec</b> <b>_updown</b>).  May include positional parameters separated by white
              space  (although  this  requires  enclosing  the  whole  string  in   quotes);   including   shell
              metacharacters  is unwise.  Relevant only locally, other end need not agree on it. Charon uses the
              updown script to insert firewall rules only, since routing has been implemented directly into  the
              daemon.

       <b>lifebytes</b> = &lt;number&gt;
              the number of bytes transmitted over an IPsec SA before it expires.

       <b>lifepackets</b> = &lt;number&gt;
              the number of packets transmitted over an IPsec SA before it expires.

       <b>lifetime</b> = <b>1h</b> | &lt;time&gt;
              how  long  a particular instance of a connection (a set of encryption/authentication keys for user
              packets) should last, from successful negotiation to expiry;  acceptable  values  are  an  integer
              optionally followed by <b>s</b> (a time in seconds) or a decimal number followed by <b>m</b>, <b>h</b>, or <b>d</b> (a time in
              minutes,  hours,  or  days  respectively)  (default <b>1h</b>, maximum <b>24h</b>).  Normally, the connection is
              renegotiated (via the keying channel) before it expires (see <b>margintime</b>).  The two ends  need  not
              exactly  agree  on  <b>lifetime</b>,  although  if  they do not, there will be some clutter of superseded
              connections on the end which thinks the lifetime is longer. Also see EXPIRY/REKEY below.

       <b>marginbytes</b> = &lt;number&gt;
              how many bytes before IPsec SA expiry (see <b>lifebytes</b>) should attempts to negotiate  a  replacement
              begin.

       <b>marginpackets</b> = &lt;number&gt;
              how  many  packets  before  IPsec  SA  expiry  (see  <b>lifepackets</b>)  should  attempts to negotiate a
              replacement begin.

       <b>margintime</b> = <b>9m</b> | &lt;time&gt;
              how long before connection  expiry  or  keying-channel  expiry  should  attempts  to  negotiate  a
              replacement  begin;  acceptable values as for <b>lifetime</b> (default <b>9m</b>).  Relevant only locally, other
              end need not agree on it. Also see EXPIRY/REKEY below.

       <b>mark</b> = &lt;value&gt;[/&lt;mask&gt;]
              sets an XFRM mark on the inbound policy and outbound IPsec SA and policy. If the mask  is  missing
              then  a default mask of <b>0xffffffff</b> is assumed. The special value <b>%unique</b> assigns a unique value to
              each newly created IPsec SA. To additionally make the mark unique  for  each  IPsec  SA  direction
              (in/out) the special value <b>%unique-dir</b> may be used.

       <b>mark_in</b> = &lt;value&gt;[/&lt;mask&gt;]
              sets  an  XFRM  mark  on the inbound policy (not on the SA). If the mask is missing then a default
              mask of <b>0xffffffff</b> is assumed.

       <b>mark_out</b> = &lt;value&gt;[/&lt;mask&gt;]
              sets an XFRM mark on the outbound IPsec SA and policy. If the mask is missing then a default  mask
              of <b>0xffffffff</b> is assumed.

       <b>mobike</b> = <b>yes</b> | no
              enables  the  IKEv2 MOBIKE protocol defined by RFC 4555. Accepted values are <b>yes</b> (the default) and
              <b>no</b>.  If set to <b>no</b>, the charon daemon will not actively propose MOBIKE as initiator and ignore  the
              MOBIKE_SUPPORTED notify as responder.

       <b>modeconfig</b> = push | <b>pull</b>
              defines  which  mode  is  used  to  assign  a  virtual IP.  Accepted values are <b>push</b> and <b>pull</b> (the
              default).  Push mode is currently not supported with IKEv2.  The setting must be the same on  both
              sides.

       <b>reauth</b> = <b>yes</b> | no
              whether  rekeying  of an IKE_SA should also reauthenticate the peer. In IKEv1, reauthentication is
              always done. In IKEv2, a value of <b>no</b> rekeys without uninstalling the IPsec SAs,  a  value  of  <b>yes</b>
              (the default) creates a new IKE_SA from scratch and tries to recreate all IPsec SAs.

       <b>rekey</b> = <b>yes</b> | no
              whether  a connection should be renegotiated when it is about to expire; acceptable values are <b>yes</b>
              (the default) and <b>no</b>.  The two ends need not agree, but while a value of <b>no</b> prevents  charon  from
              requesting renegotiation, it does not prevent responding to renegotiation requested from the other
              end, so <b>no</b> will be largely ineffective unless both ends agree on it. Also see <b>reauth</b>.

       <b>rekeyfuzz</b> = <b>100%</b> | &lt;percentage&gt;
              maximum percentage by which <b>marginbytes</b>, <b>marginpackets</b> and <b>margintime</b> should be randomly increased
              to randomize rekeying intervals (important for hosts with many connections); acceptable values are
              an  integer, which may exceed 100, followed by a `%' (defaults to <b>100%</b>).  The value of <b>marginTYPE</b>,
              after this random increase, must not exceed <b>lifeTYPE</b> (where TYPE  is  one  of  <u>bytes</u>,  <u>packets</u>  or
              <u>time</u>).  The value <b>0%</b> will suppress randomization.  Relevant only locally, other end need not agree
              on it. Also see EXPIRY/REKEY below.

       <b>replay_window</b> = <b>-1</b> | &lt;number&gt;
              The IPsec replay window size for this connection. With the default of -1 the value configured with
              <u>charon.replay_window</u>  in <b><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></b>(5) is used. Larger values than 32 are supported using the
              Netlink backend only, a value of 0 disables IPsec replay protection.

       <b>reqid</b> = &lt;number&gt;
              sets the reqid for a given connection to a pre-configured fixed value.

       <b>sha256_96</b> = <b>no</b> | yes
              HMAC-SHA-256 is used with 128-bit truncation with IPsec. For  compatibility  with  implementations
              that  incorrectly  use  96-bit  truncation  this  option  may  be enabled to configure the shorter
              truncation length in the kernel.  This is not negotiated, so this only works with peers  that  use
              the incorrect truncation length (or have this option enabled).

       <b>tfc</b> = &lt;value&gt;
              number of bytes to pad ESP payload data to. Traffic Flow Confidentiality is currently supported in
              IKEv2  and  applies  to  outgoing  packets  only. The special value <b>%mtu</b> fills up ESP packets with
              padding to have the size of the MTU.

       <b>type</b> = <b>tunnel</b> | transport | transport_proxy | passthrough | drop
              the type of the connection; currently the accepted values are <b>tunnel</b> (the  default)  signifying  a
              host-to-host,  host-to-subnet,  or  subnet-to-subnet  tunnel;  <b>transport</b>,  signifying host-to-host
              transport mode;  <b>transport_proxy</b>,  signifying  the  special  Mobile  IPv6  transport  proxy  mode;
              <b>passthrough</b>,  signifying  that  no  IPsec  processing should be done at all; <b>drop</b>, signifying that
              packets should be discarded.

       <b>xauth</b> = <b>client</b> | server
              specifies the role in the XAuth protocol if activated by  <b>authby=xauthpsk</b>  or  <b>authby=xauthrsasig.</b>
              Accepted values are <b>server</b> and <b>client</b> (the default).

       <b>xauth_identity</b> = &lt;id&gt;
              defines  the  identity/username the client uses to reply to an XAuth request.  If not defined, the
              IKEv1 identity will be used as XAuth identity.

   <b>CONN</b> <b>PARAMETERS:</b> <b>IKEv2</b> <b>MEDIATION</b> <b>EXTENSION</b>
       The following parameters are relevant to IKEv2 Mediation Extension operation only.

       <b>mediation</b> = yes | <b>no</b>
              whether this connection is a mediation connection, ie. whether this connection is used to  mediate
              other  connections.   Mediation  connections  create  no  child  SA. Acceptable values are <b>no</b> (the
              default) and <b>yes</b>.

       <b>mediated_by</b> = &lt;name&gt;
              the name of the connection to mediate this connection through.  If given, the connection  will  be
              mediated through the named mediation connection.  The mediation connection must set <b>mediation=yes</b>.

       <b>me_peerid</b> = &lt;id&gt;
              ID  as which the peer is known to the mediation server, ie. which the other end of this connection
              uses as its <b>leftid</b> on its connection to the mediation server.  This  is  the  ID  we  request  the
              mediation  server  to  mediate us with.  If <b>me_peerid</b> is not given, the <b>rightid</b> of this connection
              will be used as peer ID.

</pre><h4><b>CA</b> <b>SECTIONS</b></h4><pre>
       These are optional sections that can be used to assign special parameters to  a  Certification  Authority
       (CA).  Because  the  daemons  automatically import CA certificates from <u>/etc/ipsec.d/cacerts</u>, there is no
       need to explicitly add them with a CA section, unless you want to assign special parameters (like a  CRL)
       to a CA.

       <b>also</b> = &lt;name&gt;
              includes ca section <b>&lt;name&gt;</b>.

       <b>auto</b> = <b>ignore</b> | add
              currently can have either the value <b>ignore</b> (the default) or <b>add</b>.

       <b>cacert</b> = &lt;path&gt;
              defines  a  path  to  the CA certificate either relative to <u>/etc/ipsec.d/cacerts</u> or as an absolute
              path.
              A value in the form <b>%smartcard[&lt;slot</b> <b>nr&gt;[@&lt;module&gt;]]:&lt;keyid&gt;</b> defines a specific CA certificate  to
              load  from  a  PKCS#11  backend  for  this  CA.   See <a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a>(5) for details about smartcard
              definitions.

       <b>crluri</b> = &lt;uri&gt;
              defines a CRL distribution point (ldap, http, or file URI)

       <b>crluri1</b>
              synonym for <b>crluri.</b>

       <b>crluri2</b> = &lt;uri&gt;
              defines an alternative CRL distribution point (ldap, http, or file URI)

       <b>ocspuri</b> = &lt;uri&gt;
              defines an OCSP URI.

       <b>ocspuri1</b>
              synonym for <b>ocspuri.</b>

       <b>ocspuri2</b> = &lt;uri&gt;
              defines an alternative OCSP URI.

       <b>certuribase</b> = &lt;uri&gt;
              defines the base URI for the Hash and URL feature  supported  by  IKEv2.   Instead  of  exchanging
              complete  certificates,  IKEv2  allows  one  to  send  an  URI  that  resolves  to the DER encoded
              certificate. The certificate URIs are built  by  appending  the  SHA1  hash  of  the  DER  encoded
              certificates to this base URI.

</pre><h4><b>CONFIG</b> <b>SECTIONS</b></h4><pre>
       At  present,  the  only <b>config</b> section known to the IPsec software is the one named <b>setup</b>, which contains
       information used when the software is being started.  The currently-accepted <u>parameter</u> names in a  <b>config</b>
       <b>setup</b> section are:

       <b>cachecrls</b> = yes | <b>no</b>
              if  enabled,  certificate  revocation  lists  (CRLs)  fetched  via  HTTP or LDAP will be cached in
              <u>/etc/ipsec.d/crls/</u> under a unique file name derived from the certification authority's public key.

       <b>charondebug</b> = &lt;debug list&gt;
              how much charon debugging output should be logged.  A comma separated list containing  type/level-
              pairs may be specified, e.g: <b>dmn</b> <b>3,</b> <b>ike</b> <b>1,</b> <b>net</b> <b>-1.</b>  Acceptable values for types are <b>dmn,</b> <b>mgr,</b> <b>ike,</b>
              <b>chd,</b>  <b>job,</b>  <b>cfg,</b> <b>knl,</b> <b>net,</b> <b>asn,</b> <b>enc,</b> <b>lib,</b> <b>esp,</b> <b>tls,</b> <b>tnc,</b> <b>imc,</b> <b>imv,</b> <b>pts</b> and the level is one of <b>-1,</b>
              <b>0,</b> <b>1,</b> <b>2,</b> <b>3,</b> <b>4</b> (for silent, audit, control, controlmore, raw, private).  By default, the  level  is
              set to <b>1</b> for all types.  For more flexibility see LOGGER CONFIGURATION in <u><a href="../man5/strongswan.conf.5.html">strongswan.conf</a></u>(5).

       <b>strictcrlpolicy</b> = yes | ifuri | <b>no</b>
              defines  if  a  fresh  CRL  must  be  available  in order for the peer authentication based on RSA
              signatures to succeed.  IKEv2 additionally recognizes <b>ifuri</b> which reverts to <b>yes</b> if at  least  one
              CRL URI is defined and to <b>no</b> if no URI is known.

       <b>uniqueids</b> = <b>yes</b> | no | never | replace | keep
              whether  a particular participant ID should be kept unique, with any new IKE_SA using an ID deemed
              to replace all old ones using that ID; acceptable values are <b>yes</b>  (the  default),  <b>no</b>  and  <b>never</b>.
              Participant  IDs  normally  <u>are</u>  unique,  so  a  new IKE_SA using the same ID is almost invariably
              intended to replace an old one. The difference between <b>no</b>  and  <b>never</b>  is  that  the  daemon  will
              replace  old  IKE_SAs when receiving an INITIAL_CONTACT notify if the option is <b>no</b> but will ignore
              these notifies if <b>never</b> is configured.  The  daemon  also  accepts  the  value  <b>replace</b>  which  is
              identical to <b>yes</b> and the value <b>keep</b> to reject new IKE_SA setups and keep the duplicate established
              earlier.

</pre><h4><b>IDENTITY</b> <b>PARSING</b></h4><pre>
       The type and binary encoding of identity strings specified in <u>leftid</u> are detected as follows:

       •      If the string value contains an equal sign (=) it is assumed to be a Distinguished Name, with RDNs
              separated by commas (,) <u>or</u> slashes (/ - the string must start with a slash to use this syntax). An
              attempt  is made to create a binary ASN.1 encoding from this string. If that fails the type is set
              to KEY_ID with the literal string value adopted as encoding.

       •      If the string value contains an @ the type depends on the position of that character:

              •      If the string begins with @# the type is set to KEY_ID and the string following that prefix
                     is assumed to be the hex-encoded binary value of the identity.

              •      If the string begins with @@ the type is set to USER_FQDN and the encoding is  the  literal
                     string after that prefix.

              •      If  the string begins with @ the type is set to FQDN and the encoding is the literal string
                     after that prefix.

              •      All remaining strings containing an @ are assumed to be of type USER_FQDN/RFC822  with  the
                     literal string value as encoding.

       •      If the value does not contain any @ or = characters it is parsed as follows:

              •      If  the  value  is an empty string, or equals %any[6], 0.0.0.0, ::, or * the type is set to
                     ID_ANY, which matches any other identity.

              •      If the value contains a colon (:) it is assumed to be an IPv6 address. But if  parsing  the
                     address  and  converting  it to its binary encoding fails the type is set to KEY_ID and the
                     encoding is the literal value.

              •      For all other strings an attempt at parsing them as IPv4 addresses is made. If  that  fails
                     the  type is set to FQDN and the literal value is adopted as encoding (this is where domain
                     names and simple names end up).

</pre><h4><b>SA</b> <b>EXPIRY/REKEY</b></h4><pre>
       The IKE SAs and IPsec SAs negotiated by the daemon can be configured to expire after a specific amount of
       time. For IPsec SAs this can also happen after a specified number of transmitted packets  or  transmitted
       bytes. The following settings can be used to configure this:
       Setting         Default   Setting         Default
       ──────────────────────────────────────────────────
       <b>IKE</b> <b>SA</b>                    <b>IPsec</b> <b>SA</b>
        ikelifetime         3h    lifebytes            -
                                  lifepackets          -
                                  lifetime            1h

   <b>Rekeying</b>
       IKE  SAs  as  well  as  IPsec  SAs  can  be  rekeyed before they expire. This can be configured using the
       following settings:
       Setting        Default   Setting           Default
       ───────────────────────────────────────────────────
       <b>IKE</b> <b>and</b> <b>IPsec</b> <b>SA</b>         <b>IPsec</b> <b>SA</b>
        margintime         9m    marginbytes            -
                                 marginpackets          -

   <b>Randomization</b>
       To avoid collisions the specified margins  are  increased  randomly  before  subtracting  them  from  the
       expiration limits (see formula below). This is controlled by the <b>rekeyfuzz</b> setting:
       Setting       Default
       ──────────────────────
       <b>IKE</b> <b>and</b> <b>IPsec</b> <b>SA</b>
        rekeyfuzz       100%

       Randomization can be disabled by setting <b>rekeyfuzz</b> to <b>0%</b>.

   <b>Formula</b>
       The following formula is used to calculate the rekey time of IPsec SAs:

        rekeytime = lifetime - (margintime + random(0, margintime * rekeyfuzz))

       It applies equally to IKE SAs and byte and packet limits for IPsec SAs.

   <b>Example</b>
       Let's consider the default configuration:

           lifetime = 1h
           margintime = 9m
           rekeyfuzz = 100%

       From the formula above follows that the rekey time lies between:

           rekeytime_min = 1h - (9m + 9m) = 42m
           rekeytime_max = 1h - (9m + 0m) = 51m

       Thus,  the  daemon  will  attempt  to rekey the IPsec SA at a random time between 42 and 51 minutes after
       establishing the SA. Or, in other words, between 9 and 18 minutes before the SA expires.

   <b>Notes</b>
       •      Since the rekeying of an SA needs some time, the margin values must not be too low.

       •      The value <b>margin...</b> <b>+</b> <b>margin...</b> <b>*</b> <b>rekeyfuzz</b> must not  exceed  the  original  limit.  For  example,
              specifying  <b>margintime</b>  <b>=</b> <b>30m</b> in the default configuration is a bad idea as there is a chance that
              the rekey time equals zero and, thus, rekeying gets disabled.

</pre><h4><b>FILES</b></h4><pre>
       /etc/ipsec.conf
       /etc/ipsec.d/aacerts
       /etc/ipsec.d/acerts
       /etc/ipsec.d/cacerts
       /etc/ipsec.d/certs
       /etc/ipsec.d/crls

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man5/strongswan.conf.5.html">strongswan.conf</a>(5), <a href="../man5/ipsec.secrets.5.html">ipsec.secrets</a>(5), <a href="../man8/ipsec.8.html">ipsec</a>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       Originally written for the FreeS/WAN project by Henry Spencer.  Updated and extended for  the  strongSwan
       project &lt;<a href="http://www.strongswan.org">http://www.strongswan.org</a>&gt; by Tobias Brunner, Andreas Steffen and Martin Willi.

6.0.1                                              2012-06-26                                      <u><a href="../man5/IPSEC.CONF.5.html">IPSEC.CONF</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>