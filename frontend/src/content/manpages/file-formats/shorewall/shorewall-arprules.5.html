<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arprules - Shorewall ARP rules file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/shorewall">shorewall_5.2.8-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       arprules - Shorewall ARP rules file

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>/etc/shorewall/arprules</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       IPv4 only.

       This file was added in Shorewall 4.5.12 and is used to describe low-level rules managed by arptables (8).
       These rules only affect Address Resolution Protocol (ARP), Reverse Address Resolution Protocol (RARP) and
       Dynamic Reverse Address Resolution Protocol (DRARP) frames.

       The columns in the file are as shown below. MAC addresses are specified normally (6 hexadecimal numbers
       separated by colons).

       <b>ACTION</b>
           Describes the action to take when a frame matches the criteria in the other columns. Possible values
           are:

           <b>ACCEPT</b>
               This is the default action if no rules matches a frame; it lets the frame go through.

           <b>DROP</b>
               Causes the frame to be dropped.

           <b>SNAT:</b><u>ip-address</u>
               Modifies the source IP address to the specified <u>ip-address</u>.

           <b>DNAT:</b><u>ip-address</u>
               Modifies the destination IP address to the specified <u>ip-address</u>.

           <b>SMAT:</b><u>mac-address</u>
               Modifies the source MAC address to the specified <u>mac-address</u>.

           <b>DMAT:</b><u>mac-address</u>
               Modifies the destination MAC address to the specified <u>mac-address</u>.

           <b>SNATC:</b><u>ip-address</u>
               Like SNAT except that the frame is then passed to the next rule.

           <b>DNATC:</b><u>ip-address</u>
               Like DNAT except that the frame is then passed to the next rule.

           <b>SMATC:</b><u>mac-address</u>
               Like SMAT except that the frame is then passed to the next rule.

           <b>DMATC:</b><u>mac-address</u>
               Like DMAT except that the frame is then passed to the next rule.

       <b>SOURCE</b> - <b>[</b><u>interface</u><b>[:[!]</b><u>ipaddress</u><b>[/ip</b><u>mask</u><b>][:[!]</b><u>macaddress</u><b>[/</b><u>macmask</u><b>]]]]</b>
           Where

           <u>interface</u>
               Is an interface defined in <a href="../man5/shorewall-interfaces.5.html">shorewall-interfaces</a>(5).

           <u>ipaddress</u>
               is an IPv4 address. DNS names are not allowed.

           <u>ipmask</u>
               specifies a mask to be applied to <u>ipaddress</u>.

           <u>macaddress</u>
               The source MAC address.

           <u>macmask</u>
               Mask for MAC address; must be specified as 6 hexadecimal numbers separated by colons.

           When '!' is specified, the test is inverted.

           If not specified, matches only frames originating on the firewall itself.

               <b>Caution</b>
               Either SOURCE or DEST must be specified.

       <b>DEST</b> - <b>[</b><u>interface</u><b>[:[!]</b><u>ipaddress</u><b>[/ip</b><u>mask</u><b>][:[!]</b><u>macaddress</u><b>[/</b><u>macmask</u><b>]]]]</b>
           Where

           <u>interface</u>
               Is an interface defined in <a href="../man5/shorewall-interfaces.5.html">shorewall-interfaces</a>(5).

           <u>ipaddress</u>
               is an IPv4 address. DNS Names are not allowed.

           <u>ipmask</u>
               specifies a mask to be applied to frame addresses.

           <u>macaddress</u>
               The destination MAC address.

           <u>macmask</u>
               Mask for MAC address; must be specified as 6 hexadecimal numbers separated by colons.

           When '!' is specified, the test is inverted and the rule matches frames which do not match the
           specified address/mask.

           If not specified, matches only frames originating on the firewall itself.

           If both SOURCE and DEST are specified, then both interfaces must be bridge ports on the same bridge.

               <b>Caution</b>
               Either SOURCE or DEST must be specified.

       OPCODE - [[!]<u>opcode</u>]
           Optional. Describes the type of frame. Possible <u>opcode</u> values are:

           1
               ARP Request

           2
               ARP Reply

           3
               RARP Request

           4
               RARP Reply

           5
               Dynamic RARP Request

           6
               Dynamic RARP Reply

           7
               Dynamic RARP Error

           8
               InARP Request

           9
               ARP NAK

           When '!' is specified, the test is inverted and the rule matches frames which do not match the
           specified <u>opcode</u>.

</pre><h4><b>EXAMPLE</b></h4><pre>
       The eth1 interface has both a public IP address and a private address (10.1.10.11/24). When sending ARP
       requests to 10.1.10.0/24, use the private address as the IP source:

           #ACTION                SOURCE                  DEST                ARP OPCODE
           SNAT:10.1.10.11        -                       eth1:10.1.10.0/24   1

</pre><h4><b>FILES</b></h4><pre>
       /etc/shorewall/arprules

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/shorewall.8.html">shorewall</a>(8)

Configuration Files                                09/24/2020                              <u><a href="../man5/SHOREWALL-ARPRULES.5.html">SHOREWALL-ARPRULES</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>