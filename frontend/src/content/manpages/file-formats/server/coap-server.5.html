<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>coap-server, coap-server-gnutls, coap-server-mbedtls, coap-server-openssl, coap-server-notls - CoAP</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libcoap3-bin">libcoap3-bin_4.3.4-1.1build4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       coap-server, coap-server-gnutls, coap-server-mbedtls, coap-server-openssl, coap-server-notls - CoAP
       Server based on libcoap

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>coap-server</b> [<b>-d</b> max] [<b>-e</b>] [<b>-g</b> group] [<b>-l</b> loss] [<b>-p</b> port] [<b>-r</b>] [<b>-t</b>] [<b>-v</b> num] [<b>-w</b> [port][,secure_port]] [<b>-A</b>
       address] [<b>-E</b> oscore_conf_file[,seq_file]] [<b>-G</b> group_if] [<b>-L</b> value] [<b>-N</b>] [<b>-P</b>
       scheme://addr[:port],[name1[,name2..]]] [<b>-T</b> max_token_size] [<b>-U</b> type] [<b>-V</b> num] [<b>-X</b> size] [[<b>-h</b> hint] [<b>-i</b>
       match_identity_file] [<b>-k</b> key] [<b>-s</b> match_psk_sni_file] [<b>-u</b> user]] [[<b>-c</b> certfile] [<b>-j</b> keyfile] [<b>-n</b>] [<b>-C</b>
       cafile] [<b>-J</b> pkcs11_pin] [<b>-M</b> rpk_file] [<b>-R</b> trust_casfile] [<b>-S</b> match_pki_sni_file]]

       For <b>coap-server</b> versions that use libcoap compiled for different (D)TLS libraries, <b>coap-server-notls</b>,
       <b>coap-server-gnutls</b>, <b>coap-server-openssl</b>, <b>coap-server-mbedtls</b> or <b>coap-server-tinydtls</b> may be available.
       Otherwise, <b>coap-server</b> uses the default libcoap (D)TLS support.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>coap-server</b> is an example server for the 'Constrained Application Protocol` (RFC 7252).

</pre><h4><b>OPTIONS</b> <b>-</b> <b>GENERAL</b></h4><pre>
       <b>-d</b> max
           Enable support for creation of dynamic resources when doing a PUT up to a limit of <u>max</u>. If <u>max</u> is
           reached, a 4.06 code is returned until one of the dynamic resources has been deleted.

       <b>-e</b>
           Echo back the data sent with a PUT.

       <b>-g</b> group
           Join specified multicast <u>group</u> on start up.  <b>Note:</b> DTLS over multicast is not currently supported.

       <b>-l</b> list
           Fail to send some datagrams specified by a comma separated list of numbers or number ranges
           (debugging only).

       <b>-l</b> loss%
           Randomly failed to send datagrams with the specified probability - 100% all datagrams, 0% no
           datagrams (debugging only).

       <b>-p</b> port
           The <u>port</u> on the given address will be listening for incoming connections. If (D)TLS is supported,
           then <u>port</u> + 1 will also be listened on for (D)TLS connections. The default port is 5683 if not given
           any other value.

       <b>-r</b>
           Enable multicast per resource support. If enabled, only <u>/</u>, <u>/async</u> and <u>/.well-known/core</u> are enabled
           for multicast requests support, otherwise all resources are enabled.

       <b>-t</b>
           Track resource’s observe values so observe subscriptions can be maintained over a server restart.
           Note: Use <u>kill</u> <u>SIGUSR2</u> <u>&lt;pid&gt;</u> for controlled shutdown.

       <b>-v</b> num
           The verbosity level to use (default 4, maximum is 8) for general CoAP logging.

       <b>-w</b> [port][,secure_port]
           Enable WebSockets support support on port (WS) and/or secure_port (WSS), comma separated.

       <b>-A</b> address
           The local address of the interface which the server has to listen on.

       <b>-E</b> oscore_conf_file[,seq_file]
           <u>oscore_conf_file</u> contains OSCORE configuration. See <b><a href="../man5/coap-oscore-conf.5.html">coap-oscore-conf</a></b>(5) for definitions. Optional
           <u>seq_file</u> (which is created if needed) is used to save the current transmit sequence number, so on
           server restart sequence numbers continue to increase and are not reset to prevent anti-replay
           mechanisms being triggered.

       <b>-G</b> group_if
           Use this interface for listening for the multicast group. This can be different from the implied
           interface if the <b>-A</b> option is used.

       <b>-L</b> value
           Sum of one or more COAP_BLOCK_* flag values for different block handling methods. Default is 1
           (COAP_BLOCK_USE_LIBCOAP).

               COAP_BLOCK_USE_LIBCOAP  1
               COAP_BLOCK_SINGLE_BODY  2
               COAP_BLOCK_TRY_Q_BLOCK  4

       <b>-N</b>
           Send NON-confirmable message for "observe" responses. If option <b>-N</b> is not specified, a confirmable
           response will be sent. Even if set, every fifth response will still be sent as a confirmable response
           (RFC 7641 requirement).

       <b>-P</b> scheme://address[:port],[name1[,name2[,name3..]]]
           Scheme, address, optional port of how to connect to the next proxy server and zero or more names
           (comma separated) that this proxy server is known by. The , (comma) is required. If there is no name1
           or if the hostname of the incoming proxy request matches one of these names, then this server is
           considered to be the final endpoint. If scheme://address[:port] is not defined before the leading ,
           (comma) of the first name, then the ongoing connection will be a direct connection. Scheme is one of
           coap, coaps, coap+tcp and coaps+tcp.

       <b>-T</b> max_token_size
           Set the maximum token length (8-65804).

       <b>-U</b> type
           Treat address defined by <b>-A</b> as a Unix socket address. Type is <u>coap</u> (using datagram), <u>coap+tcp</u> (using
           stream), <u>coaps</u> (DTLS using datagram) or <u>coaps+tcp</u> (TLS using stream).

       <b>-V</b> num
           The verbosity level to use (default 3, maximum is 7) for (D)TLS library logging.

       <b>-X</b> size
           Maximum message size to use for TCP based connections (default is 8388864). Maximum value of 2^32 -1.

</pre><h4><b>OPTIONS</b> <b>-</b> <b>PSK</b></h4><pre>
       (If supported by underlying (D)TLS library)

       <b>-h</b> hint
           Identity Hint to send. Default is <b>CoAP</b>. Zero length is no hint.

       <b>-i</b> match_identiity_file
           This is a file that contains one or more lines of Identity Hints and (user) Identities to match for a
           different new Pre-Shared Key (PSK) (comma separated) to be used. E.g., per line

           hint_to_match,identity_to_match,use_key

           A line that starts with # is treated as a comment.

           Note: <b>-k</b> still needs to be defined for the default case.

           Note: A match using the <b>-s</b> option may mean that the current Identity Hint is different to that
           defined by <b>-h</b>.

       <b>-k</b> key
           Pre-shared key to use for inbound connections. This cannot be empty if defined.

           Note: if <b>-c</b> <b>cafile</b> is defined, you need to define <b>-k</b> <b>key</b> as well to have the server support both PSK
           and PKI.

       <b>-s</b> match_psk_sni_file
           This is a file that contains one or more lines of received Subject Name Identifier (SNI) to match to
           use a different Identity Hint and associated Pre-Shared Key (PSK) (comma separated) instead of the <b>-h</b>
           <b>hint</b> and <b>-k</b> <b>key</b> options. E.g., per line

           sni_to_match,use_hint,with_key

           Note: <b>-k</b> <b>key</b> still needs to be defined for the default case if there is not a match.

           Note: The associated Pre-Shared Key will get updated if there is also a <b>-i</b> match. The update checking
           order is <b>-s</b> followed by <b>-i</b>.

       <b>-u</b> user
           User identity for pre-shared key mode (only used if option <b>-P</b> is set).

</pre><h4><b>OPTIONS</b> <b>-</b> <b>PKI</b></h4><pre>
       (If supported by underlying (D)TLS library)

       <b>Note:</b> If any one of <b>certfile</b>, <b>keyfile</b> or <b>cafile</b> is in PKCS11 URI naming format (pkcs11: prefix), then any
       remaining non PKCS11 URI file definitions have to be in DER, not PEM, format. Otherwise all of <b>certfile</b>,
       <b>keyfile</b> or <b>cafile</b> are in PEM format.

       <b>-c</b> certfile
           PEM file or PKCS11 URI for the certificate. The private key can also be in the PEM file, or has the
           same PKCS11 URI. If not, the private key is defined by <b>-j</b> <b>keyfile</b>.

           Note: if <b>-k</b> <b>key</b> is defined, you need to define <b>-c</b> <b>certfile</b> as well to have the server support both
           PSK and PKI.

       <b>-j</b> keyfile
           PEM file or PKCS11 URI for the private key for the certificate in <b>-c</b> <b>certfile</b> if the parameter is
           different from certfile in <b>-c</b> <b>certfile</b>.

       <b>-n</b>
           Disable remote peer certificate checking. This gives clients the ability to use PKI, but without any
           defined certificates.

       <b>-C</b> cafile
           PEM file or PKCS11 URI that contains a list of one or more CAs that are to be passed to the client
           for the client to determine what client certificate to use. Normally, this list of CAs would be the
           root CA and and any intermediate CAs. Ideally the server certificate should be signed by the same CA
           so that mutual authentication can take place. The contents of <b>cafile</b> are added to the trusted store
           of root CAs. Using the <b>-C</b> or <b>-R</b> options will will trigger the validation of the client certificate
           unless overridden by the <b>-n</b> option.

       <b>-J</b> pkcs11_pin
           The user pin to unlock access to the PKCS11 token.

       <b>-M</b>
           Raw Public Key (RPK) PEM file or PKCS11 URI that contains both PUBLIC KEY and PRIVATE KEY or just EC
           PRIVATE KEY. (GnuTLS and TinyDTLS(PEM) support only).  <b>-C</b> <b>cafile</b> or <b>-R</b> <b>trust_casfile</b> are not
           required.

       <b>-R</b> trust_casfile
           PEM file containing the set of trusted root CAs that are to be used to validate the client
           certificate. Alternatively, this can point to a directory containing a set of CA PEM files. The <b>-C</b>
           <b>cafile</b> CA does not have to be in this list and is trusted for the validation. Using <b>-R</b> <b>trust_casfile</b>
           disables common CA mutual authentication which can only be done by using <b>-C</b> <b>cafile</b>. Using the <b>-C</b> or
           <b>-R</b> options will will trigger the validation of the server certificate unless overridden by the <b>-n</b>
           option.

       <b>-S</b> match_pki_sni_file
           This option denotes a file that contains one or more lines of Subject Name Identifier (SNI) to match
           for new certificate File and new CA File (comma separated) to be used. E.g., entry per line

           sni_to_match,new_cert_file,new_ca_file

           A line that starts with # is treated as a comment.

           Note: <b>-c</b> <b>certfile</b> and <b>-C</b> <b>cafile</b> still needs to be defined for the default case

</pre><h4><b>EXAMPLES</b></h4><pre>
       •   Example

           coap-server -A ::1

       Let the server listen on localhost (port <u>5683</u>) for UDP/TCP.

       •   Example

           coap-server -A ::1 -k mysecretKey -h myhint

       Let the server listen on localhost (port <u>5683</u> for UDP/TCP and port <u>5684</u> for DTLS/TLS) with the server set
       up for PSK authentication if the client uses coaps:// or coaps+tcp:/<a href="file:/.">/.</a>

       •   Example

           coap-server -A ::1 -k mysecretKey -h myhint -p 13011

       The same, except the UDP/TCP listening port is <u>13011</u> and the DTLS/TLS listening port is <u>13012</u> (and not
       the default ports <u>5683</u> and <u>5684</u>).

       •   Example

           coap-server -A 2001:db8:81a8:0:6ef0:dead:feed:beef -v 5

       The listening address is set to <u>2001:db8:81a8:0:6ef0:dead:feed:beef</u> and the verbosity level is set to <u>5</u>.

       •   Example

           coap-server -A 2001:db8:81a8:0:6ef0:dead:feed:beef -g FF02::FD

       Set listening address to <u>2001:db8:81a8:0:6ef0:dead:feed:beef</u> and join the All CoAP Nodes multicast group
       <u>FF02::FD</u>.

</pre><h4><b>FILES</b></h4><pre>
       There are no configuration files.

</pre><h4><b>EXIT</b> <b>STATUS</b></h4><pre>
       <b>0</b>
           Success

       <b>1</b>
           Failure (syntax or usage error; configuration error; document processing failure; unexpected error)

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/coap-client.5.html">coap-client</a></b>(5) and <b><a href="../man5/coap-oscore-conf.5.html">coap-oscore-conf</a></b>(5)

</pre><h4><b>BUGS</b></h4><pre>
       Please report bugs on the mailing list for libcoap: <a href="mailto:libcoap-developers@lists.sourceforge.net">libcoap-developers@lists.sourceforge.net</a> or raise an
       issue on GitHub at https://github.com/obgm/libcoap/issues

</pre><h4><b>AUTHORS</b></h4><pre>
       The libcoap project &lt;<a href="mailto:libcoap-developers@lists.sourceforge.net">libcoap-developers@lists.sourceforge.net</a>&gt;

coap-server 4.3.4                                  04/15/2024                                     <u><a href="../man5/COAP-SERVER.5.html">COAP-SERVER</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>