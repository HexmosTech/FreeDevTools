<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>virtual - Postfix virtual alias table format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/postfix">postfix_3.10.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       virtual - Postfix virtual alias table format

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>postmap</b> <b>/etc/postfix/virtual</b>

       <b>postmap</b> <b>-q</b> <b>"</b><u>string</u><b>"</b> <b>/etc/postfix/virtual</b>

       <b>postmap</b> <b>-q</b> <b>-</b> <b>/etc/postfix/virtual</b> <b>&lt;</b><u>inputfile</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  optional  <b><a href="../man5/virtual.5.html">virtual</a></b>(5)  alias table (virtual_alias_maps) applies to all recipients: <a href="../man8/local.8.html">local</a>(8), virtual,
       and remote.  This feature is implemented in the Postfix <b><a href="../man8/cleanup.8.html">cleanup</a></b>(8) daemon before mail is  queued.   These
       tables are often queried with a full email address (including domain).

       This is unlike the <b><a href="../man5/aliases.5.html">aliases</a></b>(5) table (alias_maps) which applies only to <b><a href="../man8/local.8.html">local</a></b>(8) recipients. That table is
       only queried with the email address localpart (no domain).

       Virtual  aliasing  is  recursive;  to  terminate  recursion for a specific address, alias that address to
       itself.

       The main applications of virtual aliasing are:

       •      To redirect mail for one address to one or more addresses.

       •      To implement virtual alias domains where all addresses are aliased to addresses in other domains.

              Virtual alias domains are not to be confused with the virtual mailbox domains that are implemented
              with the Postfix <b><a href="../man8/virtual.8.html">virtual</a></b>(8) mail delivery agent. With  virtual  mailbox  domains,  each  recipient
              address can have its own mailbox.

       Virtual  aliasing  is  applied only to recipient envelope addresses, and does not affect message headers.
       Use <b><a href="../man5/canonical.5.html">canonical</a></b>(5) mapping to rewrite header and envelope addresses in general.

       Normally, the <b><a href="../man5/virtual.5.html">virtual</a></b>(5) alias table is specified as a text file that serves as input to  the  <b><a href="../man1/postmap.1.html">postmap</a></b>(1)
       command.  The result, an indexed file in <b>dbm</b> or <b>db</b> format, is used for fast searching by the mail system.
       Execute  the  command  "<b>postmap</b>  <b>/etc/postfix/virtual</b>"  to  rebuild  an  indexed  file after changing the
       corresponding text file.

       When the table is provided via other means such as NIS, LDAP or SQL, the same lookups  are  done  as  for
       ordinary indexed files.

       Alternatively,  the table can be provided as a regular-expression map where patterns are given as regular
       expressions, or lookups can be directed to a TCP-based server. In those case, the lookups are done  in  a
       slightly different way as described below under "REGULAR EXPRESSION TABLES" or "TCP-BASED TABLES".

</pre><h4><b>CASE</b> <b>FOLDING</b></h4><pre>
       The  search string is folded to lowercase before database lookup. As of Postfix 2.3, the search string is
       not case folded with database types such as regexp: or pcre: whose lookup fields can match both upper and
       lower case.

</pre><h4><b>TABLE</b> <b>FORMAT</b></h4><pre>
       The input format for the <b><a href="../man1/postmap.1.html">postmap</a></b>(1) command is as follows:

       <u>pattern</u> <u>address,</u> <u>address,</u> <u>...</u>
              When <u>pattern</u> matches a mail address, replace it by the corresponding <u>address</u>.

       blank lines and comments
              Empty lines and whitespace-only lines  are  ignored,  as  are  lines  whose  first  non-whitespace
              character is a `#'.

       multi-line text
              A  logical  line  starts  with non-whitespace text. A line that starts with whitespace continues a
              logical line.

</pre><h4><b>TABLE</b> <b>SEARCH</b> <b>ORDER</b></h4><pre>
       With lookups from indexed files such as DB or DBM, or from networked tables such as  NIS,  LDAP  or  SQL,
       each <u>user</u>@<u>domain</u> query produces a sequence of query patterns as described below.

       Each  query  pattern is sent to each specified lookup table before trying the next query pattern, until a
       match is found.

       <u>user</u>@<u>domain</u> <u>address,</u> <u>address,</u> <u>...</u>
              Redirect mail for <u>user</u>@<u>domain</u> to <u>address</u>.  This form has the highest precedence.

       <u>user</u> <u>address,</u> <u>address,</u> <u>...</u>
              Redirect mail for <u>user</u>@<u>site</u> to <u>address</u> when <u>site</u> is equal to $<b>myorigin</b>, when  <u>site</u>  is  listed  in
              $<b>mydestination</b>, or when it is listed in $<b>inet_interfaces</b> or $<b>proxy_interfaces</b>.

              This  functionality  overlaps  with  the  functionality  of  the  local  <u><a href="../man5/aliases.5.html">aliases</a></u>(5)  database. The
              difference is that <b><a href="../man5/virtual.5.html">virtual</a></b>(5) mapping can be applied to non-local addresses.

       @<u>domain</u> <u>address,</u> <u>address,</u> <u>...</u>
              Redirect mail for other users in <u>domain</u> to <u>address</u>.  This form has the lowest precedence.

              Note: @<u>domain</u> is a wild-card. With this form,  the  Postfix  SMTP  server  accepts  mail  for  any
              recipient  in <u>domain</u>, regardless of whether that recipient exists.  This may turn your mail system
              into a backscatter source: Postfix first accepts mail for non-existent recipients and  then  tries
              to return that mail as "undeliverable" to the often forged sender address.

              To avoid backscatter with mail for a wild-card domain, replace the wild-card mapping with explicit
              1:1 mappings, or add a reject_unverified_recipient restriction for that domain:

                  smtpd_recipient_restrictions =
                      ...
                      reject_unauth_destination
                      check_recipient_access
                          inline:{example.com=reject_unverified_recipient}
                  unverified_recipient_reject_code = 550

              In  the above example, Postfix may contact a remote server if the recipient is aliased to a remote
              address.

</pre><h4><b>RESULT</b> <b>ADDRESS</b> <b>REWRITING</b></h4><pre>
       The lookup result is subject to address rewriting:

       •      When the result has the form @<u>otherdomain</u>, the result becomes the same <u>user</u> in <u>otherdomain</u>.   This
              works only for the first address in a multi-address lookup result.

       •      When "<b>append_at_myorigin=yes</b>", append "<b>@$myorigin</b>" to addresses without "@domain".

       •      When "<b>append_dot_mydomain=yes</b>", append "<b>.$mydomain</b>" to addresses without ".domain".

</pre><h4><b>ADDRESS</b> <b>EXTENSION</b></h4><pre>
       When  a  mail  address  localpart  contains the optional recipient delimiter (e.g., <u>user+foo</u>@<u>domain</u>), the
       lookup order becomes: <u>user+foo</u>@<u>domain</u>, <u>user</u>@<u>domain</u>, <u>user+foo</u>, <u>user</u>, and @<u>domain</u>.

       The <b>propagate_unmatched_extensions</b> parameter controls whether an unmatched address  extension  (<u>+foo</u>)  is
       propagated to the result of a table lookup.

</pre><h4><b>VIRTUAL</b> <b>ALIAS</b> <b>DOMAINS</b></h4><pre>
       Besides  virtual  aliases,  the  virtual alias table can also be used to implement virtual alias domains.
       With a virtual alias domain, all recipient addresses are aliased to addresses in other domains.

       Virtual alias domains are not to be confused with the virtual mailbox domains that are  implemented  with
       the Postfix <b><a href="../man8/virtual.8.html">virtual</a></b>(8) mail delivery agent. With virtual mailbox domains, each recipient address can have
       its own mailbox.

       With  a  virtual  alias  domain, the virtual domain has its own user name space. Local (i.e. non-virtual)
       usernames are not visible in a virtual alias domain. In particular, local <b><a href="../man5/aliases.5.html">aliases</a></b>(5)  and  local  mailing
       lists are not visible as <u><a href="mailto:localname@virtual-alias.domain">localname@virtual-alias.domain</a></u>.

       Support for a virtual alias domain looks like:

       /etc/postfix/main.cf:
           virtual_alias_maps = hash:/etc/postfix/virtual

       Note:  some  systems  use <b>dbm</b> databases instead of <b>hash</b>.  See the output from "<b>postconf</b> <b>-m</b>" for available
       database types.

       /etc/postfix/virtual:
           <u>virtual-alias.domain</u>    <u>anything</u> (right-hand content does not matter)
           <u><a href="mailto:postmaster@virtual-alias.domain">postmaster@virtual-alias.domain</a></u> <u>postmaster</u>
           <u><a href="mailto:user1@virtual-alias.domain">user1@virtual-alias.domain</a></u>      <u>address1</u>
           <u><a href="mailto:user2@virtual-alias.domain">user2@virtual-alias.domain</a></u>      <u>address2,</u> <u>address3</u>

       The <u>virtual-alias.domain</u> <u>anything</u> entry is required for a virtual alias domain. <b>Without</b> <b>this</b> <b>entry,</b>  <b>mail</b>
       <b>is</b> <b>rejected</b> <b>with</b> <b>"relay</b> <b>access</b> <b>denied",</b> <b>or</b> <b>bounces</b> <b>with</b> <b>"mail</b> <b>loops</b> <b>back</b> <b>to</b> <b>myself".</b>

       Do  not  specify  virtual  alias domain names in the <b>main.cf</b> <b>mydestination</b> or <b>relay_domains</b> configuration
       parameters.

       With a virtual alias domain, the Postfix SMTP server accepts  mail  for  <u><a href="mailto:known-user@virtual-alias.domain">known-user@virtual-alias.domain</a></u>,
       and rejects mail for <u>unknown-user</u>@<u>virtual-alias.domain</u> as undeliverable.

       Instead  of  specifying  the  virtual  alias  domain  name via the <b>virtual_alias_maps</b> table, you may also
       specify it via the <b>main.cf</b> <b>virtual_alias_domains</b> configuration parameter.  This latter parameter uses the
       same syntax as the <b>main.cf</b> <b>mydestination</b> configuration parameter.

</pre><h4><b>REGULAR</b> <b>EXPRESSION</b> <b>TABLES</b></h4><pre>
       This section describes how the table lookups change when the table  is  given  in  the  form  of  regular
       expressions.  For  a  description  of  regular  expression  lookup  table  syntax, see <b><a href="../man5/regexp_table.5.html">regexp_table</a></b>(5) or
       <b><a href="../man5/pcre_table.5.html">pcre_table</a></b>(5).

       Each pattern is a regular expression that is applied  to  the  entire  address  being  looked  up.  Thus,
       <u>user@domain</u>  mail  addresses  are  not  broken  up  into their <u>user</u> and <u>@domain</u> constituent parts, nor is
       <u>user+foo</u> broken up into <u>user</u> and <u>foo</u>.

       Patterns are applied in the order as specified in the table, until a pattern is found  that  matches  the
       search string.

       Results  are  the  same  as  with  indexed  file  lookups, with the additional feature that parenthesized
       substrings from the pattern can be interpolated as <b>$1</b>, <b>$2</b> and so on.

</pre><h4><b>TCP-BASED</b> <b>TABLES</b></h4><pre>
       This section describes how the table lookups change when lookups are directed to a TCP-based server.  For
       a  description  of the TCP client/server lookup protocol, see <b><a href="../man5/tcp_table.5.html">tcp_table</a></b>(5).  This feature is available in
       Postfix 2.5 and later.

       Each lookup operation uses the entire address once.  Thus, <u>user@domain</u> mail addresses are not  broken  up
       into their <u>user</u> and <u>@domain</u> constituent parts, nor is <u>user+foo</u> broken up into <u>user</u> and <u>foo</u>.

       Results are the same as with indexed file lookups.

</pre><h4><b>BUGS</b></h4><pre>
       The table format does not understand quoting conventions.

</pre><h4><b>CONFIGURATION</b> <b>PARAMETERS</b></h4><pre>
       The  following <b>main.cf</b> parameters are especially relevant to this topic. See the Postfix <b>main.cf</b> file for
       syntax details and for default values. Use the "<b>postfix</b> <b>reload</b>" command after a configuration change.

       <b>virtual_alias_maps</b> <b>($virtual_maps)</b>
              Optional lookup tables that are often searched with a full email address  (including  domain)  and
              that  apply  to  all recipients: <b><a href="../man8/local.8.html">local</a></b>(8), virtual, and remote; this is unlike alias_maps that are
              only searched with an email address  localpart  (no  domain)  and  that  apply  only  to  <b><a href="../man8/local.8.html">local</a></b>(8)
              recipients.

       <b>virtual_alias_domains</b> <b>($virtual_alias_maps)</b>
              Postfix is the final destination for the specified list of virtual alias domains, that is, domains
              for which all addresses are aliased to addresses in other local or remote domains.

       <b>propagate_unmatched_extensions</b> <b>(canonical,</b> <b>virtual)</b>
              What address lookup tables copy an address extension from the lookup key to the lookup result.

       Other parameters of interest:

       <b>inet_interfaces</b> <b>(all)</b>
              The local network interface addresses that this mail system receives mail on.

       <b>mydestination</b> <b>($myhostname,</b> <b>localhost.$mydomain,</b> <b>localhost)</b>
              The list of domains that are delivered via the $local_transport mail delivery transport.

       <b>myorigin</b> <b>($myhostname)</b>
              The  domain  name  that  locally-posted mail appears to come from, and that locally posted mail is
              delivered to.

       <b>owner_request_special</b> <b>(yes)</b>
              Enable special treatment for owner-<u>listname</u> entries  in  the  <b><a href="../man5/aliases.5.html">aliases</a></b>(5)  file,  and  don't  split
              owner-<u>listname</u> and <u>listname</u>-request address localparts when the recipient_delimiter is set to "-".

       <b>proxy_interfaces</b> <b>(empty)</b>
              The remote network interface addresses that this mail system receives mail on by way of a proxy or
              network address translation unit.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/cleanup.8.html">cleanup</a>(8), canonicalize and enqueue mail
       <a href="../man1/postmap.1.html">postmap</a>(1), Postfix lookup table manager
       <a href="../man5/postconf.5.html">postconf</a>(5), configuration parameters
       <a href="../man5/canonical.5.html">canonical</a>(5), canonical address mapping

</pre><h4><b>README</b> <b>FILES</b></h4><pre>
       Use "<b>postconf</b> <b>readme_directory</b>" or "<b>postconf</b> <b>html_directory</b>" to locate this information.
       ADDRESS_REWRITING_README, address rewriting guide
       DATABASE_README, Postfix lookup table overview
       VIRTUAL_README, domain hosting guide

</pre><h4><b>LICENSE</b></h4><pre>
       The Secure Mailer license must be distributed with this software.

</pre><h4><b>AUTHOR(S)</b></h4><pre>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

       Wietse Venema
       Google, Inc.
       111 8th Avenue
       New York, NY 10011, USA

                                                                                                      <u><a href="../man5/VIRTUAL.5.html">VIRTUAL</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>