<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>detect.conf — provides the configuration for detection of locations for whereami.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/whereami">whereami_0.3.35_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       detect.conf — provides the configuration for detection of locations for <b>whereami</b>.

</pre><h4><b>DESCRIPTION</b></h4><pre>
   <b>Syntax</b>
       The  <b>detect.conf</b> file specifies the tests that allow <b>whereami</b> to figure out where it is.  The environment
       of such tests can be manipulated using the 'set' command.  Tests can be performed conditionally upon  the
       results of other tests using "if ... fi" constructs.

       Comments  are  lines  starting  with  the  `#'  character.   Leading  whitespace is ignored on all lines,
       including comment lines.

   <b>Internal</b> <b>Commands</b>
       The syntax of this file is fairly straightforward.  Tests are specified thus:

       <b>testname</b> <u>parameter</u> <u>locations</u>
                 The command <b>testname</b> is run with the single <u>parameter</u> (which may be split internally).  If  the
                 return  value  is  0,  the  test  is  considered  `successful' and the <u>locations</u> are considered
                 `discovered'.

                 <u>locations</u>  is  a  list  of  comma  separated  identifiers,  each  one   matching   the   regexp
                 ``<u>[[:alnum:]._-]+</u>''.

                 On  success,  processing  will  skip  all  non-`always'  statements up to the next `if' or `fi'
                 keyword, whichever is earlier.

       <b>if</b> <u>location</u> <u>statements</u> <u>...</u> [elif <u>location</u> <u>statements</u> <u>...</u>]... [else <u>statements</u> <u>...</u>] fi
                 If the <u>location</u> is in the list of locations discovered so far, then the statements in the  `if'
                 branch  will  be  processed.  Otherwise, if present, the statements in either the `elif' or the
                 `else' (as appropriate) branch will be processed.

                 Note that nesting of `if' blocks is not supported at this time.

       <b>always</b> <b>testname</b> <u>parameter</u> <u>locations</u>
                 A test preceded by the word `always' is not skipped unless it is within the inactive branch  of
                 an `if' clause.

       <b>set</b> <u>variable</u> <u>value</u>
                 The  environment  <u>variable</u> is defined as <u>value</u> for all subsequent test scripts and in the shell
                 script eventually constructed by <b>whereami</b>.

       <b>at</b> <u>locations</u>
                 The <u>locations</u> will be added to the "discovered" list.

       <b>notat</b> <u>locations</u>
                 The <u>locations</u> will be removed from the "discovered" list.

       <b>echo</b>      The <u>"quoted</u> <u>text</u> <u>string"</u> will be displayed to the user on stdout.

       The <u>parameter</u> and <u>locations</u>     may be lists, with a comma (",") used to separate multiple values.

   <b>Tests</b>
       Any program may be used as a test so long as it accepts a single parameter and returns  zero  on  success
       and non-zero on failure.

       If a parameter of the test script must contain a space, it parameter will need to be quoted.

       A number of tests are included in the whereami package.

       testdhcp <u>[interface,]pattern</u>
                 Tests  for  the assignment by DHCP of an IP address matching the specified address <u>pattern</u>.  If
                 not specified, the <u>interface</u> defaults to `eth0'.

                 Note that the first execution of this test during a particular run of <b>whereami</b> induces  a  DHCP
                 request on the specified interface.

       testmii <u>interface</u>
                 Checks  for  the  presence of a link on <u>interface</u> using the <b>mii-tool</b> utility.  If a link is not
                 found then the interface will be 'down'ed to limit side-effects on other detection later.

       testpppoe <u>interface</u>
                 Tries to start a PPPoE connection on the specified  interface.   Success  is  returned  if  the
                 connection starts.

       testarp <u>interface</u>,<u>mac_address</u>,<u>ip_address</u>
                 Performs  an  <b>arping</b> (Debian package: iputils-arping) to look for the specified <u>mac_address</u> and
                 <u>ip_address</u> combination on the network connected to <u>interface</u>.

       testping [<u>interface</u>,]<u>ip_to_ping</u>,<u>ip_to_use</u>
                 Uses the <b>fping</b> program to perform a fast ping to look for the presence of a particular host  on
                 the local network.

       testpci <u>pattern</u>
                 Searches for the <u>pattern</u> in the output of <b>lspci</b> <b>-v</b>.

                 This enables checking for specific hardware, such as a particular type of docking station.

       testmodule <u>pattern</u>
                 Searches for the <u>pattern</u> in the output of <b>lsmod</b>.

                 This  is  useful  for  checking  for  the  presence  of a particular PCMCIA card, or possibly a
                 particular kernel configuration.

       testap [<u>interface</u>,]scan

       testap <u>pattern</u>[,<u>WEP</u> <u>Key</u>]

       testap [<u>interface</u>,]<u>pattern</u>,<u>WEP</u> <u>Key</u>
                 The <u>pattern</u> is a regexp (egrep regexp) used to match AP essids:  when  this  regexp  matches  a
                 detected essid the test is considered succesfull.

                 This  check  does  not  require  encryption  to  be  set  up  to work, although it may not find
                 stealthier equipment - use testssid in that case.

                 The 'scan' option will cause a new scan, and the  first  call  should  have  this  option  set.
                 Subsequent  calls will use the results of that first scan, reducing the overhead for those busy
                 people who connect to many WLANs!

                 If a WEP key is supplied, and a pattern match is found,  the  key  will  be  assigned  to  that
                 interface so that subsequent tests should work correctly.

                 When  using the <u>WEP</u> <u>key</u> you may in some cases desire to pass additional parameters to iwconfig.
                 These parameters may be passed preceding the WEP key and  separated  with  an  underscore.  For
                 example   "restricted_0123-4567-89"  will  force  the  card  to  be  configured  to  insist  on
                 'restricted' mode at the same time as the key was set.

       testappassive [<u>interface</u>,]scan

       testappassive <u>pattern</u>

       testap [<u>interface</u>,]<u>pattern</u>
                 Checks whether the specified AP is present, passively.  This check does not alter the essid  on
                 the  interface,  or  set the WEP key like the testap test.  It just uses iwlist <u>interface</u> scan.
                 This is useful where you have another external script that sets up all the wifi  settings,  and
                 running  whereami  a  second  time  destroys the running wifi connection, as can happen on boot
                 where networking is intialised before whereami starting in run level 2.

                 The 'scan' option will cause a new scan, and the  first  call  should  have  this  option  set.
                 Subsequent  calls will use the results of that first scan, reducing the overhead for those busy
                 people who connect to many WLANs!

       testprocsys <u>proc-or-sys-path</u>,<u>egrep-pattern</u>
                 Checks the specified <a href="file:/sys">/sys</a> or <a href="file:/proc">/proc</a> file to see if it contains the given egrep expression.  Non-
                 existent file results in failure, as well as a failed match.  Useful for those interfaces  that
                 require  to  hotplug  to  be  configured  so that firmware can be loaded.  On machine shutdown,
                 hotplug can be disabled before networking interfaces, and this  enables  whereami  to  function
                 correctly in those circumstances.

       testssid <u>ssid</u>[,<u>key</u>]
                 Checks  whether  the  wireless  interface  is  in range of the specified <u>ssid</u>, using the key if
                 supplied.  The key should be  formatted  as  for  iwconfig.   What  works  for  me  looks  like
                 da18babe100ea4beadb74324bc ("128" bits) or fe3d1b3ed7 (40 bits).

                 This  script  will  also  respond  to  a TIMEOUT variable which is set before it is called, but
                 waiting for $TIMEOUT seconds for the network to settle (default 2).

                 This is useful for checking which wireless LAN is in range.

       testreceived [<u>interface</u>]
                 Checks whether the <u>interface</u> in question has received any bytes.

                 This is useful for checking which network interface is actually connected to a network.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following examples show simple setups, firstly for a wired only configuration,  and  secondly  for  a
       mixed wireless and wired setup.

       <b>A</b> <b>Simple</b> <b>Wired</b> <b>DHCP</b> <b>Configuration</b>

       # Simple wired DHCP with two networks
       default undocked
       testmii eth0 lan
       if lan
       set INTERFACE eth0
       testdhcp    restart    dhcp
       fi
       if dhcp
       testdhcp    '192.168.1.1'    home
       testdhcp    '152.81.*.*'    univ
       fi

       <b>A</b> <b>Wired</b> <b>and</b> <b>Wireless</b> <b>Configuration</b>

       # Configuration including both wired and wireless networks
       default undocked
       testmii eth0 lan

       # We prefer a wired network, but if we aren't wired
       # we will look for a WLAN.
       if lan
       set INTERFACE eth0
       testdhcp    restart    dhcp
       else
       set INTERFACE wlan0
       testap scan wlan
       fi

       # Try WLANs until it we find one that works
       if wlan
       testap  homessid,dead-beef-dead-beef-dead-beef-be wlhome_enc
       testap  homessid wlhome_open
       fi

       # If we are at a WLAN we should have the AP setup now
       if wlan
       # WLAN almost always will be DHCP
       testdhcp    restart    dhcp
       fi

       # Now identify the actual network
       if dhcp
       testdhcp    '192.168.1.1'    home
       testdhcp    '192.168.1.2'    wlhomeip
       testdhcp    '152.81.*.*'    work
       fi

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/whereami.8.html">whereami</a></b>(8), <b><a href="../man5/whereami.conf.5.html">whereami.conf</a></b>(5)

       Further documentation is available in the /usr/share/doc/whereami directory.

</pre><h4><b>FILES</b></h4><pre>
       <b>/etc/whereami/detect.conf</b>
                 The file we are talking about in this here manpage.

       <b>/etc/whereami/whereami.conf</b>
                 Defines  the  actions  performed as a result of entering, leaving, or remaining at a particular
                 location.

</pre><h4><b>LIMITATIONS</b></h4><pre>
       The `if' syntax does not support nesting.

</pre><h4><b>AUTHOR</b></h4><pre>
       This manual page was written by Andrew McMillan &lt;<a href="mailto:awm@debian.org">awm@debian.org</a>&gt; for the <b>Debian</b> <b>GNU/Linux</b> system (but may
       be used by others).  Permission is granted to copy, distribute and/or  modify  this  document  under  the
       terms of the GPL version 2.

                                                                                                  <u><a href="../man5/detect.conf.5.html">detect.conf</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>