<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>auditd.conf - time-based rotation of audit logs</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/auditd">auditd_4.0.5-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       auditd.conf - time-based rotation of audit logs

</pre><h4><b>DESCRIPTION</b></h4><pre>
       By  default, the audit daemon (auditd) supports size-based log rotation, where logs are rotated once they
       reach a specified size, as configured in <u>/etc/audit/auditd.conf.</u>  This manual  describes  an  alternative
       method:  time-based log rotation using <b>cron.</b>  Using this approach, audit logs can be rotated at specified
       intervals (hourly, daily, weekly or on a custom date), regardless of their size.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       <b>1.Disable</b> <b>Size-Based</b> <b>Rotation:</b>

       To enable time-based log rotation, first disable <b>auditd's</b> built-in size-based  rotation  by  setting  the
       following parameter in <u>/etc/audit/auditd.conf:</u>

              max_log_file_action = ignore

       <b>2.</b> <b>Configure</b> <b>Log</b> <b>Retention:</b>

       The <b>num_logs</b> parameter determines the number of rotated log files to keep. For daily rotation, setting

              num_logs = 7

       ensures  that  logs  from the last seven days are retained. However, on busy systems, audit logs may grow
       rapidly, potentially leading to a lack of disk space. To prevent this, ensure that the  <b>space_left_action</b>
       parameter is configured to handle low-disk-space situations appropriately.

       <b>3.</b> <b>Apply</b> <b>Configuration</b> <b>Changes:</b>

       After modifying the main auditd configuration file, reload auditd to apply the changes:

              auditctl --signal reload

       <b>4.</b> <b>Deploy</b> <b>the</b> <b>Rotation</b> <b>Script:</b>

       Copy  the  provided  <b>auditd.cron</b>  script to the appropriate cron directory ( <u>cron.daily</u> or <u>cron.hourly</u> or
       <u>cron.weekly</u> , depending on your rotation preference). Then, ensure  the  file  has  the  correct  SELinux
       labels:

              cp /usr/share/doc/audit/auditd.cron <a href="file:/etc/cron.daily">/etc/cron.daily</a>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/auditd.conf.5.html">auditd.conf</a></b>(5), <b><a href="../man8/auditd.8.html">auditd</a></b>(8), <b><a href="../man8/cron.8.html">cron</a>(8).</b>

</pre><h4><b>AUTHOR</b></h4><pre>
       Attila Lakatos

Red Hat                                             Feb 2025                                      <u><a href="../man5/AUDITD.CRON.5.html">AUDITD.CRON</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>