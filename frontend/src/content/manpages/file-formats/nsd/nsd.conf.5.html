<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nsd.conf - NSD configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/nsd">nsd_4.12.0-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>nsd.conf</b> - NSD configuration file

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>nsd.conf</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This file is used to configure <a href="../man8/nsd.8.html">nsd</a>(8). It specifies options for the nsd server, zone files, primaries and
       secondaries.

       The file format has attributes and values. Some attributes have attributes inside them. The notation is:

       attribute: value

       Comments  start  with  #  and  last  to the end of line. Empty lines are ignored, as is whitespace at the
       beginning of a line. Quotes must be used for values with spaces in them, eg. "file name.zone".

</pre><h4><b>EXAMPLE</b></h4><pre>
       An example of a short nsd.conf file is below.

       # Example nsd.conf file for example.com.
       # This is a comment.

       server:
            server-count: 1 # use this number of cpu cores
            username: nsd
            zonelistfile: /var/lib/nsd/zone.list
            logfile: /var/log/nsd.log
            pidfile: /run/nsd/nsd.pid
            xfrdfile: /var/lib/nsd/xfrd.state

       zone:
            name: example.com
            zonefile: /etc/nsd/example.com.zone

       zone:
            # this server is the primary and 192.0.2.1 is the secondary.
            name: primaryzone.com
            zonefile: /etc/nsd/primaryzone.com.zone
            notify: 192.0.2.1 NOKEY
            provide-xfr: 192.0.2.1 NOKEY

       zone:
            # this server is the secondary and 192.0.2.2 is the primary.
            name: secondaryzone.com
            zonefile: /etc/nsd/secondaryzone.com.zone
            allow-notify: 192.0.2.2 NOKEY
            request-xfr: 192.0.2.2 NOKEY

       Then, use kill -HUP to reload changes from primary zone files.  And use kill -TERM to stop the server.

</pre><h4><b>FILE</b> <b>FORMAT</b></h4><pre>
       There must be whitespace between keywords. Attribute keywords end with  a  colon  ':'.  An  attribute  is
       followed by its containing attributes, or a value.

       At  the  top  level,  only  <b>server:</b>,  <b>verify:</b>,  <b>key:</b>, <b>pattern:</b>, <b>zone:</b>, <b>tls-auth:</b>, and <b>remote-control:</b> are
       allowed. These are followed by their attributes or a  new  top-level  keyword.  The  <b>zone:</b>  attribute  is
       followed  by  zone  options.  The <b>server:</b> attribute is followed by global options for the <b>NSD</b> server. The
       <b>verify:</b> attribute is used to control zone verification. A <b>key:</b> attribute  is  used  to  define  keys  for
       authentication. The <b>pattern:</b> attribute is followed by the zone options for zones that use the pattern.  A
       <b>tls-auth:</b>  attribute  is  used to define authentication attributes for TLS connections used for XFR-over-
       TLS.

       Files can be included using the <b>include:</b> directive. It can appear anywhere, and takes a  single  filename
       as  an  argument.  Processing continues as if the text from the included file were copied into the config
       file at that point.  If a chroot is used, an absolute filename is needed (with the chroot prepended),  so
       that the include can be parsed before and after application of the chroot (and the knowledge of what that
       chroot  is).   You  can  use '*' to include a wildcard match of files, eg. "foo/nsd.d/*.conf".  Also '?',
       '{}', '[]', and '~' work, see <b><a href="../man7/glob.7.html">glob</a></b>(7).  If no files match the pattern, this is not an error.

   <b>Server</b> <b>Options</b>
       The global options (if not overridden from the NSD command-line) are taken from the <b>server:</b> clause. There
       may only be one <b>server:</b> clause.

       <b>ip-address:</b> &lt;ip4 or ip6&gt;[@port] [servers] [bindtodevice] [setfib]
              NSD will bind to the listed ip-address. Can be given multiple times to bind multiple ip-addresses.
              Optionally, a port number can be given.  If none are given NSD listens to the wildcard  interface.
              Same as command-line option <b>-a.</b>

              To  limit which NSD server(s) listen on the given interface, specify one or more servers separated
              by whitespace after &lt;ip&gt;[@port]. Ranges can be used as a shorthand to specify multiple consecutive
              servers. By default every server will listen.

              If an interface name is used instead of ip4 or ip6, the list of IP addresses associated with  that
              interface is picked up and used at server start.

              For servers with multiple IP addresses that can be used to send traffic to the internet, list them
              one  by  one,  or the source address of replies could be wrong.  This is because if the udp socket
              associates a source address of 0.0.0.0 then the kernel picks an ip-address with which to  send  to
              the  internet,  and  it  picks  the  wrong  one.  Typically needed for anycast instances.  Use ip-
              transparent to be able to list addresses that turn on later (typical for certain load-balancing).

       <b>interface:</b> &lt;ip4 or ip6&gt;[@port] [servers] [bindtodevice] [setfib]
              Same as ip-address (for ease of compatibility with unbound.conf).

       <b>ip-transparent:</b> &lt;yes or no&gt;
              Allows NSD to bind to non local addresses. This is useful to have NSD listen to IP addresses  that
              are  not  (yet) added to the network interface, so that it can answer immediately when the address
              is added. Default is no.

       <b>ip-freebind:</b> &lt;yes or no&gt;
              Set the IP_FREEBIND option to bind to nonlocal addresses and interfaces that are down.  Similar to
              ip-transparent.  Default is no.

       <b>reuseport:</b> &lt;yes or no&gt;
              Use the SO_REUSEPORT  socket  option,  and  create  file  descriptors  for  every  server  in  the
              server-count.   This  improves  performance  of the network stack.  Only really useful if you also
              configure a server-count higher than 1 (such as, equal to the number of cpus).  The default is no.
              It works on Linux, but does not work on FreeBSD, and likely does not work on other systems.

       <b>send-buffer-size:</b> &lt;number&gt;
              Set the send buffer size for query-servicing sockets.  Set to 0 to use the default settings.

       <b>receive-buffer-size:</b> &lt;number&gt;
              Set the receive buffer size for query-servicing sockets.  Set to 0 to use the default settings.

       <b>debug-mode:</b> &lt;yes or no&gt;
              Turns on debugging mode for nsd, does not fork a daemon process.  Default is no. Same as  command-
              line  option <b>-d.</b>  If set to yes it does not fork and stays in the foreground, which can be helpful
              for command-line debugging, but is also used by certain server supervisor processes  to  ascertain
              that the server is running.

       <b>do-ip4:</b> &lt;yes or no&gt;
              If yes, NSD listens to IPv4 connections.  Default yes.

       <b>do-ip6:</b> &lt;yes or no&gt;
              If yes, NSD listens to IPv6 connections.  Default yes.

       <b>database:</b> &lt;filename&gt;
              This  option  is  ignored  by  NSD versions 4.8.0 and newer, because the database feature has been
              removed.

       <b>zonelistfile:</b> &lt;filename&gt;
              By default <u>/var/lib/nsd/zone.list</u> is used. The specified file is used  to  store  the  dynamically
              added  list  of  zones.  The list is written to by NSD to add and delete zones.  It is a text file
              with a zone-name and pattern-name on each line.  This file is used for the nsd-control addzone and
              delzone commands.

       <b>identity:</b> &lt;string&gt;
              Returns the specified identity when asked for CH TXT ID.SERVER.  Default is the name  as  returned
              by  <a href="../man3/gethostname.3.html">gethostname</a>(3).  Same  as  command-line option <b>-i</b>.  See hide-identity to set the server to not
              respond to such queries.

       <b>version:</b> &lt;string&gt;
              Returns the specified version string when  asked  for  CH  TXT  version.server,  and  version.bind
              queries.   Default  is  the  compiled  package version.  See hide-version to set the server to not
              respond to such queries.

       <b>nsid:</b> &lt;string&gt;
              Add the specified nsid to the EDNS section of the answer when queried with an  NSID  EDNS  enabled
              packet.   As a sequence of hex characters or with ascii_ prefix and then an ascii string.  Same as
              command-line option <b>-I</b>.

       <b>logfile:</b> &lt;filename&gt;
              Log messages to the  logfile.  The  default  is  to  log  to  stderr  and  syslog  (with  facility
              LOG_DAEMON). Same as command-line option <b>-l</b>.

       <b>log-only-syslog:</b> &lt;yes or no&gt;
              Log messages only to syslog.  Useful with systemd so that print to stderr does not cause duplicate
              log  strings  in journald.  Before syslog has been opened, the server uses stderr.  Stderr is also
              used if syslog is not available.  Default is no.

       <b>server-count:</b> &lt;number&gt;
              Start this many NSD servers. Default is 1. Same as command-line option <b>-N</b>.

       <b>cpu-affinity:</b> &lt;number&gt; &lt;number&gt; ...
              Overall CPU affinity for NSD server(s). Default is no affinity.

       <b>server-N-cpu-affinity:</b> &lt;number&gt;
              Bind NSD server specified by N to a specific core. Default is to have affinity set to  every  core
              specified in cpu-affinity. This setting only takes effect if cpu-affinity is enabled.

       <b>xfrd-cpu-affinity:</b> &lt;number&gt;
              Bind  xfrd  to  a  specific  core.  Default  is  to  have  affinity set to every core specified in
              cpu-affinity. This setting only takes effect if cpu-affinity is enabled.

       <b>tcp-count:</b> &lt;number&gt;
              The maximum number of concurrent, active TCP connections by each server.  Default is 100. Same  as
              command-line option <b>-n</b>.  That is the number of requests from clients to this server.

       <b>tcp-reject-overflow:</b> &lt;yes or no&gt;
              If  set  to  yes,  TCP  connections  made  beyond  the  maximum  set  by tcp-count will be dropped
              immediately (accepted and closed).  Default is no.

       <b>tcp-query-count:</b> &lt;number&gt;
              The maximum number of queries served on a single TCP connection.  Default is 0, meaning  there  is
              no maximum.

       <b>tcp-timeout:</b> &lt;number&gt;
              Overrides  the default TCP timeout. This also affects zone transfers over TCP.  The default is 120
              seconds.

       <b>tcp-mss:</b> &lt;number&gt;
              Maximum segment size (MSS) of TCP socket on which the server responds to queries. Value lower than
              common MSS on Ethernet (1220 for example) will address  path  MTU  problem.   Note  that  not  all
              platform supports socket option to set MSS (TCP_MAXSEG).  Default is system default MSS determined
              by interface MTU and negotiation between server and client.

       <b>outgoing-tcp-mss:</b> &lt;number&gt;
              Maximum  segment  size  (MSS)  of  TCP socket for outgoing XFR request to other nameservers. Value
              lower than common MSS on Ethernet (1220 for example) will address path MTU problem.  Note that not
              all platform supports socket option to set  MSS  (TCP_MAXSEG).   Default  is  system  default  MSS
              determined by interface MTU and negotiation between NSD and other servers.

       <b>xfrd-tcp-max:</b> &lt;number&gt;
              Number  of sockets for xfrd to use for outgoing zone transfers. Default 128.  Increase it to allow
              more zone transfer sockets, like to 256.  That is for zone transfers requested by this server from
              other servers.  To save memory, this can be  lowered,  set  it  lower  together  with  some  other
              settings to have reduced memory footprint for NSD. xfrd-tcp-max: 32 and xfrd-tcp-pipeline: 128 and
              rrl-size: 1000

              This  reduces  memory  footprint, other memory usage is caused mainly by the server-count setting,
              the number of server processes, and the tcp-count setting, which keeps buffers per server process,
              and by the size of the zone data.

       <b>xfrd-tcp-pipeline:</b> &lt;number&gt;
              Number of simultaneous outgoing zone transfers that are possible on the tcp sockets of  xfrd.  Max
              is 65536, default is 128. That is for zone transfers requested by this server from other servers.

       <b>ipv4-edns-size:</b> &lt;number&gt;
              Preferred EDNS buffer size for IPv4.  Default 1232.

       <b>ipv6-edns-size:</b> &lt;number&gt;
              Preferred EDNS buffer size for IPv6.  Default 1232.

       <b>pidfile:</b> &lt;filename&gt;
              Use  the  pid  file instead of the platform specific default, usually "<u>/run/nsd/nsd.pid</u>".  Same as
              command-line option <b>-P</b>.  With "" there is no pidfile, for some startup management setups, where  a
              pidfile  is not useful to have.  The default can be set at compile time, sometimes to "". Then the
              config option and commandline option can be used to specify that a pidfile is used, different from
              its compile time default value.  The file is not chowned to the user from  the  <b>username:</b>  option,
              for  permission  safety reasons. It remains owned to the user by which the server was started. The
              file may not be removed after the server is finished and quit, since permissions for the  username
              may not make this possible.

       <b>port:</b> &lt;number&gt;
              Answer queries on the specified port. Default is 53. Same as command-line option <b>-p</b>.

       <b>statistics:</b> &lt;number&gt;
              If  not  present  no  statistics are dumped. Statistics are produced every number seconds. Same as
              command-line option <b>-s</b>.

       <b>chroot:</b> &lt;directory&gt;
              NSD will chroot on startup to the specified directory. Note that if elsewhere in the configuration
              you specify an absolute pathname to a file inside the chroot, you have to prepend the <b>chroot</b> path.
              That way, you can switch the chroot option on and off without having to modify  anything  else  in
              the  configuration. Set the value to "" (the empty string) to disable the chroot. By default "" is
              used. Same as command-line option <b>-t</b>.

       <b>username:</b> &lt;username&gt;
              After binding the socket, drop user privileges and assume the username. Can  be  username,  id  or
              id.gid. Same as command-line option <b>-u</b>.

       <b>zonesdir:</b> &lt;directory&gt;
              Change  the  working  directory  to the specified directory before accessing zone files. Also, NSD
              will access <b>zonelistfile</b>, <b>logfile</b>, <b>pidfile</b>, <b>xfrdfile</b>, <b>xfrdir</b>,  <b>server-key-file</b>,  <b>server-cert-file</b>,
              <b>control-key-file</b>  and <b>control-cert-file</b> relative to this directory. Set the value to "" (the empty
              string) to disable the change of working directory. By default "<u>/etc/nsd</u>" is used.

       <b>difffile:</b> &lt;filename&gt;
              Ignored, for compatibility with NSD3 config files.

       <b>xfrdfile:</b> &lt;filename&gt;
              The soa timeout and zone transfer daemon in NSD will save its state to this file.  State  is  read
              back after a restart. The state file can be deleted without too much harm, but timestamps of zones
              will  be  gone.   If  it  is configured as "", the state file is not used, all secondary zones are
              checked for updates upon startup.  For more details see the section on  zone  expiry  behavior  of
              NSD. Default is <u>/var/lib/nsd/xfrd.state</u>.

       <b>xfrdir:</b> &lt;directory&gt;
              The zone transfers are stored here before they are processed.  A directory is created here that is
              removed when NSD exits.  Default is <u><a href="file:/tmp">/tmp</a></u>.

       <b>xfrd-reload-timeout:</b> &lt;number&gt;
              If  this  value is -1, xfrd will not trigger a reload after a zone transfer. If positive xfrd will
              trigger a reload after a zone transfer, then it will wait for the number of seconds before it will
              trigger a new reload. Setting this value throttles the reloads to once per the number of  seconds.
              The default is 1 second.

       <b>verbosity:</b> &lt;level&gt;
              This  value  specifies  the  verbosity  level for (non-debug) logging.  Default is 0. 1 gives more
              information  about  incoming  notifies  and  zone  transfers.  2  lists  soft  warnings  that  are
              encountered. 3 prints more information. Same as command-line option <b>-V</b>.

              Verbosity  0  will  print  warnings  and  errors,  and other events that are important to keep NSD
              running.

              Verbosity 1 prints additionally messages of interest.  Successful  notifies,  successful  incoming
              zone  transfer  (the  zone is updated), failed incoming zone transfers or the inability to process
              zone updates.

              Verbosity 2 prints additionally soft errors, like connection resets over TCP.  And notify refusal,
              and axfr request refusals.

       <b>hide-version:</b> &lt;yes or no&gt;
              Prevent NSD from replying with the version string on CHAOS class queries.  Default is no.

       <b>hide-identity:</b> &lt;yes or no&gt;
              Prevent NSD from replying with the identity string on CHAOS class queries.  Default is no.

       <b>drop-updates:</b> &lt;yes or no&gt;
              If set to yes, drop received packets with the UPDATE opcode.  Default is no.

       <b>use-systemd:</b> &lt;yes or no&gt;
              This option is deprecated and ignored.  If compiled with  libsystemd,  NSD  signals  readiness  to
              systemd and use of the option is not necessary.

       <b>log-time-ascii:</b> &lt;yes or no&gt;
              Log  time  in ascii, if "no" then in seconds epoch.  Default is yes.  This chooses the format when
              logging to file.  The printout via syslog has a timestamp formatted by syslog.

       <b>log-time-iso:</b> &lt;yes or no&gt;
              Log time in ISO8601 format, if <b>log-time-ascii:</b> yes is also set.  Default is no.

       <b>round-robin:</b> &lt;yes or no&gt;
              Enable round robin rotation of records in the answer.  This changes the order of  records  in  the
              answer and this may balance load across them.  The default is no.

       <b>minimal-responses:</b> &lt;yes or no&gt;
              Enable  minimal  responses  for  smaller answers.  This makes packets smaller.  Extra data is only
              added for referrals, when it is really necessary.  This is different  from  the  --enable-minimal-
              responses  configure  time  option, that reduces packets, but exactly to the fragmentation length,
              the nsd.conf option reduces packets as small as possible.  The default is no.

       <b>confine-to-zone:</b> &lt;yes or no&gt;
              If set to yes, additional information will not be added to the response if the apex  zone  of  the
              additional  information does not match the apex zone of the initial query (E.G. CNAME resolution).
              Default is no.

       <b>refuse-any:</b> &lt;yes or no&gt;
              Refuse queries of type ANY.  This is useful to stop query floods trying to  get  large  responses.
              Note  that  rrl  ratelimiting  also  has  type ANY as a ratelimiting type.  It sends truncation in
              response to UDP type ANY queries, and it allows TCP type ANY queries like normal.  The default  is
              no.   With the option turned off, NSD behaves according to RFC 8482 4.1. It minimizes the response
              with one RRset. Popular and not large types, like A, AAAA and MX are preferred, and  large  types,
              like DNSKEY and RRSIG are picked with a lower preference than other types. This makes the response
              smaller.

       <b>reload-config:</b> &lt;yes or no&gt;
              Reload configuration file and update TSIG keys and zones on SIGHUP.  Default is no.

       <b>zonefiles-check:</b> &lt;yes or no&gt;
              Make  NSD  check  the mtime of zone files on start and sighup.  If you disable it it starts faster
              (less disk activity in case of a lot of zones).  The  default  is  yes.   The  nsd-control  reload
              command reloads zone files regardless of this option.

       <b>zonefiles-write:</b> &lt;seconds&gt;
              Write  updated  secondary  zones  to  their  zonefile  every  N seconds.  If the zone or pattern's
              "zonefile" option is set to "" (empty string), no zonefile is written.  The  default  is  3600  (1
              hour).

       <b>rrl-size:</b> &lt;numbuckets&gt;
              This  option  gives  the size of the hashtable. Default 1000000. More buckets use more memory, and
              reduce the chance of hash collisions.

       <b>rrl-ratelimit:</b> &lt;qps&gt;
              The max qps allowed (from one query source). Default is on (with a suggested 200 qps). If set to 0
              then it is disabled (unlimited rate), also set the whitelist-ratelimit to 0 to  disable  ratelimit
              processing.   If  you  set  verbosity  to 2 the blocked and unblocked subnets are logged.  Blocked
              queries are blocked and some receive TCP fallback replies.  Once the rate limit  is  reached,  NSD
              begins  dropping  responses. However, one in every "rrl-slip" number of responses is allowed, with
              the TC bit set. If slip is set to 2, the returned response rate will be halved. If it's set to  3,
              the  returned  response  rate will be one-third, and so on.  If you set rrl-slip to 10, traffic is
              reduced to 1/10th.  Ratelimit options  rrl-ratelimit,  rrl-size  and  rrl-whitelist-ratelimit  are
              updated when nsd-control reconfig is done (also the zone-specific ratelimit options are updated).

       <b>rrl-slip:</b> &lt;numpackets&gt;
              This  option  controls  the  number  of  packets  discarded before we send back a SLIP response (a
              response with "truncated" bit set to one). 0 disables the sending of SLIP packets, 1  means  every
              query  will  get  a SLIP response.  Default is 2, cuts traffic in half and legit users have a fair
              chance to get a +TC response.

       <b>rrl-ipv4-prefix-length:</b> &lt;subnet&gt;
              IPv4 prefix length. Addresses are grouped by netblock.  Default 24.

       <b>rrl-ipv6-prefix-length:</b> &lt;subnet&gt;
              IPv6 prefix length. Addresses are grouped by netblock.  Default 64.

       <b>rrl-whitelist-ratelimit:</b> &lt;qps&gt;
              The max qps for query sorts for a  source,  which  have  been  whitelisted.  Default  on  (with  a
              suggested  2000  qps).  With the rrl-whitelist option you can set specific queries to receive this
              qps limit instead of the normal limit.  With the value 0 the rate is unlimited.

       <b>answer-cookie:</b> &lt;yes or no&gt;
              Enable to answer to requests containing DNS Cookies as specified in RFC7873.  Default is no.

              DNS Cookies increase transaction security  and  provide  limited  protection  against  denial-off-
              service  amplification  attacks.  Server cookies will be created and included in responses. Server
              cookies are created based on the client cookie in the request, the current time, the  client's  IP
              address  and  a  secret.  When a client includes a valid server cookie in successive requests, the
              client will not be subjected to Request Rate Limiting (see <b>rrl-ratelimit</b>).

              Servers in an anycast deployment need to be able to verify each other's server cookies.  For  this
              they  need  to share the secret used to construct and verify the cookies. These cookie secrets can
              be specified in the configuration files with the <b>cookie-secret</b> and <b>cookie-staging-secret</b> options.

              If no cookie secrets are provided via configuration file, server  cookie  secrets  can  be  added,
              dropped  and activated with the <u><a href="../man8/nsd-control.8.html">nsd-control</a></u>(8) tool.  These secrets will be stored persistently in
              the cookie secret file for which the location can be specified with the <b>cookie-secret-file</b> option.

              If no cookie secrets are provided via configuration file, and there  is  no  or  an  empty  cookie
              secret file, a random cookie secret is generated.

       <b>cookie-secret:</b> &lt;128 bit hex string&gt;
              The  cookie  secret with which server cookies are created and can be verified.  If a <b>cookie-secret</b>
              is specified via configuration file, cookie secrets from the cookie secret file will be ignored.

       <b>cookie-staging-secret:</b> &lt;128 bit hex string&gt;
              A cookie secret with which server cookies can be verified,  but  will  not  be  created.  This  is
              helpful in rolling cookie secrets in anycast setups.

              A <b>cookie-staging-secret</b> can only be configured when there is also a <b>cookie-secret</b> configured.

       <b>cookie-secret-file:</b> &lt;filename&gt;
              File  from  which  the secrets are read used in DNS Cookie calculations. Secrets will only be read
              from this file if no cookie secrets are given in the configuration file via the <b>cookie-secret</b>  and
              <b>cookie-staging-secret</b> options.  Default is "/var/lib/nsd/cookiesecrets.txt"

              In  NSD  version  4.10.1  and  earlier,  the  default  location  of  the  cookie  secret  file was
              "/etc/nsd/nsd_cookiesecrets.txt". For migration purposes, cookie secrets will be  read  from  that
              location  if  no  value  is  given  for the <b>cookie-secret-file</b> option and when the current default
              location ("/var/lib/nsd/cookiesecrets.txt") does not exist.

              The  content  of  the  cookie  secret  file  must  be  manipulated  with  the   <b>add_cookie_secret</b>,
              <b>drop_cookie_secret</b>  and  <b>activate_cookie_secret</b>  commands  to the <u><a href="../man8/nsd-control.8.html">nsd-control</a></u>(8) tool.  Please see
              that manpage how to perform a safe cookie secret rollover.

       <b>tls-service-key:</b> &lt;filename&gt;
              If enabled, the server provides TLS service on TCP sockets with the TLS service port number.   The
              port number (853) is configured with tls-port.  To turn it on, create an interface: option line in
              config with @port appended to the IP-address.  This creates the extra socket on which the DNS over
              TLS service is provided.

              The  file is the private key for the TLS session. The public certificate is in the tls-service-pem
              file. Default is "", turned off. Requires a restart (a reload is not enough) if  changed,  because
              the private key is read while root permissions are held and before chroot (if any).

       <b>tls-service-pem:</b> &lt;filename&gt;
              The public key certificate pem file for the tls service. Default is "", turned off.

       <b>tls-service-ocsp:</b> &lt;filename&gt;
              The ocsp pem file for the tls service, for OCSP stapling.  Default is "", turned off.  An external
              process prepares and updates the OCSP stapling data.  Like this,

              openssl ocsp -no_nonce \
                   -respout /path/to/ocsp.pem \
                   -CAfile /path/to/ca_and_any_intermediate.pem \
                   -issuer /path/to/direct_issuer.pem \
                   -cert /path/to/cert.pem \
                   -url "$( openssl x509 -noout -ocsp_uri -in /path/to/cert.pem )"

       <b>tls-port:</b> &lt;number&gt;
              The  port  number  on which to provide TCP TLS service, default is 853, only interfaces configured
              with that port number as @number get DNS over TLS service.

       <b>tls-auth-port:</b> &lt;number&gt;
              The port number on which to provide TCP TLS service to authenticated clients only.  If you want to
              use mutual TLS authentication in Transfer over TLS (XoT) connections, this is  where  the  primary
              server  enables  a  dedicated  port for this purpose. Certificates in <b>tls-cert-bundle</b> are used for
              verifying the authenticity of a client or a secondary server.

              Client (secondary) must enable <b>tls-auth</b>, configure <b>client-cert</b> and <b>client-key</b> and enable  <b>tls-auth</b>
              in zone configuration in order to authenticate to a remote (primary) server.

       <b>tls-auth-xfr-only:</b> &lt;yes or no&gt;
              Allow  zone transfers only on the <b>tls-auth-port</b> port and only to authenticated clients. This works
              globally for all zones.  A <b>provide-xfr</b> access control list with <b>tls-auth</b> is also required to allow
              and verify a connection.  Requests for zone transfers on other ports are refused.

       <b>tls-cert-bundle:</b> &lt;filename&gt;
              If null or "", the default verify locations are used. Set it to the certificate bundle  file,  for
              example   "/etc/pki/tls/certs/ca-bundle.crt".  These  certificates  are  used  for  authenticating
              Transfer over TLS (XoT) connections.

       <b>proxy-protocol-port:</b> &lt;number&gt;
              The port number for proxy protocol service. If the statement is given multiple  times,  additional
              port  numbers can be used for proxy protocol service. The interface definitions that use this port
              number expect PROXYv2 proxy protocol traffic, for UDP, TCP and for TLS service.

       <b>metrics-enable:</b> &lt;yes or no&gt;
              Enable the prometheus metrics HTTP endpoint. It exposes the same statistics as the  <u><a href="../man8/nsd-control.8.html">nsd-control</a></u>(8)
              stats_noreset  command,  but  with  metric names following the prometheus specification. (Requires
              libevent2)

              Beware, that when using <u><a href="../man8/nsd-control.8.html">nsd-control</a></u>(8) stats (instead of stats_noreset), the  statistics  will  be
              reset for the HTTP metrics endpoint as well.

       <b>metrics-interface:</b> &lt;ip4 or ip6 | interface name&gt;
              NSD  will bind to the listed addresses or interfaces to serve the prometheus metrics. Can be given
              multiple times to bind multiple ip-addresses.  Use  0.0.0.0  and  ::0  to  bind  to  the  wildcard
              interface.

              If  an interface name is used instead of ip4 or ip6, the list of IP addresses associated with that
              interface is picked up and used at server start.

              Default is 127.0.0.1 and ::1.

       <b>metrics-port:</b> &lt;number&gt;
              The port number for the HTTP service. Default is 9100.

       <b>metrics-path:</b> &lt;string&gt;
              The HTTP path to expose the metrics at. Default is "/metrics".

   <b>Remote</b> <b>Control</b>
       The <b>remote-control:</b> clause is used to set options for using the <u><a href="../man8/nsd-control.8.html">nsd-control</a></u>(8) tool to give  commands  to
       the  running  NSD  server.  It is disabled by default, and listens for localhost by default.  It uses TLS
       over TCP where the server and client authenticate to  each  other  with  self-signed  certificates.   The
       self-signed certificates can be generated with the <u>nsd-control-setup</u> tool.  The key files are read by NSD
       before the chroot and before dropping user permissions, so they can be outside the chroot and readable by
       the superuser only.

       <b>control-enable:</b> &lt;yes or no&gt;
              Enable remote control, default is no.

       <b>control-interface:</b> &lt;ip4 or ip6 | interface name | absolute path&gt;
              NSD will bind to the listed addresses to service control requests (on TCP).  Can be given multiple
              times  to  bind multiple ip-addresses.  Use 0.0.0.0 and ::0 to service the wildcard interface.  If
              none are given NSD listens to the localhost 127.0.0.1 and ::1 interfaces for control,  if  control
              is enabled with control-enable.

              If  an interface name is used instead of ip4 or ip6, the list of IP addresses associated with that
              interface is picked up and used at server start.

              With an absolute path, a unix local named pipe is used for control.  The file is created with user
              and group that is configured and access bits are  set  to  allow  members  of  the  group  access.
              Further  access  can  be controlled by setting permissions on the directory containing the control
              socket file.  The key and cert files are not used when control is  via  the  named  pipe,  because
              access control is via file and directory permission.

       <b>control-port:</b> &lt;number&gt;
              The port number for remote control service. 8952 by default.

       <b>server-key-file:</b> &lt;filename&gt;
              Path to the server private key, by default <u>/etc/nsd/nsd_server.key</u>.  This file is generated by the
              <u>nsd-control-setup</u> utility.  This file is used by the nsd server, but not by <u>nsd-control</u>.

       <b>server-cert-file:</b> &lt;filename&gt;
              Path  to  the  server  self  signed certificate, by default <u>/etc/nsd/nsd_server.pem</u>.  This file is
              generated by the <u>nsd-control-setup</u> utility.  This file is used by the  nsd  server,  and  also  by
              <u>nsd-control</u>.

       <b>control-key-file:</b> &lt;filename&gt;
              Path  to  the  control  client  private  key,  by  default <u>/etc/nsd/nsd_control.key</u>.  This file is
              generated by the <u>nsd-control-setup</u> utility.  This file is used by <u>nsd-control</u>.

       <b>control-cert-file:</b> &lt;filename&gt;
              Path to the control client certificate, by default <u>/etc/nsd/nsd_control.pem</u>.  This certificate has
              to be signed with the server  certificate.   This  file  is  generated  by  the  <u>nsd-control-setup</u>
              utility.  This file is used by <u>nsd-control</u>.

   <b>Verifier</b> <b>options</b>
       The  <b>verify:</b>  clause  is  used  to  enable  or disable zone verification, configure listen interfaces and
       control the global defaults.

       <b>enable:</b> &lt;yes or no&gt;
              Enable zone verification. Default is no.

       <b>port:</b> &lt;number&gt;
              The port to answer verifier queries on. Default is 5347.

       <b>ip-address:</b>
              Interfaces to bind for zone verification (default are the localhost interfaces, usually  127.0.0.1
              and  ::1).  To  bind  to  multiple IP addresses, list them one by one. Optionally,  Socket options
              cannot be specified for verify ip-address

       <b>verify-zones:</b> &lt;yes or no&gt;
              Verify zones by default.

       <b>verifier:</b> &lt;command&gt;
              When an update is received for the zone (by IXFR or AXFR) this program will be run to  assess  the
              zone  with  the  update. If the program exits with a status code of 0, the zone is considered good
              and will be served. Any other status code will designate the zone bad and the received update will
              be discarded.  The zone will continue to be served but without the update.

              The following environment variables are available to verifiers:

              <b>VERIFY_ZONE</b>
              The domain name of the zone to be verified.

              <b>VERIFY_ZONE_ON_STDIN</b>
              When the zone can be read from standard input (stdin), this variable is set to "yes", otherwise it
              is set to "no".

              <b>VERIFY_IP_ADDRESSES</b>
              The first address on which the zones to be assessed will be served.  If IPv6 is available an  IPv6
              address will be preferred over IPv4.

              <b>VERIFY_PORT</b>
              The port number for <b>VERIFY_IP_ADDRESS</b>.

              <b>VERIFY_IPV6_ADDRESS</b>
              The first IPv6 address on which the zones to be assessed will be served.

              <b>VERIFY_IPV6_PORT</b>
              The port number for <b>VERIFY_IPV6_ADDRESS</b>.

              <b>VERIFY_IPV4_ADDRESS</b>
              The first IPv4 address of which the zones to be assessed will be served.

              <b>VERIFY_IPV4_PORT</b>
              The port number for <b>VERIFY_IPV4_ADDRESS</b>.

       <b>verifier-count:</b> &lt;number&gt;
              Maximum number of verifiers to run concurrently. Default is 1.

       <b>verifier-feed-zone:</b> &lt;yes or no&gt;
              Feed the updated zone to the verifier over standard input (stdin).

       <b>verifier-timeout:</b> &lt;seconds&gt;
              The maximum number of seconds a verifier is allowed to run for assessing one zone. If the verifier
              takes  longer,  it  will  be  terminated  and  the zone update will be discarded. The default is 0
              seconds which means the verifier may take as long as it needs.

   <b>Pattern</b> <b>Options</b>
       The <b>pattern:</b> clause is used to denote a set of options to apply to some zones.  The same zone options  as
       for a zone are allowed.

       <b>name:</b> &lt;string&gt;
              The  name  of  the pattern.  This is a (case sensitive) string.  The pattern names that start with
              "_implicit_" are used internally for zones that have no pattern  (they  are  defined  in  nsd.conf
              directly).

       <b>include-pattern:</b> &lt;pattern-name&gt;
              The  options  from  the  given pattern are included at this point in this pattern.  The referenced
              pattern must be defined above this one.

       <b>&lt;zone</b> <b>option&gt;:</b> &lt;value&gt;
              The zone options such as <b>zonefile</b>, <b>allow-query</b>,  <b>allow-notify</b>,  <b>request-xfr</b>,  <b>allow-axfr-fallback</b>,
              <b>notify</b>,  <b>notify-retry</b>,  <b>provide-xfr</b>,  <b>store-ixfr</b>,  <b>ixfr-number</b>, <b>ixfr-size</b>, <b>create-ixfr</b>, <b>zonestats</b>,
              <b>outgoing-interface</b>, <b>verify-zone</b>,  <b>verifier</b>,  <b>verifier-feed-zone</b>,  <b>verifier-timeout</b>,  <b>catalog</b>,  and
              <b>catalog-member-pattern</b> can be given.  They are applied to the patterns and zones that include this
              pattern.

   <b>Zone</b> <b>Options</b>
       For every zone the options need to be specified in one <b>zone:</b> clause. The access control list elements can
       be given multiple times to add multiple servers. These elements need to be added explicitly.

       For  zones  that  are configured in the <u>nsd.conf</u> config file their settings are hardcoded (in an implicit
       pattern for themselves only) and they cannot be deleted via delzone, but remove them from the config file
       and repattern.

       <b>name:</b> &lt;string&gt;
              The name of the zone. This is the domain name of the apex of the zone. May end with a '.' (in FQDN
              notation). For example "example.com", "sub.example.net.". This attribute must be present  in  each
              zone.

       <b>zonefile:</b> &lt;filename&gt;
              The  file  containing  the  zone  information. If this attribute is present it is used to read and
              write the zone contents. If the attribute is absent it prevents writing out of the zone.

              The string is processed so that one string can be used (in a  pattern)  for  a  lot  of  different
              zones.   If  the label or character does not exist the percent-character is replaced with a period
              for output (i.e. for the third character in a two letter domain name).

              <b>%s</b> is replaced with the zone name.

              <b>%1</b> is replaced with the first character of the zone name.

              <b>%2</b> is replaced with the second character of the zone name.

              <b>%3</b> is replaced with the third character of the zone name.

              <b>%z</b> is replaced with the toplevel domain name of the zone.

              <b>%y</b> is replaced with the next label under the toplevel domain.

              <b>%x</b> is replaced with the next-next label under the toplevel domain.

       <b>allow-query:</b> &lt;ip-spec&gt; &lt;key-name | NOKEY | BLOCKED&gt;
              Access control list.  When at least one  <b>allow-query</b>  option  is  specified,  then  the  specified
              addresses  in  the <b>allow-query</b> options are allowed to query the server for the zone.  Queries from
              unlisted or specifically BLOCKED addresses are discarded. If NOKEY is given no TSIG  signature  is
              required.  BLOCKED supersedes other entries, other entries are scanned for a match in the order of
              the statements.  Without <b>allow-query</b> options, queries are allowed from any IP address without TSIG
              key (which is the default).

              The  ip-spec  is  either  a  plain  IP  address  (IPv4  or  IPv6),  or can be a subnet of the form
              1.2.3.4/24, or masked like 1.2.3.4&amp;255.255.255.0 or a range of the  form  1.2.3.4-1.2.3.25.   Note
              the ip-spec ranges do not use spaces around the /, &amp;, @ and - symbols.

       <b>allow-notify:</b> &lt;ip-spec&gt; &lt;key-name | NOKEY | BLOCKED&gt;
              Access  control list. The listed (primary) address is allowed to send notifies to this (secondary)
              server via UDP or TCP. Notifies from unlisted or specifically BLOCKED addresses are discarded.  If
              NOKEY is given no TSIG signature is required.  BLOCKED supersedes other entries, other entries are
              scanned for a match in the order of the statements.

              The  ip-spec  is  either  a  plain  IP  address  (IPv4  or  IPv6),  or can be a subnet of the form
              1.2.3.4/24, or masked like 1.2.3.4&amp;255.255.255.0 or a range of the form 1.2.3.4-1.2.3.25.  A  port
              number  can  be  added  using a suffix of @number, for example 1.2.3.4@5300 or 1.2.3.4/24@5300 for
              port 5300.  Note the ip-spec ranges do not use spaces around the /, &amp;, @ and - symbols.

       <b>request-xfr:</b> [AXFR|UDP] &lt;ip-address&gt; &lt;key-name | NOKEY&gt; [tls-auth-name]
              Access control list. The listed address (the primary) is queried for AXFR/IXFR on update.  A  port
              number can be added using a suffix of @number, for example 1.2.3.4@5300. The specified key is used
              during  AXFR/IXFR.  If  tls-auth-name  is  included, the specified tls-auth clause will be used to
              perform authenticated XFR-over-TLS.

              If the AXFR option is given, the server will not be contacted with  IXFR  queries  but  only  AXFR
              requests  will  be  made to the server. This allows an NSD secondary to have a primary server that
              runs NSD. If the AXFR option is left out then both IXFR and AXFR requests are made to the  primary
              server.

              If  the  UDP option is given, the secondary will use UDP to transmit the IXFR requests. You should
              deploy TSIG when allowing UDP transport, to authenticate notifies and zone  transfers.  Otherwise,
              NSD is more vulnerable for Kaminsky-style attacks. If the UDP option is left out then IXFR will be
              transmitted using TCP.

              If  a tls-auth-name is given then TLS (by default on port 853) will be used for all zone transfers
              for the zone. If authentication of the primary, based on  the  specified  tls-auth  authentication
              information, fails the XFR request will not be sent. Support for TLS 1.3 is required for XFR-over-
              TLS.

       <b>allow-axfr-fallback:</b> &lt;yes or no&gt;
              This option should be accompanied by request-xfr. It (dis)allows NSD (as secondary) to fallback to
              AXFR if the primary name server does not support IXFR. Default is yes.

       <b>size-limit-xfr:</b> &lt;number&gt;
              This  option should be accompanied by request-xfr. It specifies XFR temporary file size limit.  It
              can be used to stop very large zone retrieval, that could otherwise use up a  lot  of  memory  and
              disk space.  If this option is 0, unlimited. Default value is 0.

       <b>notify:</b> &lt;ip-address&gt; &lt;key-name | NOKEY&gt;
              Access control list. The listed address (a secondary) is notified of updates to this zone via UDP.
              A  port number can be added using a suffix of @number, for example 1.2.3.4@5300. The specified key
              is used to sign the notify. Only on secondary configurations will  NSD  be  able  to  detect  zone
              updates (as it gets notified itself, or refreshes after a time).

       <b>notify-retry:</b> &lt;number&gt;
              This option should be accompanied by notify. It sets the number of retries when sending notifies.

       <b>provide-xfr:</b> &lt;ip-spec&gt; &lt;key-name | NOKEY | BLOCKED&gt; [tls-auth-name]
              Access  control list. The listed address (a secondary) is allowed to request XFR from this server.
              Zone data will be provided to the address. The specified key is used during XFR. For  unlisted  or
              BLOCKED  addresses  no  data  is  provided  and  requests are discarded.  BLOCKED supersedes other
              entries and other entries are scanned for a match in the order of the statements.

              The ip-spec is either a plain IP address  (IPv4  or  IPv6),  or  can  be  a  subnet  of  the  form
              1.2.3.4/24,  or masked like 1.2.3.4&amp;255.255.255.0 or a range of the form 1.2.3.4-1.2.3.25.  A port
              number can be added using a suffix of @number, for example  1.2.3.4@5300  or  1.2.3.4/24@5300  for
              port 5300. Note the ip-spec ranges do not use spaces around the /, &amp;, @ and - symbols.

              If  a  tls-auth-name  is given then TLS authentication of the secondary will be performed for zone
              transfer requests for the zone. The remote end must connect to the <b>tls-auth-port</b> and must  present
              a  certificate  with a SAN (Subject Alternative Name) DNS entry or CN (Common Name) entry equal to
              <b>auth-domain-name</b> of the defined <b>tls-auth</b>.  The certificate validify is  also  verified  with  <b>tls-</b>
              <b>cert-bundle</b>.   If  authentication of the secondary, based on the specified tls-auth authentication
              information, fails the XFR zone transfer will be refused. If the connection is  performed  on  the
              <b>tls-port</b>  then  no  authentication  will  be  performed  and the transfer will not be refused.  To
              enforce only authenticated zone transfers, <b>tls-auth-xfr-only</b> should also be enabled.  Support  for
              TLS 1.3 is required for XFR-over-TLS.

       <b>outgoing-interface:</b> &lt;ip-address&gt;
              Access  control  list. The listed address is used to request AXFR|IXFR (in case of a secondary) or
              used to send notifies (in case of a primary).

              The ip-address is a plain IP address (IPv4 or IPv6).  A port number can be added using a suffix of
              @number, for example 1.2.3.4@5300.

       <b>store-ixfr:</b> &lt;yes or no&gt;
              If enabled, IXFR contents are stored  and  provided  to  the  set  of  clients  specified  in  the
              provide-xfr statement. Default is no. IXFR content is a smaller set of changes that differ between
              zone versions, whereas an AXFR contains the full contents of the zone.

       <b>ixfr-number:</b> &lt;number&gt;
              The number of IXFR versions to store for this zone, at most. Default is 5.

       <b>ixfr-size:</b> &lt;number&gt;
              The  max storage to use for IXFR versions for this zone, in bytes.  Default is 1048576. A value of
              0 means unlimited. If you want to turn off IXFR storage, set the store-ixfr  option  to  no.   NSD
              does  not  elide  IXFR  contents  from  versions  that add and remove the same data. It stores and
              transmits IXFRs as they were transmitted by the upstream server.

       <b>create-ixfr:</b> &lt;yes or no&gt;
              If enabled, IXFR data is created when a zonefile is read by the server.  This requires  store-ixfr
              to  be  set to yes, so that the IXFR contents are saved to disk.  Default is off. If the server is
              not running, the nsd-checkzone -i option can be used to create an  IXFR  file.  When  an  IXFR  is
              created,  the  server  spools a version of the zone to a temporary file, at the location where the
              ixfr files are stored. This creates IXFR data when the zone is read from file, but not when a zone
              is read by AXFR transfer from a server, because then the topmost server that originates  the  data
              is  the  one  place where IXFR differences are computed and those differences are then transmitted
              verbatim to all the other servers.

       <b>max-refresh-time:</b> &lt;seconds&gt;
              Limit refresh time for secondary zones.  This is the timer which checks to see if the zone has  to
              be  refetched  when  it  expires.  Normally the value from the SOA record is used, but this option
              restricts that value.

       <b>min-refresh-time:</b> &lt;seconds&gt;
              Limit refresh time for secondary zones.

       <b>max-retry-time:</b> &lt;seconds&gt;
              Limit retry time for secondary zones.  This is the  timer  which  retries  after  a  failed  fetch
              attempt  for the zone.  Normally the value from the SOA record is used, followed by an exponential
              backoff, but this option restricts that value.

       <b>min-retry-time:</b> &lt;seconds&gt;
              Limit retry time for secondary zones.

       <b>min-expire-time:</b> &lt;seconds or refresh+retry+1&gt;
              Limit expire time for secondary zones.  The value can be expressed either by a number of  seconds,
              or  the  string  "refresh+retry+1".   With  the  latter the expire time will be lower bound to the
              refresh plus the retry value from the SOA record, plus 1.  The refresh and retry  values  will  be
              subject  to  the  bounds  configured  with  max-refresh-time, min-refresh-time, max-retry-time and
              min-retry-time if given.

       <b>zonestats:</b> &lt;name&gt;
              When compiled with --enable-zone-stats NSD can collect statistics per zone.  This name  gives  the
              group  where  statistics  are  added  to.   The  groups  are  output  from  nsd-control  stats and
              stats_noreset.  Default is "".  You can use "%s" to  use  the  name  of  the  zone  to  track  its
              statistics.  If not compiled in, the option can be given but is ignored.

       <b>include-pattern:</b> &lt;pattern-name&gt;
              The  options  from  the  given pattern are included at this point.  The referenced pattern must be
              defined above this zone.

       <b>rrl-whitelist:</b> &lt;rrltype&gt;
              This option causes queries of this rrltype to be whitelisted, for  this  zone.  They  receive  the
              whitelist-ratelimit. You can give multiple lines, each enables a new rrltype to be whitelisted for
              the  zone.  Default has none whitelisted. The rrltype is the query classification that the NSD RRL
              employs to make different types not interfere with one another.   The  types  are  logged  in  the
              loglines  when  a subnet is blocked (in verbosity 2).  The RRL classification types are: nxdomain,
              error, referral, any, rrsig, wildcard, nodata, dnskey, positive, all.

       <b>multi-primary-check:</b> &lt;yes or no&gt;
              Default no.  If enabled, checks all primaries for the last version.  It uses the higher version of
              all the configured primaries.  Useful if you have multiple primaries that have  different  version
              numbers served.

       <b>verify-zone:</b> &lt;yes or no&gt;
              Enable or disable verification for this zone. Default is value-zones configured in <b>verify:</b>.

       <b>verifier:</b> &lt;command&gt;
              Command to execute to assess this zone. Default is verifier configured in <b>verify:</b>.

       <b>verifier-feed-zone:</b> &lt;yes or no&gt;
              Feed  updated  zone  to  verifier over standard input. Default is verifier-feed-zone configured in
              <b>verify:</b>.

       <b>verifier-timeout:</b> &lt;seconds&gt;
              Number of seconds before verifier is forcefully terminated. Specify 0 (zero) to not use a specific
              timeout. Default is verifier-timeout from <b>verify:</b>.

       <b>catalog:</b> &lt;consumer or producer&gt;
              If set to <u>consumer</u>, catalog zone processing is enabled for the zone.  Only a single  zone  may  be
              configured  as  a  catalog  consumer zone. When more than one catalog consumer zone is configured,
              none of them will be processed.  Member zones of the catalog will use the pattern specified by the
              group property, or if a group property is  missing  or  invalid,  the  pattern  specified  by  the
              <b>catalog-member-pattern</b>  option is used. Group properties are valid if there is only a single value
              matching the name of a for member zones valid pattern.

              A zone with the option set to <u>producer</u>, can be used to produce a catalog zone.  Member  zones  for
              catalog  producer  zones can be added with "<u>nsd-control</u> <u>addzone</u> <u>&lt;zone&gt;</u> <u>&lt;pattern&gt;</u>", where &lt;pattern&gt;
              has a <b>catalog-producer-zone</b> option pointing to a catalog producer zone.  Members will get a  group
              property with the pattern name as value.  Catalog producer zones must be primary zones and may not
              have  a <b>request-xfr</b> option. Catalog producer zones will <u>not</u> read content from zone files, but will
              reconstruct the zone on startup from the member zone entries in /var/lib/nsd/zone.list,  specified
              with the <b>zonelistfile</b> option.

              The  status  of  both  catalog  consumer  and  producer  zones  can  be  verified with <u>nsd-control</u>
              <u>zonestatus</u>. It will show the number of member zones and, if  the  catalog  zone  is  invalid,  the
              reason  for  it  to  be  invalid  is  shown.  <u>nsd-control</u> <u>zonestatus</u> will also show the entry of a
              catalog member zone in the catalog (consumer or producer) zone as <b>catalog-member-id:</b>.

              A catalog zone can either be catalog consumer zone or  a  catalog  producer  zone  but  not  both.
              Likewise,  catalog  member  zones  can  be  either  a member of catalog consumer zone or a catalog
              producer zone but not both.

              Catalog zones contain a list of zones that are served.  Use  <b>allow-query:</b>  <b>0.0.0.0/0</b>  <b>BLOCKED</b>  and
              <b>allow-query:</b>  <b>::0/0</b>  <b>BLOCKED</b>  in  a  catalog  zone zone or pattern clause to prevent revealing the
              catalog.  Also  consider  using  transfers  over  TLS  to  further  protect  the  catalog  against
              eavesdroppers.

       <b>catalog-member-pattern:</b> &lt;pattern-name&gt;
              If  this  option  is  provided  for  a  catalog consumer zone, members of that catalog that have a
              missing or an invalid group property will be added using pattern &lt;pattern-name&gt;.

       <b>catalog-producer-zone:</b> &lt;zone-name&gt;
              This option can only be used in a  pattern.  Adding  a  zone  using  "<u>nsd-control</u>  <u>addzone</u>  <u>&lt;zone&gt;</u>
              <u>&lt;pattern&gt;</u>"  with  a  &lt;pattern&gt;  containing  this  option,  will cause a catalog member entry to be
              created in the catalog producer zone &lt;zone-name&gt;.  &lt;zone-name&gt; must exist  and  must  be  a  valid
              catalog producer zone.

   <b>Key</b> <b>Declarations</b>
       The <b>key:</b> clause establishes a key for use in access control lists. It has the following attributes.

       <b>name:</b> &lt;string&gt;
              The  key  name.  Used  to  refer  to  this key in the access control list.  The key name has to be
              correct for tsig to work.  This is because the key name is output on the wire.

       <b>algorithm:</b> &lt;string&gt;
              Authentication algorithm for this key.  Such as  hmac-md5,  hmac-sha1,  hmac-sha224,  hmac-sha256,
              hmac-sha384  and  hmac-sha512.   Can  also be abbreviated as 'sha1', 'sha256'.  Default is sha256.
              Algorithms are only available when they were compiled in (available in the crypto library).

       <b>secret:</b> &lt;base64 blob&gt;
              The base64 encoded shared secret. It is possible to put the <b>secret:</b> declaration (and base64  blob)
              into  a different file, and then to <b>include:</b> that file. In this way the key secret and the rest of
              the configuration file, which may have different security  policies,  can  be  split  apart.   The
              content  of  the secret is the agreed base64 secret content.  To make it up, enter a password (its
              length must be a multiple of 4 characters, A-Za-z0-9), or use dev-random output through  a  base64
              encode filter.

   <b>TLS</b> <b>Auth</b> <b>Declarations</b>
       The <b>tls-auth:</b> clause establishes attributes to use when authenticating the far end of a TLS connection as
       well  as to define credentials to authenticate to a remote server. It is used in access control lists for
       XFR-over-TLS. It has the following attributes.

       <b>name:</b> &lt;string&gt;
              The tls-auth name. Used to refer to this TLS authentication  information  in  the  access  control
              list.

       <b>auth-domain-name:</b> &lt;string&gt;
              The authentication domain name as defined in RFC8310. Used to verify the certificate of the remote
              connecting  server.  When  used by a primary server in <b>provide-xfr</b> it verifies the secondary. When
              used by a secondary server in <b>request-xfr</b> it verifies the primary.

       <b>client-cert:</b> <b>&lt;file</b> <b>name</b> <b>of</b> <b>clientcert.pem&gt;</b>
              If you want to use mutual TLS authentication,  this  is  where  the  client  certificates  can  be
              configured that NSD uses to connect to the upstream server to download the zone. The client public
              key pem cert file can be configured here. Also configure a private key with client-key.

       <b>client-key:</b> <b>&lt;file</b> <b>name</b> <b>of</b> <b>clientkey.key&gt;</b>
              If  you want to use mutual TLS authentication, the private key file can be configured here for the
              client authentication.

       <b>client-key-pw:</b> <b>&lt;string&gt;</b>
              If the client-key file uses a password to decrypt the key before it can be used, then the password
              can be specified here as a string.  It is possible to include other config files with the include:
              option, and this can be used to move that sensitive data to another file, if you wish.

   <b>DNSTAP</b> <b>Logging</b> <b>Options</b>
       DNSTAP support, when compiled in, is enabled in the <b>dnstap:</b> section.  This  starts  a  collector  process
       that writes the log information to the destination.

       <b>dnstap-enable:</b> &lt;yes or no&gt;
              If  dnstap  is  enabled.   Default no.  If yes, it connects to the dnstap server and if any of the
              dnstap-log-..-messages options is enabled it sends logs for those messages to the server.

       <b>dnstap-socket-path:</b> &lt;file name&gt;
              Sets the unix socket file name for connecting to the server that  is  listening  on  that  socket.
              Default is "/var/run/nsd-dnstap.sock".

       <b>dnstap-ip:</b> &lt;"" or addr[@port]&gt;
              If  disabled  with  "",  the socket path is used. With a value, like address or address@port, like
              "127.0.0.1@3333" TCP or TLS is used. Default is "".

       <b>dnstap-tls:</b> &lt;yes or no&gt;
              If enabled, TLS is used to the address specified in <b>dnstap-ip</b>. Otherwise, TCP is used. Default  is
              yes.

       <b>dnstap-tls-server-name:</b> &lt;string&gt;
              The name for authenticating the upstream server. With "" disabled.

       <b>dnstap-tls-client-key-file:</b> &lt;file name&gt;
              The key file for client authentication, or "" disabled.

       <b>dnstap-tls-client-cert-file:</b> &lt;file name&gt;
              The cert file for client authentication, or "" disabled.

       <b>dnstap-send-identity:</b> &lt;yes or no&gt;
              If enabled, the server identity is included in the log messages.  Default is no.

       <b>dnstap-send-version:</b> &lt;yes or no&gt;
              If enabled, the server version if included in the log messages.  Default is no.

       <b>dnstap-identity:</b> &lt;string&gt;
              The identity to send with messages, if "" the hostname is used.  Default is "".

       <b>dnstap-version:</b> &lt;string&gt;
              The version to send with messages, if "" the package version is used.  Default is "".

       <b>dnstap-log-auth-query-messages:</b> &lt;yes or no&gt;
              Enable to log auth query messages.  Default is no.  These are client queries to NSD.

       <b>dnstap-log-auth-response-messages:</b> &lt;yes or no&gt;
              Enable to log auth response messages.  Default is no.  These are responses from NSD to clients.

</pre><h4><b>NSD</b> <b>CONFIGURATION</b> <b>FOR</b> <b>BIND9</b> <b>HACKERS</b></h4><pre>
       BIND9  is a name server implementation with its own configuration file format, <a href="../man5/named.conf.5.html">named.conf</a>(5). BIND9 types
       zones as 'Primary' or 'Secondary'.

   <b>Secondary</b> <b>zones</b>
       For a secondary zone, the primary servers are listed. The primary servers are queried for zone data,  and
       are  listened to for update notifications.  In NSD these two properties need to be configured separately,
       by listing the primary address in allow-notify and request-xfr statements.

       In BIND9 you only need to provide allow-notify elements for any extra sources of notifications (i.e.  the
       operators),  NSD  needs  to  have  allow-notify for both primaries and operators. BIND9 allows additional
       transfer sources, in NSD you list those as request-xfr.

       Here is an example of a secondary zone in BIND9 syntax.

       # Config file for example.org
       options {
            dnssec-enable yes;
       };

       key tsig.example.org. {
            algorithm hmac-md5;
            secret "aaaaaabbbbbbccccccdddddd";
       };

       server 162.0.4.49 {
            keys { tsig.example.org. ; };
       };

       zone "example.org" {
            type secondary;
            file "secondary/example.org.signed";
            primaries { 162.0.4.49; };
       };
       For NSD, DNSSEC is enabled automatically for zones that are signed. The dnssec-enable  statement  in  the
       options  clause  is  not needed. In NSD keys are associated with an IP address in the access control list
       statement, therefore the server{} statement is not needed. Below is the same example  in  an  NSD  config
       file.

       # Config file for example.org
       key:
            name: tsig.example.org.
            algorithm: hmac-md5
            secret: "aaaaaabbbbbbccccccdddddd"

       zone:
            name: "example.org"
            zonefile: "secondary/example.org.signed"
            # the primary is allowed to notify and will provide zone data.
            allow-notify: 162.0.4.49 NOKEY
            request-xfr: 162.0.4.49 tsig.example.org.

       Notice  that  the primary is listed twice, once to allow it to send notifies to this secondary server and
       once to tell the secondary server where to look for updates zone data. More allow-notify and  request-xfr
       lines can be added to specify more primaries.

       It  is  possible  to  specify  extra  allow-notify  lines  for  addresses  that  are also allowed to send
       notifications to this secondary server.

   <b>Primary</b> <b>zones</b>
       For a primary zone in BIND9,  the  secondary  servers  are  listed.  These  secondary  servers  are  sent
       notifications  of  updated  and  are  allowed  to  request  transfer  of  the zone data. In NSD these two
       properties need to be configured separately.

       Here is an example of a primary zone in BIND9 syntax.

       zone "example.nl" {
            type primary;
            file "example.nl";
       };

       In NSD syntax this becomes:

       zone:
            name: "example.nl"
            zonefile: "example.nl"
            # allow anybody to request xfr.
            provide-xfr: 0.0.0.0/0 NOKEY
            provide-xfr: ::0/0 NOKEY

       # to list a secondary server you would in general give
       # provide-xfr: 1.2.3.4 tsig-key.name.
       # notify: 1.2.3.4 NOKEY

   <b>Other</b>
       NSD is an authoritative only DNS server. This means that it is meant as a primary or secondary server for
       zones, providing DNS data to DNS resolvers and caches. BIND9 can function as an authoritative DNS server,
       the configuration options for that are compared with those for NSD in this section.  However,  BIND9  can
       also  function  as  a  resolver  or  cache.  The configuration options that BIND9 has for the resolver or
       caching thus have no equivalents for NSD.

</pre><h4><b>FILES</b></h4><pre>
       /etc/nsd/nsd.conf
              default <b>NSD</b> configuration file

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/nsd.8.html">nsd</a></u>(8), <u><a href="../man8/nsd-checkconf.8.html">nsd-checkconf</a></u>(8), <u><a href="../man8/nsd-checkzone.8.html">nsd-checkzone</a></u>(8), <u><a href="../man8/nsd-control.8.html">nsd-control</a></u>(8)

</pre><h4><b>AUTHORS</b></h4><pre>
       <b>NSD</b> was written by a combined team from NLnet Labs and RIPE NCC. Please  see  the  CREDITS  file  in  the
       distribution for further details.

</pre><h4><b>BUGS</b></h4><pre>
       <b>nsd.conf</b> is parsed by a primitive parser. Error messages may not be to the point.

NLnet Labs                                        Apr 24, 2025                                       <u><a href="../man5/nsd.conf.5.html">nsd.conf</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>