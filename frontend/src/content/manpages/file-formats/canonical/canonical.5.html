<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>canonical - Postfix canonical table format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/postfix">postfix_3.10.2-1ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       canonical - Postfix canonical table format

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>postmap</b> <b>/etc/postfix/canonical</b>

       <b>postmap</b> <b>-q</b> <b>"</b><u>string</u><b>"</b> <b>/etc/postfix/canonical</b>

       <b>postmap</b> <b>-q</b> <b>-</b> <b>/etc/postfix/canonical</b> <b>&lt;</b><u>inputfile</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  optional  <b><a href="../man5/canonical.5.html">canonical</a></b>(5)  table  specifies  an  address mapping for local and non-local addresses. The
       mapping is used by the <b><a href="../man8/cleanup.8.html">cleanup</a></b>(8) daemon, before mail is stored into the queue.  The address  mapping  is
       recursive.

       Normally,  the  <b><a href="../man5/canonical.5.html">canonical</a></b>(5)  table  is  specified  as a text file that serves as input to the <b><a href="../man1/postmap.1.html">postmap</a></b>(1)
       command.  The result, an indexed file in <b>dbm</b> or <b>db</b> format, is used for fast searching by the mail system.
       Execute the command "<b>postmap</b> <b>/etc/postfix/canonical</b>" to  rebuild  an  indexed  file  after  changing  the
       corresponding text file.

       When  the  table  is  provided via other means such as NIS, LDAP or SQL, the same lookups are done as for
       ordinary indexed files.

       Alternatively, the table can be provided as a regular-expression map where patterns are given as  regular
       expressions,  or lookups can be directed to a TCP-based server. In those cases, the lookups are done in a
       slightly different way as described below under "REGULAR EXPRESSION TABLES" or "TCP-BASED TABLES".

       By default the <b><a href="../man5/canonical.5.html">canonical</a></b>(5) mapping affects both message header addresses  (i.e.  addresses  that  appear
       inside  messages)  and  message  envelope  addresses  (for  example,  the addresses that are used in SMTP
       protocol commands). This is controlled with the <b>canonical_classes</b> parameter.

       NOTE: Postfix versions 2.2 and later rewrite message headers from remote SMTP clients only if the  client
       matches  the local_header_rewrite_clients parameter, or if the remote_header_rewrite_domain configuration
       parameter  specifies  a  non-empty  value.  To   get   the   behavior   before   Postfix   2.2,   specify
       "local_header_rewrite_clients = static:all".

       Typically, one would use the <b><a href="../man5/canonical.5.html">canonical</a></b>(5) table to replace login names by <u>Firstname.Lastname</u>, or to clean
       up addresses produced by legacy mail systems.

       The  <b><a href="../man5/canonical.5.html">canonical</a></b>(5)  mapping  is  not  to be confused with <u>virtual</u> <u>alias</u> support or with local aliasing. To
       change the destination but not the headers, use the <b><a href="../man5/virtual.5.html">virtual</a></b>(5) or <b><a href="../man5/aliases.5.html">aliases</a></b>(5) map instead.

</pre><h4><b>CASE</b> <b>FOLDING</b></h4><pre>
       The search string is folded to lowercase before database lookup. As of Postfix 2.3, the search string  is
       not case folded with database types such as regexp: or pcre: whose lookup fields can match both upper and
       lower case.

</pre><h4><b>TABLE</b> <b>FORMAT</b></h4><pre>
       The input format for the <b><a href="../man1/postmap.1.html">postmap</a></b>(1) command is as follows:

       <u>pattern</u> <u>address</u>
              When <u>pattern</u> matches a mail address, replace it by the corresponding <u>address</u>.

       blank lines and comments
              Empty  lines  and  whitespace-only  lines  are  ignored,  as  are lines whose first non-whitespace
              character is a `#'.

       multi-line text
              A logical line starts with non-whitespace text. A line that starts  with  whitespace  continues  a
              logical line.

</pre><h4><b>TABLE</b> <b>SEARCH</b> <b>ORDER</b></h4><pre>
       With  lookups  from  indexed  files such as DB or DBM, or from networked tables such as NIS, LDAP or SQL,
       each <u>user</u>@<u>domain</u> query produces a sequence of query patterns as described below.

       Each query pattern is sent to each specified lookup table before trying the next query pattern,  until  a
       match is found.

       <u>user</u>@<u>domain</u> <u>address</u>
              Replace <u>user</u>@<u>domain</u> by <u>address</u>. This form has the highest precedence.

              This  is  useful  to  clean  up addresses produced by legacy mail systems.  It can also be used to
              produce <u>Firstname.Lastname</u> style addresses, but see below for a simpler solution.

       <u>user</u> <u>address</u>
              Replace  <u>user</u>@<u>site</u>  by  <u>address</u>  when  <u>site</u>  is  equal  to  $<b>myorigin</b>,  when  <u>site</u>  is  listed  in
              $<b>mydestination</b>, or when it is listed in $<b>inet_interfaces</b> or $<b>proxy_interfaces</b>.

              This form is useful for replacing login names by <u>Firstname.Lastname</u>.

       @<u>domain</u> <u>address</u>
              Replace other addresses in <u>domain</u> by <u>address</u>.  This form has the lowest precedence.

              Note:  @<u>domain</u>  is a wild-card. When this form is applied to recipient addresses, the Postfix SMTP
              server accepts mail for any recipient in <u>domain</u>, regardless  of  whether  that  recipient  exists.
              This  may  turn  your  mail  system  into  a  backscatter  source:  Postfix first accepts mail for
              non-existent recipients and then tries to return that mail as "undeliverable" to the often  forged
              sender address.

              To avoid backscatter with mail for a wild-card domain, replace the wild-card mapping with explicit
              1:1 mappings, or add a reject_unverified_recipient restriction for that domain:

                  smtpd_recipient_restrictions =
                      ...
                      reject_unauth_destination
                      check_recipient_access
                          inline:{example.com=reject_unverified_recipient}
                  unverified_recipient_reject_code = 550

              In  the  above  example,  Postfix  may  contact a remote server if the recipient is rewritten to a
              remote address.

</pre><h4><b>RESULT</b> <b>ADDRESS</b> <b>REWRITING</b></h4><pre>
       The lookup result is subject to address rewriting:

       •      When the result has the form @<u>otherdomain</u>, the result becomes the same <u>user</u> in <u>otherdomain</u>.

       •      When "<b>append_at_myorigin=yes</b>", append "<b>@$myorigin</b>" to addresses without "@domain".

       •      When "<b>append_dot_mydomain=yes</b>", append "<b>.$mydomain</b>" to addresses without ".domain".

</pre><h4><b>ADDRESS</b> <b>EXTENSION</b></h4><pre>
       When a mail address localpart contains the optional  recipient  delimiter  (e.g.,  <u>user+foo</u>@<u>domain</u>),  the
       lookup order becomes: <u>user+foo</u>@<u>domain</u>, <u>user</u>@<u>domain</u>, <u>user+foo</u>, <u>user</u>, and @<u>domain</u>.

       The  <b>propagate_unmatched_extensions</b>  parameter  controls whether an unmatched address extension (<u>+foo</u>) is
       propagated to the result of table lookup.

</pre><h4><b>REGULAR</b> <b>EXPRESSION</b> <b>TABLES</b></h4><pre>
       This section describes how the table lookups change when the table  is  given  in  the  form  of  regular
       expressions.  For  a  description  of  regular  expression  lookup  table  syntax, see <b><a href="../man5/regexp_table.5.html">regexp_table</a></b>(5) or
       <b><a href="../man5/pcre_table.5.html">pcre_table</a></b>(5).

       Each pattern is a regular expression that is applied  to  the  entire  address  being  looked  up.  Thus,
       <u>user@domain</u>  mail  addresses  are  not  broken  up  into their <u>user</u> and <u>@domain</u> constituent parts, nor is
       <u>user+foo</u> broken up into <u>user</u> and <u>foo</u>.

       Patterns are applied in the order as specified in the table, until a pattern is found  that  matches  the
       search string.

       Results  are  the  same  as  with  indexed  file  lookups, with the additional feature that parenthesized
       substrings from the pattern can be interpolated as <b>$1</b>, <b>$2</b> and so on.

</pre><h4><b>TCP-BASED</b> <b>TABLES</b></h4><pre>
       This section describes how the table lookups change when lookups are directed to a TCP-based server.  For
       a  description of the TCP client/server lookup protocol, see <b><a href="../man5/tcp_table.5.html">tcp_table</a></b>(5).  This feature is not available
       up to and including Postfix version 2.4.

       Each lookup operation uses the entire address once.  Thus, <u>user@domain</u> mail addresses are not  broken  up
       into their <u>user</u> and <u>@domain</u> constituent parts, nor is <u>user+foo</u> broken up into <u>user</u> and <u>foo</u>.

       Results are the same as with indexed file lookups.

</pre><h4><b>BUGS</b></h4><pre>
       The table format does not understand quoting conventions.

</pre><h4><b>CONFIGURATION</b> <b>PARAMETERS</b></h4><pre>
       The  following  <b>main.cf</b>  parameters  are  especially  relevant.  The text below provides only a parameter
       summary. See <b><a href="../man5/postconf.5.html">postconf</a></b>(5) for more details including examples.

       <b>canonical_classes</b> <b>(envelope_sender,</b> <b>envelope_recipient,</b> <b>header_sender,</b> <b>header_recipient)</b>
              What addresses are subject to canonical_maps address mapping.

       <b>canonical_maps</b> <b>(empty)</b>
              Optional address mapping lookup tables for message headers and envelopes.

       <b>recipient_canonical_maps</b> <b>(empty)</b>
              Optional address mapping lookup tables for envelope and header recipient addresses.

       <b>sender_canonical_maps</b> <b>(empty)</b>
              Optional address mapping lookup tables for envelope and header sender addresses.

       <b>propagate_unmatched_extensions</b> <b>(canonical,</b> <b>virtual)</b>
              What address lookup tables copy an address extension from the lookup key to the lookup result.

       Other parameters of interest:

       <b>inet_interfaces</b> <b>(all)</b>
              The local network interface addresses that this mail system receives mail on.

       <b>local_header_rewrite_clients</b> <b>(permit_inet_interfaces)</b>
              Rewrite or add message headers in mail from these clients, updating incomplete addresses with  the
              domain name in $myorigin or $mydomain, and adding missing headers.

       <b>proxy_interfaces</b> <b>(empty)</b>
              The remote network interface addresses that this mail system receives mail on by way of a proxy or
              network address translation unit.

       <b>masquerade_classes</b> <b>(envelope_sender,</b> <b>header_sender,</b> <b>header_recipient)</b>
              What addresses are subject to address masquerading.

       <b>masquerade_domains</b> <b>(empty)</b>
              Optional list of domains whose subdomain structure will be stripped off in email addresses.

       <b>masquerade_exceptions</b> <b>(empty)</b>
              Optional  list  of  user  names  that  are  not subjected to address masquerading, even when their
              addresses match $masquerade_domains.

       <b>mydestination</b> <b>($myhostname,</b> <b>localhost.$mydomain,</b> <b>localhost)</b>
              The list of domains that are delivered via the $local_transport mail delivery transport.

       <b>myorigin</b> <b>($myhostname)</b>
              The domain name that locally-posted mail appears to come from, and that  locally  posted  mail  is
              delivered to.

       <b>owner_request_special</b> <b>(yes)</b>
              Enable  special  treatment  for  owner-<u>listname</u>  entries  in  the <b><a href="../man5/aliases.5.html">aliases</a></b>(5) file, and don't split
              owner-<u>listname</u> and <u>listname</u>-request address localparts when the recipient_delimiter is set to "-".

       <b>remote_header_rewrite_domain</b> <b>(empty)</b>
              Rewrite or add message headers in mail from remote  clients  if  the  remote_header_rewrite_domain
              parameter  value  is  non-empty,  updating  incomplete  addresses with the domain specified in the
              remote_header_rewrite_domain parameter, and adding missing headers.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man8/cleanup.8.html">cleanup</a>(8), canonicalize and enqueue mail
       <a href="../man1/postmap.1.html">postmap</a>(1), Postfix lookup table manager
       <a href="../man5/postconf.5.html">postconf</a>(5), configuration parameters
       <a href="../man5/virtual.5.html">virtual</a>(5), virtual aliasing

</pre><h4><b>README</b> <b>FILES</b></h4><pre>
       Use "<b>postconf</b> <b>readme_directory</b>" or "<b>postconf</b> <b>html_directory</b>" to locate this information.
       DATABASE_README, Postfix lookup table overview
       ADDRESS_REWRITING_README, address rewriting guide

</pre><h4><b>LICENSE</b></h4><pre>
       The Secure Mailer license must be distributed with this software.

</pre><h4><b>AUTHOR(S)</b></h4><pre>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

       Wietse Venema
       Google, Inc.
       111 8th Avenue
       New York, NY 10011, USA

                                                                                                    <u><a href="../man5/CANONICAL.5.html">CANONICAL</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>