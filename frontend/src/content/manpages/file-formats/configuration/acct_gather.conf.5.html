<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>acct_gather.conf - Slurm configuration file for the acct_gather plugins</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/slurm-client">slurm-client_24.11.5-4_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       <b>acct_gather.conf</b> - Slurm configuration file for the acct_gather plugins

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>acct_gather.conf</b>  is  a  UTF8 formatted file which defines parameters used by Slurm's acct_gather related
       plugins.  The file will always be located in the same directory as the <b>slurm.conf</b>.

       Parameter names are case insensitive but parameter values are case sensitive.  Any text following  a  "#"
       in the configuration file is treated as a comment through the end of that line.  The size of each line in
       the file is limited to 1024 characters.

       Changes to the configuration file take effect upon restart of the Slurm daemons.

       The  following <b>acct_gather.conf</b> parameters are defined to control the general behavior of various plugins
       in Slurm.

       The <b>acct_gather.conf</b> file is different than other Slurm .conf files. Each plugin  defines  which  options
       are  available.  Each  plugin  to  be  loaded  must  be  specified  in the <b>slurm.conf</b> under the following
       configuration entries:

       • AcctGatherEnergyType (plugin type=<u>acct_gather_energy</u>)
       • AcctGatherInterconnectType (plugin type=<u>acct_gather_interconnect</u>)
       • AcctGatherFilesystemType (plugin type=<u>acct_gather_filesystem</u>)
       • AcctGatherProfileType (plugin type=<u>acct_gather_profile</u>)

       If the respective plugin for an option is not loaded then that option will be unknown to  Slurm,  causing
       the  daemon  to  fatal  on initialization.  If you decide to change plugin types in <b>slurm.conf</b>, also make
       sure to change the related options in <b>acct_gather.conf</b>.

</pre><h4><b>acct_gather_energy/gpu</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherEnergyType=acct_gather_energy/gpu
       This plugin doesn't read any options from <b>acct_gather.conf</b>.
       Dataset provided by the plugin is: Energy.

</pre><h4><b>acct_gather_energy/IPMI</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherEnergyType=acct_gather_energy/ipmi

       Options used for acct_gather_energy/ipmi are as follows:

              <b>EnergyIPMIFrequency</b>=&lt;number&gt;
                        This parameter is the number of seconds between BMC access samples.  Ideally  it  should
                        be  higher  or  equal to <b>JobAcctGatherFrequency</b>, otherwise the JobAcctGather plugin will
                        get repeated values in successive polls.

              <b>EnergyIPMICalcAdjustment</b>=&lt;yes|no&gt;
                        If set to "yes", the  consumption  between  the  last  BMC  access  sample  and  a  step
                        consumption  update  is  approximated  to  get  more  accurate  task  consumption.   The
                        adjustment is made at the step start and each time the consumption is updated, including
                        the step  end.  The  approximations  are  not  accumulated,  only  the  first  and  last
                        adjustments are used to calculated the consumption. The default is "no".

              <b>EnergyIPMIPowerSensors</b>=&lt;key=values&gt;
                        Optionally  specify  the  ids  of the sensors to used.  Multiple &lt;key=values&gt; can be set
                        with ";" separators.  The key "Node" is mandatory and  is  used  to  know  the  consumed
                        energy for nodes (scontrol show node) and jobs (sacct).  Other keys are optional and are
                        named by administrator.  These keys are useful only when profile is activated for energy
                        to  store  power  (in  watt) of each key.  &lt;values&gt; are integers except when using DCMI.
                        Multiple values can be set with "," separators. The sum of the listed  sensors  is  used
                        for each key.  EnergyIPMIPowerSensors is optional, default value is "Node=&lt;value&gt;" where
                        "&lt;value&gt;" is the id of the first power sensor returned by ipmi-sensors.
                        i.e.
                        EnergyIPMIPowerSensors=Node=16,19,23,26;Socket0=16,23;Socket1=19,26;SSUP=23,26;KNC=16,19
                        EnergyIPMIPowerSensors=Node=29,32;SSUP0=29;SSUP1=32
                        EnergyIPMIPowerSensors=Node=1280

                        Data  Center  Manageability Interface - acct_gather_energy/ipmi supports gathering power
                        data through DCMI IPMI extension commands. When configured, the ipmi plugin  will  query
                        the  DCMI  using  the "System Power mode" or the "Enhanced System Power Statistics mode"
                        flags depending on the configuration.

                        To configure one or the other, the special sensor values DCMI or  DCMI_ENHANCED  can  be
                        used, for example:
                        EnergyIPMIPowerSensors=Node=DCMI
                        EnergyIPMIPowerSensors=Node=DCMI_ENHANCED

              The  following  <b>acct_gather.conf</b>  parameters are defined to control the IPMI config default values
              for libipmiconsole.

              <b>EnergyIPMIUsername</b>=<u>USERNAME</u>
                        Specify BMC Username.

              <b>EnergyIPMIPassword</b>=<u>PASSWORD</u>
                        Specify BMC Password.
       Datasets provided by the plugin have name: &lt;IPMI_SENSOR_LABEL&gt;Power.

   <b>NOTES:</b>
       This plugin requires the freeipmi development files to be installed and linkable at configure  time.  The
       plugin  will not build otherwise. When building the RPM, <u>rpmbuild</u> <u>...</u> <u>--with</u> <u>freeipmi</u> can be specified to
       explicitly check for these dependencies.

</pre><h4><b>acct_gather_energy/rapl</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherEnergyType=acct_gather_energy/rapl
       This plugin doesn't read any options from <b>acct_gather.conf</b>.
       Dataset provided by the plugin is: Power.

</pre><h4><b>acct_gather_energy/XCC</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherEnergyType=acct_gather_energy/xcc

       Options used for acct_gather_energy/xcc include only in-band  communications  with  XClarity  Controller,
       thus a reduced set of configurations is supported:

              <b>EnergyIPMIFrequency</b>=&lt;number&gt;
                        This  parameter  is  the  number  of  seconds between XCC access samples.  Default is 30
                        seconds.

              <b>EnergyIPMITimeout</b>=&lt;number&gt;
                        Timeout, in seconds, for initializing the IPMI XCC context for a new  gathering  thread.
                        Default is 10 seconds.
       Datasets provided by the plugin are: Energy, CurrPower.

</pre><h4><b>acct_gather_filesystem/lustre</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherFilesystemType=acct_gather_filesystem/lustre
       This plugin doesn't read any options from <b>acct_gather.conf</b>.
       Datasets provided by the plugin are: Reads, ReadMB, Writes, WriteMB.

</pre><h4><b>acct_gather_profile/HDF5</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherProfileType=acct_gather_profile/hdf5

       Options used for acct_gather_profile/hdf5 are as follows:

              <b>ProfileHDF5Dir</b>=&lt;path&gt;
                     This  parameter  is the path to the shared folder into which the acct_gather_profile plugin
                     will write detailed data (usually as an HDF5 file).  The directory is assumed to  be  on  a
                     file system shared by the controller and all compute nodes. This is a required parameter.

              <b>ProfileHDF5Default</b>
                     A  comma-delimited  list  of  data  types to be collected for each job submission.  Allowed
                     values are:

                     <b>All</b>     All data types are collected. (Cannot be combined with other values.)

                     <b>None</b>    No data types are collected. This is the default.  (Cannot be combined  with  other
                             values.)

                     <b>Energy</b>  Energy data is collected.

                     <b>Filesystem</b>
                             File system (Lustre) data is collected.

                     <b>Network</b> Network (InfiniBand) data is collected.

                     <b>Task</b>    Task (I/O, Memory, ...) data is collected.

</pre><h4><b>acct_gather_profile/InfluxDB</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherProfileType=acct_gather_profile/influxdb

       The InfluxDB plugin provides the same information as the HDF5 plugin but will instead send information to
       the configured InfluxDB server.

       The InfluxDB plugin is designed against 1.x protocol of InfluxDB. Any site running a v2.x InfluxDB server
       will  need  to  configure  a  v1.x  compatibility  endpoint  along  with  the  correct  user and password
       authorization. Token authentication is not currently supported.

   <b>Options:</b>
       <b>ProfileInfluxDBDatabase</b>
              InfluxDB v1.x database name where profiling information is to be written.   InfluxDB  v2.x  bucket
              name where profiling information is to be written.

       <b>ProfileInfluxDBDefault</b>
              A comma-delimited list of data types to be collected for each job submission.  Allowed values are:

              <b>All</b>       All data types are collected. Cannot be combined with other values.

              <b>None</b>      No data types are collected. This is the default.  Cannot be combined with other values.

              <b>Energy</b>    Energy data is collected.

              <b>Filesystem</b>
                        File system (Lustre) data is collected.

              <b>Network</b>   Network (InfiniBand) data is collected.

              <b>Task</b>      Task (I/O, Memory, ...) data is collected.

       <b>ProfileInfluxDBHost</b>=&lt;hostname&gt;:&lt;port&gt;
              The  hostname of the machine where the <u>InfluxDB</u> instance is executed and the port used by the HTTP
              API. The port used by the HTTP API is the one configured through  the  bind-address  influxdb.conf
              option in the [http] section.  Example:
              ProfileInfluxDBHost=myinfluxhost:8086

       <b>ProfileInfluxDBPass</b>
              Password  for  username  configured  in ProfileInfluxDBUser. Required in v2.x and optional in v1.x
              InfluxDB.

       <b>ProfileInfluxDBRTPolicy</b>
              The InfluxDB v1.x retention policy name for the  database  configured  in  ProfileInfluxDBDatabase
              option.   The  InfluxDB  v2.x  retention  policy  bucket  name  for  the  database  configured  in
              ProfileInfluxDBDatabase option.

       <b>ProfileInfluxDBUser</b>
              InfluxDB  username  that  should  be  used  to  gain  access  to  the   database   configured   in
              ProfileInfluxDBDatabase.  Required  in v2.x and optional in v1.x InfluxDB.  This is only needed if
              InfluxDB v1.x is configured with authentication enabled in the [http] config section  and  a  user
              has been granted at least WRITE access to the database. See also <b>ProfileInfluxDBPass</b>.

       <b>ProfileInfluxDBTimeout</b>=&lt;seconds&gt;
              The  maximum  time  in  seconds  that  an  HTTP query to the InfluxDB server can take.  After this
              timeout the data is discarded. Be aware that a long timeout can drain your nodes if  the  InfluxDB
              server  is  unresponsive  and,  when  terminating  the  job,  the  last  dataset  takes  more than
              UnkillableStepTimeout to be sent. Internally, that option  sets  CURLOPT_TIMEOUT  library  option.
              Default is 10 seconds.

   <b>NOTES:</b>
       This  plugin  requires  the libcurl development files to be installed and linkable at configure time. The
       plugin will not build otherwise.

       Information on how to install and configure InfluxDB and manage databases, retention policies and such is
       available on the official webpage.

       Collected information is written from every compute node where  a  job  runs  to  the  <u>InfluxDB</u>  instance
       listening  on  the ProfileInfluxDBHost. In order to avoid overloading the <u>InfluxDB</u> instance with incoming
       connection requests, the plugin uses an internal buffer which is filled with samples. Once the buffer  is
       full, a HTTP API write request is performed and the buffer is emptied to hold subsequent samples. A final
       request is also performed when a task ends even if the buffer isn't full.

       Failed  HTTP  API write requests are silently discarded. This means that collected profile information in
       the plugin buffer is lost if it can't be written to the <u>InfluxDB</u> database for any reason.

       Plugin messages are logged along with the slurmstepd logs to SlurmdLogFile. In order to troubleshoot  any
       issues, it is recommended to temporarily increase the slurmd debug level to debug3 and add Profile to the
       debug  flags.  This can be accomplished by setting the slurm.conf SlurmdDebug and DebugFlags respectively
       or dynamically through scontrol setdebug and setdebugflags.

       Grafana can be used to create charts based on the data held by InfluxDB.  This kind of tool  permits  one
       to create dashboards, tables and other graphics using the stored time series.

</pre><h4><b>acct_gather_interconnect/OFED</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherInterconnectType=acct_gather_interconnect/ofed

       Options used for acct_gather_interconnect/ofed are as follows:

              <b>InfinibandOFEDPort</b>=&lt;number&gt;
                        This  parameter  represents  the  port  number  of the local Infiniband card that we are
                        willing to monitor.  The default port is 1.
       Datasets provided by the plugin: PacketsIn, PacketsOut, InMB, OutMB

</pre><h4><b>acct_gather_interconnect/sysfs</b></h4><pre>
       Required entry in slurm.conf:
              AcctGatherInterconnectType=acct_gather_interconnect/sysfs

       Options used for acct_gather_interconnect/sysfs are as follows:

              <b>SysfsInterfaces</b>=&lt;interfaces&gt;
                        Comma-separated list of interface names to  collect  statistics  from.  Usage  from  all
                        listed interfaces will be summed together, and is not broken down individually.
       Datasets provided by the plugin: PacketsIn, PacketsOut, InMB, OutMB

</pre><h4><b>EXAMPLE</b></h4><pre>
       ###
       # Slurm acct_gather configuration file
       ###
       # Parameters for acct_gather_energy/impi plugin
       EnergyIPMIFrequency=10
       EnergyIPMICalcAdjustment=yes
       #
       # Parameters for acct_gather_profile/hdf5 plugin
       ProfileHDF5Dir=/app/slurm/profile_data
       # Parameters for acct_gather_interconnect/ofed plugin
       InfinibandOFEDPort=1

</pre><h4><b>COPYING</b></h4><pre>
       Copyright (C) 2012-2013 Bull.  Copyright (C) 2012-2022 SchedMD LLC.  Produced at Bull (cf, DISCLAIMER).

       This    file    is    part    of    Slurm,   a   resource   management   program.    For   details,   see
       &lt;https://slurm.schedmd.com/&gt;.

       Slurm is free software; you can redistribute it and/or modify it under  the  terms  of  the  GNU  General
       Public License as published by the Free Software Foundation; either version 2 of the License, or (at your
       option) any later version.

       Slurm  is  distributed  in  the  hope  that it will be useful, but WITHOUT ANY WARRANTY; without even the
       implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE.  See  the  GNU  General  Public
       License for more details.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/slurm.conf.5.html">slurm.conf</a></b>(5)

December 2023                               Slurm Configuration File                         <u><a href="../man5/acct_gather.conf.5.html">acct_gather.conf</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>