<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>/etc/rsbackup/config - configuration for rsync-based backup utility</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/rsbackup">rsbackup_10.0-3build2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       /etc/rsbackup/config - configuration for rsync-based backup utility

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This describes the configuration file syntax for for <b><a href="../man1/rsbackup.1.html">rsbackup</a></b>(1).

</pre><h4><b>SYNTAX</b></h4><pre>
   <b>Line</b> <b>Splitting</b>
       Line  are split into space-separated words.  To include spaces in a word, quote it using "double quotes".
       Quotes and backslashes within quoted strings are escaped  with  backslashes  (and  cannot  appear  in  an
       unquoted word).

   <b>Comments</b> <b>and</b> <b>Blank</b> <b>Lines</b>
       Anything after the first (unquoted) "#" to appear on a line is ignored.

       Lines  with  no words on (whether they are completely empty, or contain just spaces, or have a "#" before
       any non-space characters) are ignored (and do not have to follow the indentation rules below).

   <b>Directives</b> <b>and</b> <b>Stanzas</b>
       The first word of a line is called a directive.  The remaining words, if any, form its arguments.

       A stanza consists of a directive introducing the stanza followed by zero or more  directives  within  the
       stanza.  These must be indented, consistently, relative to the directive that introduced the stanza.

       A  configuration  file  contains  global  directives  (which  must  not be indented) and one or more host
       stanzas.  Each host stanza contains one or more volume stanzas.

       Global directives may appear after host stanzas (and host directives after volume stanzas) provided  they
       are indented correctly.

   <b>Time</b> <b>Intervals</b>
       A  time interval, denoted <u>INTERVAL</u> below, can be either a raw integer, or an integer with the suffix "s",
       "m", "h" or "d" for seconds, minutes, hours or days respectively.

       If there is no suffix then the interpretation is contextual.  This behavior is deprecated; suffixes  will
       become mandatory in future.

</pre><h4><b>GLOBAL</b> <b>DIRECTIVES</b></h4><pre>
       Global directives control some general aspect of the program.

       <b>database</b> <u>PATH</u>
              The  path  to the backup database.  By default this is <u>LOGS</u><b>/backups.db</b> where <u>LOGS</u> is controlled by
              the <b>logs</b> directive below.

       <b>device</b> <u>DEVICE</u>
              Names a  device.   This  can  be  used  multiple  times.   The  store  must  have  a  file  called
              <u>STORE</u><b>/device-id</b> which contains a known device name.  Backups will only be made to known devices.

              When  a device is lost or destroyed, remove its device entry and use the --prune-unknown option to
              delete records of backups on it.

              Device names may contain letters, digits, dots and underscores.

       <b>include</b> <u>PATH</u>
              Include another file as part of the configuration.  If <u>PATH</u> is a directory then the  files  within
              it are included (excluding dotfiles, backup and recovery files).

       <b>keep-prune-logs</b> <u>INTERVAL</u>
              The time period to keep records of pruned backups for.  The default is 31 days.

       <b>lock</b> <u>PATH</u>
              Enable  locking.  If this directive is present then <u>PATH</u> will be used as a lockfile for operations
              that change anything (--backup, --prune, etc).

              The lock is made by opening <u>PATH</u> and calling <b><a href="../man2/flock.2.html">flock</a></b>(2) on it with <b>LOCK_EX</b>.

       <b>logs</b> <u>PATH</u>
              The directory to store logfiles and backup records.  The default is <u>/var/log/backup</u>.

       <b>post-device-hook</b> <u>COMMAND</u>...
              A command to execute after all backup and prune  operations.   This  is  executed  only  once  per
              invocation  of  <b>rsbackup</b>.   A backup is still considered to have succeeded even if the post-access
              hook fails (i.e. exits nonzero).  See <b>HOOKS</b> below.

       <b>pre-device-hook</b> <u>COMMAND</u>...
              A command to execute before anything that accesses any  backup  devices  (i.e.  backup  and  prune
              operations).   This  is  executed only once per invocation of <b>rsbackup</b> and if it fails (i.e. exits
              nonzero) then <b>rsbackup</b> terminates immediately.  See <b>HOOKS</b> below.

       <b>prune-timeout</b> <u>INTERVAL</u>
              The maximum amount of time to spend pruning, in a single invocation.  0 means  that  there  is  no
              limit (which is the default).

              Note  that,  if this is directive is used, prune operations timing out are considered to be normal
              behavior, and the exit status will be 0.   Most  of  the  diagnostics  relating  to  timeouts  are
              suppressed unless the <b>-v</b> option is used.

       <b>public</b> <b>true</b>|<b>false</b>
              If  true, backups are public.  Normally backups must only be accessible by the calling user.  This
              directive suppresses the check.

       <b>store</b> [<b>--mounted|--no-mounted</b>] <u>PATH</u>
              A path at which a backup device may be mounted.  This can be used multiple times.

              With the <b>--mounted</b> option (which is the default), <u>PATH</u> must be a mount point.   With  <b>--no-mounted</b>
              it need not be a mount point.

       <b>store-pattern</b> [<b>-mounted|-nomounted</b>] <u>PATTERN</u>
              A  <b><a href="../man7/glob.7.html">glob</a></b>(7)  pattern  matching  paths  at  which  a backup device may be mounted.  This can be used
              multiple times.

              See the description of <b>store</b> above for the meanings of the options.

   <b>Report</b> <b>Directives</b>
       These are global directives that affect only the HTML report.

       <b>color-bad</b> <u>COLOR</u>
              The color used to represent bad states (no sufficiently recent backup) in the report.   See  below
              for the interpretation of <u>COLOR</u>.

       <b>color-good</b> <u>COLOR</u>
              The color used to represent good states (a recent backup) in the report.

       <b>report</b> [<b>+</b>] [<u>KEY</u>][<b>:</b><u>VALUE</u>][<b>?</b><u>CONDITION</u>] ...
              Defines  the  report contents.  The arguments to this directive are a sequence of keys, optionally
              parameterized by a value and/or a condition.

              If the first argument is a <b>+</b> then the arguments are added to the current configuration;  otherwise
              they replace it.

              The possible keys, with values where appropriate, are:

              <b>generated</b>
                     A timestamp stating when the report was generated.

              <b>history-graph</b>
                     A   graphic   showing   the  backups  available  for  each  volume.   This  only  works  if
                     <b><a href="../man1/rsbackup-graph.1.html">rsbackup-graph</a></b>(1) is installed.

              <b>h1:</b><u>HEADING</u>

              <b>h2:</b><u>HEADING</u>

              <b>h3:</b><u>HEADING</u>
                     Headings at levels 1, 2 and 3.

              <b>logs</b>   A list of logs of failed backups.

              <b>p:</b><u>PARAGRAPH</u>
                     A paragraph of text.

              <b>prune-logs</b>[<b>:</b><u>DAYS</u>]
                     A list of logs of pruned backups.

                     <u>DAYS</u> is the number of days of pruning logs to put in the report.  The default is 3.

              <b>summary</b>
                     A table summarizing the backups available for each volume.

              <b>title:</b><u>TITLE</u>
                     The document title.

              <b>warnings</b>
                     A list of warning messages.

              If a condition is specified then the key is only used if the  condition  is  true.   The  possible
              conditions are:

              <b>warnings</b>
                     True if there are any warnings to display (i.e. if the <b>warnings</b> key is nonempty).

              Within a <u>VALUE</u> the following sequences undergo substitution:

              <b>\</b><u>CHAR</u>  Replaced with the single character <u>CHAR</u>.

              <b>${</b><u>VARIABLE</u><b>}</b>
                     Replaced with the value of the environment variable <u>VARIABLE</u>, if it is set.

              The following environment variables are set:

              <b>RSBACKUP_CTIME</b>
                     The local date and time in <b><a href="../man3/ctime.3.html">ctime</a></b>(3) format.

              <b>RSBACKUP_DATE</b>
                     The local date in YYYY-MM-DD format.

              The default is equivalent to:

                         report "title:Backup report (${RSBACKUP_DATE})"
                         report + "h1:Backup report (${RSBACKUP_DATE})"
                         report + h2:Warnings?warnings warnings
                         report + "h2:Summary" summary
                         report + history-graph
                         report + h2:Logfiles logs
                         report + "h3:Pruning logs" prune-logs
                         report + "p:Generated ${RSBACKUP_CTIME}"

       <b>sendmail</b> <u>PATH</u>
              The  path  to  the  executable  to  use  for sending email.  The default is platform-dependent but
              typically <u>/usr/sbin/sendmail</u>.  The executable should support the <b>-t</b>, <b>-oee</b>, <b>-oi</b> and <b>-odb</b> options.

       <b>stylesheet</b> <u>PATH</u>
              The path to the stylesheet to use in the HTML report.  If this is absent then a  built-in  default
              stylesheet is used.

   <b>Graph</b> <b>Directives</b>
       These are global directives that affect the output of <b><a href="../man1/rsbackup-graph.1.html">rsbackup-graph</a></b>(1).

       <b>color-graph-background</b> <u>COLOR</u>
              The background color.  See below for the interpretation of <u>COLOR</u>.

       <b>color-graph-foreground</b> <u>COLOR</u>
              The foreground color, i.e. for text.

       <b>color-month-guide</b> <u>COLOR</u>
              The color for the vertical month guides.

       <b>color-host-guide</b> <u>COLOR</u>
              The color for the horizontal guides between hosts.

       <b>color-volume-guide</b> <u>COLOR</u>
              The color for the horizontal guides between volumes.

       <b>device-color-strategy</b> <u>STRATEGY</u>
              The strategy to use for picking device colors.

              A strategy is a name and a sequence of parameters, all of which are optional.

              The possible strategies are:

              <b>equidistant-value</b> <u>HUE</u> <u>SATURATION</u> <u>MINVALUE</u> <u>MAXVALUE</u>
                     Colors  are  picked  with  chosen  hue  and saturation, with values equally spaced within a
                     range.

                     The default hue is 0 and the default saturation is 1.  The default value range is from 0 to
                     1.

              <b>equidistant-hue</b> <u>HUE</u> <u>SATURATION</u> <u>VALUE</u>
                     Colors are picked with chosen saturation and value and equally spaced hues,  starting  from
                     <u>HUE</u>.

                     The default starting hue is 0 and the default saturation and value are 1.

              The default strategy is equivalent to:
                         device-color-strategy equidistant-value 120 0.75

       <b>horizontal-padding</b> <u>PIXELS</u>
              The number pixels to place between horizontally adjacent elements.  The default is 8.

       <b>vertical-padding</b> <u>PIXELS</u>
              The number pixels to place between vertically adjacent elements.  The default is 2.

       <b>host-name-font</b> <u>FONT</u>
              The font description used for host names.  See below for the interpretation of <u>FONT</u>.

       <b>volume-name-font</b> <u>FONT</u>
              The font description used for volume names.

       <b>device-name-font</b> <u>FONT</u>
              The font description used for device names.

       <b>time-label-font</b> <u>FONT</u>
              The font description used for time labels.

       <b>graph-layout</b> [<b>+</b>] <u>PART</u><b>:</b><u>COLUMN</u><b>,</b><u>ROW</u>[<b>:</b><u>HV</u>] ...
              Defines the graph layout.

              The  arguments  to  this  directive  are  a sequence of graph component specifications of the form
              <u>PART</u><b>:</b><u>COLUMN</u><b>,</b><u>ROW</u>[<b>:</b><u>HV</u>], where:

              <u>PART</u>   The name of this component.  The following parts are recognized:

                     <b>host-labels</b>
                            The host name labels for the graph.  This is expected to  be  in  the  same  row  as
                            <b>content</b>.

                     <b>volume-labels</b>
                            The  volume  name  labels  for the graph.  This is expected to be in the same row as
                            <b>content</b>.

                     <b>content</b>
                            The graph content.

                     <b>time-labels</b>
                            The time labels for the graph.  This is  expected  to  be  in  the  same  column  as
                            <b>content</b>.

                     <b>device-key</b>
                            The key mapping device names to colors.

              <u>COLUMN</u> The column number for this component.  0 is the leftmost column.

              <u>ROW</u>    The row number for this component.  0 is the top row.

              <u>HV</u>     The  (optional)  justification  specification  for  this  component.   <u>H</u>  may be one of the
                     following:

                     <b>L</b>      Left justification.

                     <b>C</b>      Centre justification.

                     <b>R</b>      Right justification.

                     <u>V</u> may be one of the following:

                     <b>T</b>      Top justification.

                     <b>C</b>      Centre justification.

                     <b>B</b>      Bottom justification.

              Parts may be repeated or omitted.

              The default layout is equivalent to:

                         graph-layout host-labels:0,0
                         graph-layout + volume-labels:1,0
                         graph-layout + content:2,0
                         graph-layout + time-labels:2,1
                         graph-layout + device-key:2,3:RC

   <b>Colors</b>
       <u>COLOR</u> may be one of the following:

       <u>DECIMAL</u> or <b>0x</b><u>RRGGBB</u>
              An integer value representing an RGB triple.  It is  most  convenient  to  use  hexadecimal.   For
              example, black is <b>0x000000</b>, red is <b>0xFF0000</b>, and so on.

       <b>rgb</b> <u>RED</u> <u>GREEN</u> <u>BLUE</u>
              Three numbers in the range 0 to 1 representing red, green and blue components.

       <b>hsv</b> <u>HUE</u> <u>SATURATION</u> <u>VALUE</u>
              <u>HUE</u>  chooses  between  different  primary  colors  and  mixtures  of  them.  0 represents red, 120
              represents green and 240 represents blue; intermediate values represent mixed hues.

              Normally it would be in the range 0 &lt;= <u>HUE</u> &lt; 360, but values outside this range  are  mapped  into
              it.

              <u>SATURATION</u>  is a number in the range 0 to 1 and (roughly) represents how colorful the color is.  0
              is a shade of grey and 1 is maximally colorful.

              <u>VALUE</u> is a number in the range 0 to 1 and represents the brightness of the color.

              See https://en.wikipedia.org/wiki/HSL_and_HSV for a fuller discussion of these terms.

   <b>Fonts</b>
       <u>FONT</u> is a Pango font description.  The syntax is "[<u>FAMILY-LIST</u>] [<u>STYLE-OPTIONS</u>] [<u>SIZE</u>]" where:

       <u>FAMILY-LIST</u>
              A comma-separate list of font families.  These necessarily depend on the fonts  installed  locally
              but Pango recognizes <b>monospace</b>, <b>sans</b> and and <b>serif</b> as generic family names.

              To get a list of Pango fonts:

                  rsbackup-graph --fonts

       <u>STYLE-OPTIONS</u>
              A whitespace-separated list of style, variant, weight, stretch and gravity options.

              The possible style options are <b>roman</b> (the default), <b>oblique</b> and <b>italic.</b>

              The possible variant options are <b>small-caps</b>.

              The possible weight options are <b>thin,</b> <b>ultra-light</b>, <b>light</b>, <b>semi-light,</b> <b>book</b>, <b>regular</b> (the default),
              <b>medium</b>, <b>semi-bold</b>, <b>bold</b>, <b>ultra-bold</b>, <b>heavy</b> and <b>ultra-heavy</b>.

              The  possible  stretch  options  are  <b>ultra-condensed</b>,  <b>condensed</b>,  <b>semi-condensed</b>, <b>semi-expanded</b>,
              <b>expanded</b> and <b>ultra-expanded</b>.

              The possible gravity options are <b>south</b> (the default), <b>north</b>, <b>east</b> and <b>west</b>.

       <u>SIZE</u>   The font size in points, or <u>PIXELS</u><b>px</b> for a font size in pixels.

       The details of the syntax are entirely under the control of the Pango library; for full details you  must
       consult its documentation or source code.

</pre><h4><b>INHERITABLE</b> <b>DIRECTIVES</b></h4><pre>
       Inheritable  directives  control  an  aspect of one or more backups.  They can be specified at the global
       level or in a <b>host</b> or <b>volume</b> stanza (see below).  If one appears in multiple places then volume  settings
       override host settings and host settings override global settings.

       <b>backup-parameter</b> <u>NAME</u> <u>VALUE</u>
              Set a parameter for the backup policy.  See <b>BACKUP</b> <b>POLICIES</b> below.

       <b>backup-parameter</b> <b>--remove</b> <u>NAME</u>
              Remove a parameter for the backup policy.  See <b>BACKUP</b> <b>POLICIES</b> below.

       <b>backup-policy</b> <u>NAME</u>
              The backup policy to use.  See <b>BACKUP</b> <b>POLICIES</b> below.

       <b>hook-timeout</b> <u>INTERVAL</u>
              How  long  to  wait  before  concluding  a  hook  has hung.  The default is 0, which means to wait
              indefinitely.

       <b>host-check</b> <b>always-up</b>
              Assume that the host is always up.

       <b>host-check</b> <b>ssh</b>
              Check whether the host is up using SSH.  This is the default host check behavior.

       <b>host-check</b> <b>command</b> <u>COMMAND</u>...
              Check whether the host is up by executing a command.  The name of the host will be appended to the
              command line.  If it exits with status 0 the host is assumed to be up.  If it exits  with  nonzero
              status the host is assumed to be down.

       <b>max-age</b> <u>INTERVAL</u>
              The  maximum  age of the most recent backup before you feel uncomfortable.  The default is 3 days,
              meaning that if a volume hasn't been backed up in the last 3 days it will have red ink in the HTML
              report.

       <b>post-volume-hook</b> <u>COMMAND</u>...
              A command to execute after finishing backups of a volume, or after they failed.  A backup is still
              considered to have succeeded even if the post-backup hook fails (exits nonzero).  See <b>HOOKS</b> below.

              The hook can be suppressed with an empty <u>COMMAND</u> (e.g. if you have a  global  hook  and  which  to
              suppress it for a single volume).

       <b>pre-volume-hook</b> <u>COMMAND</u>...
              A  command  to  execute  before  starting  a  backups of a volume.  If this hook fails (i.e. exits
              nonzero) then the backups are not made and the post-volume-hook will not be run.  See <b>HOOKS</b> below.

              The hook can be suppressed with an empty <u>COMMAND</u> (e.g. if you have a  global  hook  and  which  to
              suppress it for a single volume).

              This  hook  can  override  the source path for the volume by writing a new source path to standard
              output.

       <b>prune-parameter</b> <u>NAME</u> <u>VALUE</u>
              Set a parameter for the pruning policy.  See <b>PRUNING</b> below.

       <b>prune-parameter</b> <b>--remove</b> <u>NAME</u>
              Remove a parameter for pruning policy.

       <b>prune-policy</b> <u>NAME</u>
              The pruning policy to use.  See <b>PRUNING</b> below.

       <b>backup-job-timeout</b> <u>INTERVAL</u>
              How long to wait before concluding rsync has  hung.   The  default  is  0,  which  means  to  wait
              indefinitely.

       <b>rsync-command</b> <u>COMMAND</u>
              The command to execute to make a backup.  The default is <b>rsync</b>.

       <b>rsync-base-options</b> <u>OPTIONS</u> ...
              The  options  to  supply  to  the  rsync command.  The default is <b>--archive</b> <b>--sparse</b> <b>--numeric-ids</b>
              <b>--compress</b> <b>--fuzzy</b> <b>--hard-links</b> <b>--delete</b> <b>--stats</b> <b>--no-human-readable</b>.

       <b>rsync-extra-options</b> <u>OPTIONS</u> ...
              Additional options to supply to the rsync command.  The default is <b>--xattrs</b> <b>--acls</b> <b>--open-noatime</b>.

              See <b>PLATFORMS</b> for how to use this directive when backing up macOS or Windows platforms.

       <b>rsync-io-timeout</b> <u>INTERVAL</u>
              The I/O timeout (passed as <b>--timeout</b>) to <b>rsync</b>.  The default is 0, meaning no timeout.

       <b>rsync-link-dest</b> <b>true</b>|<b>false</b>
              If true, use rsync's <b>--link-dest</b> option to save space in backups.  The default is <b>true</b>.

       <b>rsync-remote</b> <b>COMMAND</b>
              If nonempty, passed to <b>rsync</b> as the <b>--rsync-path</b> option.

       <b>ssh-timeout</b> <u>INTERVAL</u>
              How long to wait before concluding a host is down.  The default is 60 seconds.

</pre><h4><b>HOST</b> <b>DIRECTIVES</b></h4><pre>
       A host stanza is started by a <b>host</b> directive.

       <b>host</b> <u>HOST</u>
              Introduce a host stanza.  The name is used for the backup directory for this host.

       The following directives, and <b>volume</b> stanzas (see below), can appear in a host stanza:

       <b>devices</b> <u>PATTERN</u>
              A <b><a href="../man3/glob.3.html">glob</a></b>(3) pattern restricting the devices that this host will be backed up to.

              Note that only backup creation honors this restriction.  Pruning and retiring do not.

       <b>group</b> <u>GROUP</u>
              The concurrency group for this host.   The  default  is  the  name  from  the  host  stanza.   See
              <b>CONCURRENCY</b> below.

       <b>hostname</b> <u>HOSTNAME</u>
              The SSH hostname for this host.  The default is the name from the host stanza.

              The  hostname  <b>localhost</b>  is  treated specially: it is assumed to always be identical to the local
              system, so files will be read from the local filesystem.

       <b>priority</b> <u>INTEGER</u>
              The priority of this host.  Hosts are  backed  up  in  descending  priority  order.   The  default
              priority is 0.

       <b>user</b> <u>USERNAME</u>
              The SSH username for this host.  The default is not to supply a username.

       In  addition,  inheritable directives can appear in a host stanza, and override any appearance of them at
       the global level.

       The contents of a host stanza  must  be  indented  consistently  relative  to  the  <b>host</b>  directive  that
       introduces it.

       Remote  hosts  are accessed by SSH.  The user <b>rsbackup</b> runs as must be able to connect to the remote host
       (and without a password being entered if it is to be run from a cron job or similar).

</pre><h4><b>VOLUME</b> <b>DIRECTIVES</b></h4><pre>
       A volume stanza is started by a <b>volume</b> directive.  It can only appear within a host stanza.

       <b>volume</b> <u>VOLUME</u> <u>PATH</u>
              Introduce a volume stanza.  The name is used for the backup directory for this volume.   The  path
              is the absolute path on the host.

       The following directives can appear in a volume stanza:

       <b>check-file</b> <u>PATH</u>
              Checks  that  <u>PATH</u>  exists before backing up the volume.  <u>PATH</u> may be either an absolute path or a
              relative path (to the root of the volume).  It need not be inside the volume though the usual  use
              would be to check for a file which is always present there.

              This  check  is  done  before executing the <b>pre-volume-hook</b>, so it applies to the real path to the
              volume, not the rewritten path.

       <b>check-mounted</b> <b>true</b>|<b>false</b>
              If true, checks that the volume's path is a mount point before backing up the volume.

              This check is done before executing the <b>pre-volume-hook</b>, so it applies to the  real  path  to  the
              volume, not the rewritten path.

              Note  that  if  multiple <b>check-</b> options are used, all checks must pass for the volume to be backed
              up.

       <b>exclude</b> <u>PATTERN</u>
              An exclusion for this volume.  The  pattern  is  passed  to  the  rsync  <b>--exclude</b>  option.   This
              directive may appear multiple times per volume.

              See the rsync man page for full details.

       <b>traverse</b> <b>true</b>|<b>false</b>
              If true, traverse mount points.  This suppresses the rsync <b>--one-file-system</b> option.

       In addition, inheritable directives can appear in a volume stanza, and override any appearance of them at
       the host or global level.

       The  contents  of  a  volume  stanza  must be indented consistently relative to the <b>volume</b> directive that
       introduces it.

</pre><h4><b>BACKUP</b> <b>POLICIES</b></h4><pre>
       Backup policies determine when a backup is made.  The available policies are listed below.   The  default
       policy is <b>daily</b>.

   <b>always</b>
       This policy creates a backup at every opportunity.

   <b>daily</b>
       This policy creates at most one backup per calendar day, as understood in local time.

   <b>interval</b>
       This policy enfores a minimum interval between backups.  The following backup parameters are supported:

       <b>min-interval</b> <u>INTERVAL</u>
              The minimum interval between backups.

       The  <b>--force</b> option can be used to override backup policies, forcing all selected volumes to be backed up
       unconditionally.

</pre><h4><b>PRUNING</b></h4><pre>
       This is process of removing old backups (using the <b>--prune</b> option).  The pruning policy used to determine
       which backups to remove is set with the inheritable <b>prune-policy</b> directive, and parameters to the  policy
       set via the <b>prune-parameter</b> directive.

       The available policies are listed below.  The default policy is <b>age</b>.

   <b>age</b>
       This  policy  deletes  backups older than a minimum age, provided a minimum number of backups on a device
       remain available.  The following pruning parameters are supported:

       <b>min-backups</b> <u>BACKUPS</u>
              The minimum number of backups of the volume to maintain on the device.  Pruning will  never  cause
              the number of backups to fall below this value.  The default (and minimum) is 1.

       <b>prune-age</b> <u>INTERVAL</u>
              The age after backups become eligible for pruning.  Only backups more than this many days old will
              be pruned.  The default is 366 days and the minimum is 1 day.

       For  backwards  compatibility,  these values can also be set using the directives of the same name.  This
       will be disabled in a future version.

   <b>decay</b>
       This policy thins out backups older than a minimum age, using a configurable decay pattern that  arranges
       to keep a declining number of backups with age.

       The idea is that backup history is partitioned into a series of windows.  Each window is a fixed multiple
       of  the  size  of  the  previous  one.   The pruning policy arranges that only one backup (per device) is
       preserved within each window.

       For example, with the default configuration, the first window is 1 day long and will contain one  backup.
       The  second  window  is two days long and again, only contains one backup.  The third window is four days
       long, and so on.

       The effect is that the density of backups over time decays exponentially.

       See decay.pdf for more information.

       The following pruning parameters are supported:

       <b>decay-start</b> <u>INTERVAL</u>
              The age after backups become eligible for pruning.  Only backups more than this many days old will
              be pruned.  The default is 1 day and the minimum is 1 day.

       <b>decay-limit</b> <u>INTERVAL</u>
              The age after which backups are always pruned.  Backups older than  this  will  always  be  pruned
              unless this would leave no backups at all.  The default is 366 days and the minimum is 1 day.

       <b>decay-scale</b> <u>SCALE</u>
              The  scale at which the decay window is expanded.  The default is 2 and the (exclusive) minimum is
              1.

       <b>decay-window</b> <u>INTERVAL</u>
              The size of the decay window.  The default is 1 day and the minimum is 1 day.

   <b>exec</b>
       This policy executes a subprogram with parameters and additional information supplied in the environment.

       The following parameters are supported:

       <b>path</b>   The path to the subprogram to execute.

       Any additional parameters are supplied to the subprogram via environment variables, prefixed with <b>PRUNE_</b>.
       Additionally the following environment variables are set:

       <b>PRUNE_DEVICE</b>
              The name of the device containing the backup.

       <b>PRUNE_HOST</b>
              The name of the host.

       <b>PRUNE_ONDEVICE</b>
              The list of backups on the device, by timestamp.  This list excludes any that  have  already  been
              scheduled for pruning.

       <b>PRUNE_TOTAL</b>
              The  total  number of backups of this volume on any device.  Note that it does not include backups
              on other devices that have just been selected for pruning by another call to the subprogram.

       <b>PRUNE_VOLUME</b>
              The name of the volume.

       These environment variables all override any parameters with clashing names.

       The output should be a list of backups to prune, one per line (in any order).  Each line  should  contain
       the  timestamp  of the backup to prune (i.e. the same value as appeared in <b>PRUNE_ONDEVICE</b>), followed by a
       colon, followed by the reason that this backup is to be pruned.

       As a convenience, if the argument to <b>prune-policy</b> starts with <b>/</b> then the <b>exec</b> policy is chosen  with  the
       policy name as the <b>path</b> parameter.

   <b>never</b>
       This policy never deletes any backups.

</pre><h4><b>HOOKS</b></h4><pre>
       A  hook  is  a command executed by <b>rsbackup</b> just before or just after some action.  The command is passed
       directly to <b><a href="../man3/execvp.3.html">execvp</a></b>(3); to use a shell command, therefore, either wrap it in a script or invoke the  shell
       with the <b>-c</b> option.

       All  hooks are run in <b>--dry-run</b> mode.  Hook scripts must honor <b>RSBACKUP_ACT</b> which will be set to <b>false</b> in
       this mode and <b>true</b> otherwise.

   <b>Device</b> <b>Hooks</b>
       Device hooks are executed (once) before doing anything that will access backup devices (even just to read
       them).

       The following environment variables are set when a device hook is executed:

       <b>RSBACKUP_ACT</b>
              Set to <b>false</b> in <b>--dry-run</b> mode and <b>true</b> otherwise.

       <b>RSBACKUP_DEVICES</b>
              A space-separated list of known device names.

       <b>RSBACKUP_HOOK</b>
              The name of the hook (i.e. <b>pre-device-hook</b>, etc).  This allows a single hook script  to  serve  as
              the implementation for multiple hooks.

       Device hooks used to be called access hooks.

   <b>Volume</b> <b>Hooks</b>
       Pre-volume hooks are executed before all the backups of a volume, and post-volume hooks after all backups
       of the volume.  Possible uses for volume hooks include snapshotting volumes or mounting volumes.

       When a volume hook is executed, the environment variables listed in <b>ENVIRONMENT</b> below are set, along with
       the following:

       <b>RSBACKUP_HOOK</b>
              The  name  of  the hook (i.e. <b>pre-volume-hook</b>, etc).  This allows a single hook script to serve as
              the implementation for multiple hooks.

       The exit status of the <b>pre-volume-hook</b> is interpreted as follows:

       <b>0</b>      The hook succeeded.  The backup will be attempted.

       <b>75</b>     The volume is temporarily unavailable.  The backup will not be  attempted,  as  if  <b>check-file</b>  or
              <b>check-mounted</b> had failed.

       <u>anything</u> <u>else</u>
              Something went wrong.  The backup will be treated as failed, as if it had been attempted and <b>rsync</b>
              had failed.

       See <b><a href="../man1/rsbackup-snapshot-hook.1.html">rsbackup-snapshot-hook</a></b>(1) for a hook program that can be used to back up from Linux LVM snapshots.

       Volume hooks used to be called backup hooks.

</pre><h4><b>ENVIRONMENT</b></h4><pre>
       When a hook or <b>rsync</b> are executed, the following environment variables are set:

       <b>RSBACKUP_ACT</b>
              Set to <b>false</b> in <b>--dry-run</b> mode and <b>true</b> otherwise.

       <b>RSBACKUP_HOST</b>
              The name of the host.

       <b>RSBACKUP_GROUP</b>
              The name of the concurrency group.  See the <b>group</b> directive.

       <b>RSBACKUP_SSH_HOSTNAME</b>
              The SSH hostname of the host.

              Recall  that  <b>rsbackup</b>  treats  the hostname <b>localhost</b> specially.  If the hook also needs to do so
              then it must duplicate this logic.

       <b>RSBACKUP_SSH_TARGET</b>
              The SSH hostname and username combined for passing to <b><a href="../man1/ssh.1.html">ssh</a></b>(1).

              This will be <u>username</u><b>@</b><u>hostname</u> or just <u>hostname</u> depending on whether a SSH username was set.

       <b>RSBACKUP_SSH_USERNAME</b>
              The SSH username of the host.  If no SSH username was set, this variable will not be set.

       <b>RSBACKUP_VOLUME</b>
              The name of the volume.

       <b>RSBACKUP_VOLUME_PATH</b>
              The path to the volume.

</pre><h4><b>CONCURRENCY</b></h4><pre>
       Any given device only gets used for one thing at a time; it will never happen that two  backups,  or  two
       prunes, access the same device.

       No concurrency group will ever have more than one backup made from it any a time.  Normally a concurrency
       group  is just a single host, but the <b>group</b> directive can be used to add multiple hosts to a single group
       (for instance, if they share physical hardware).

       No two hooks will be executed concurrently, even if  they  apply  to  different  concurrency  groups  and
       different  devices.   However, a hook may execute while a backup (for a different concurrency group and a
       different device) is executing.

</pre><h4><b>NOTES</b></h4><pre>
   <b>Resource</b> <b>Control</b>
       Large backup jobs can have unreasonable impacts on kernel memory, evicting applications and cache data by
       the gigabyte just for single-use copies of backup data.

       On Linux this problem can be addressed with with the memory cgroup controller.

       First, a slice is created on each host (both the back server and client machines):

           [Unit]
           Description=Memory-bound slice for rsbackup
           Before=slices.target

           [Slice]
           MemoryAccounting=true
           MemoryHigh=128M
           MemoryMax=256M

       Second, <b>rsbackup</b> is run with a memory use limit:

           systemd-run --quiet --pipe --slice membound rsbackup --backup

       If you are using the Debian cron job then this can be configured in <u>/etc/rsbackup/defaults</u>:

           nicely="systemd-run --quiet --pipe --slice membound"

       Finally, to control resource use on client machines, add the following to their <b>host</b> sections:

           rsync-remote "systemd-run --quiet --pipe --slice membound rsync"

       See also: <b><a href="../man1/systemd-run.1.html">systemd-run</a></b>(1), <b><a href="../man1/systemctl.1.html">systemctl</a></b>(1), <b><a href="../man5/systemd.slice.5.html">systemd.slice</a></b>(5), <b><a href="../man5/systemd.resource-control.5.html">systemd.resource-control</a></b>(5), <b><a href="../man1/rsbackup.cron.1.html">rsbackup.cron</a></b>(1).

   <b>macOS</b>
       Apple's <b>rsync</b> does not have the --open-noatime option, and has a nonstandard option to enable  backup  of
       extended attributes.

       For local backups you can configure <b>rsbackup</b> to backup extended attributes with a host-level directive:

           rsync-extra-options --extended-attributes

       If  backing  up a macOS host from a host with a modern <b>rsync</b>, or vice versa, however, extended attributes
       and ACLs cannot be backed up at all.  In that case the affected hosts must disable backup  attribute  and
       ACL backup as follows:

           rsync-extra-options

       If an up-to-date <b>rsync</b> is used on macOS hosts, it can be left at the default.

   <b>Windows</b>
       <b>rsbackup</b>  does not run on Windows.  However, it may be used to back up Windows filesystems.  In this case
       it can happen that the attributes in the Windows filesystem do not fit in the backup filesystem; if  this
       happens you may see errors like this:

           rsync: rsync_xal_set: lsetxattr(""/backup7/host/volume/2018-02-04/path/to/file"","attrname") failed: No space left on device (28)
           rsync error: some files/attrs were not transferred (see previous errors) (code 23) at <a href="../man1668/main.c.1668.html">main.c</a>(1668) [generator=3.1.2]

       In that case the affected volumes must disable attribute backup and ACL backup as follows:

           rsync-extra-options --open-noatime

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/rsbackup.1.html">rsbackup</a></b>(1), <b><a href="../man1/rsbackup-graph.1.html">rsbackup-graph</a></b>(1), <b><a href="../man1/rsbackup.cron.1.html">rsbackup.cron</a></b>(1), <b><a href="../man1/rsbackup-mount.1.html">rsbackup-mount</a></b>(1), <b><a href="../man1/rsbackup-snapshot-hook.1.html">rsbackup-snapshot-hook</a></b>(1), <b><a href="../man1/rsync.1.html">rsync</a></b>(1),
       <b><a href="../man5/rsbackup.5.html">rsbackup</a></b>(5)

</pre><h4><b>AUTHOR</b></h4><pre>
       Richard Kettlewell &lt;<a href="mailto:rjk@greenend.org.uk">rjk@greenend.org.uk</a>&gt;

                                                                                                     <u><a href="../man5/rsbackup.5.html">rsbackup</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>