<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jail.conf - configuration for the fail2ban server</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/fail2ban">fail2ban_1.1.0-8_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       jail.conf - configuration for the fail2ban server

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <u>fail2ban.conf</u> <u>fail2ban.d/*.conf</u> <u>fail2ban.local</u> <u>fail2ban.d/*.local</u>

       <u>jail.conf</u> <u>jail.d/*.conf</u> <u>jail.local</u> <u>jail.d/*.local</u>

       <u>action.d/*.conf</u> <u>action.d/*.local</u> <u>action.d/*.py</u>

       <u>filter.d/*.conf</u> <u>filter.d/*.local</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Fail2ban has four configuration file types:

       <u>fail2ban.conf</u>
              Fail2Ban global configuration (such as logging)

       <u>filter.d/*.conf</u>
              Filters specifying how to detect authentication failures

       <u>action.d/*.conf</u>
              Actions defining the commands for banning and unbanning of IP address

       <u>jail.conf</u>
              Jails defining combinations of Filters with Actions.

</pre><h4><b>CONFIGURATION</b> <b>FILES</b> <b>FORMAT</b></h4><pre>
       <u>*.conf</u> files are distributed by Fail2Ban.  It is recommended that *.conf files should remain unchanged to
       ease upgrades.  If needed, customizations should be provided in <u>*.local</u> files.  For example, if you would
       like to enable the [ssh-iptables-ipset] jail specified in jail.conf, create jail.local containing

       <u>jail.local</u>
              [ssh-iptables-ipset]

              enabled = true

       In .local files specify only the settings you would like to change and the rest of the configuration will
       then come from the corresponding .conf file which is parsed first.

       <u>jail.d/</u> and <u>fail2ban.d/</u>

              In  addition  to  .local,  for  jail.conf  or  fail2ban.conf file there can be a corresponding <u>.d/</u>
              directory containing additional .conf files. The order e.g. for <u>jail</u> configuration would be:

              jail.conf
              jail.d/*.conf (in alphabetical order)
              jail.local
              jail.d/*.local (in alphabetical order).

              i.e. all .local files are parsed after .conf files in the original configuration  file  and  files
              under  .d  directory.  Settings in the file parsed later take precedence over identical entries in
              previously parsed files.  Files are ordered alphabetically, e.g.

              <u>fail2ban.d/01_custom_log.conf</u> - to use a different log path
              <u>jail.d/01_enable.conf</u> - to enable a specific jail
              <u>jail.d/02_custom_port.conf</u> - to change the port(s) of a jail.

       Configuration files have sections, those specified with [section name], and name = value pairs. For those
       name items that can accept multiple values, specify the values separated by spaces, or in separate  lines
       space indented at the beginning of the line before the second value.

       Configuration  files  can  include  other (defining common variables) configuration files, which is often
       used in Filters and Actions. Such inclusions are defined in a section called [INCLUDES]:

       <b>before</b> indicates that the specified file is to be parsed before the current file.

       <b>after</b>  indicates that the specified file is to be parsed after the current file.

       Using Python "string interpolation" mechanisms, other definitions are  allowed  and  can  later  be  used
       within other definitions as %(name)s.

       Fail2ban has more advanced syntax (similar python extended interpolation). This extended interpolation is
       using <b>%(section/parameter)s</b> to denote a value from a foreign section.
       Besides  cross  section  interpolation  the value of parameter in <u>[DEFAULT]</u> section can be retrieved with
       <b>%(default/parameter)s</b>.
       Fail2ban supports also another feature named <b>%(known/parameter)s</b>  (means  last  known  option  with  name
       <b>parameter</b>).  This  interpolation  makes  possible  to extend a stock filter or jail regexp in .local file
       (opposite to simply set failregex/ignoreregex that overwrites it), e.g.

              baduseragents = IE|wget|%(my-settings/baduseragents)s
              failregex = %(known/failregex)s
                          useragent=%(baduseragents)s

       Additionally to interpolation <b>%(known/parameter)s</b>, that does not works for filter/action init parameters,
       an interpolation tag <b>&lt;known/parameter&gt;</b> can be used (means  last  known  init  definition  of  filters  or
       actions with name <b>parameter</b>). This interpolation makes possible to extend a parameters of stock filter or
       action  directly  in jail inside <u>jail.conf/jail.local</u> file without creating a separately filter.d/*.local
       file, e.g.

              # filter.d/test.conf:
              [Init]
              test.method = GET
              baduseragents = IE|wget
              [Definition]
              failregex = ^%(__prefix_line)\s+"&lt;test.method&gt;"\s+test\s+regexp\s+-\s+useragent=(?:&lt;baduseragents&gt;)

              # jail.local:
              [test]
              # use filter "test", overwrite method to "POST" and extend known bad agents with "badagent":
              filter = test[test.method=POST, baduseragents="badagent|&lt;known/baduseragents&gt;"]

       Comments: use '#' for comment lines and '; ' (space is important) for inline comments.

</pre><h4><b>FAIL2BAN</b> <b>CONFIGURATION</b> <b>FILE(S)</b> <b>(</b><u><b>fail2ban.conf</b></u><b>)</b></h4><pre>
       The items that can be set in section [Definition] are:

       <b>loglevel</b>
              verbosity level of  log  output:  CRITICAL,  ERROR,  WARNING,  NOTICE,  INFO,  DEBUG,  TRACEDEBUG,
              HEAVYDEBUG or corresponding numeric value (50-5). Default: INFO (equal 20)

       <b>logtarget</b>
              log   target:   filename,   SYSLOG,   STDERR   or   STDOUT.   Default:   STDOUT   if  not  set  in
              fail2ban.conf/fail2ban.local
              Note. If fail2ban running as systemd-service, for logging to the  systemd-journal,  the  logtarget
              could be set to STDOUT
              Only a single log target can be specified.  If you change logtarget from the default value and you
              are  using  logrotate  --  also adjust or disable rotation in the corresponding configuration file
              (e.g. /etc/logrotate.d/fail2ban on Debian systems).

       <b>socket</b> socket filename.  Default: /var/run/fail2ban/fail2ban.sock
              This is used for communication with the fail2ban server daemon.  Do  not  remove  this  file  when
              Fail2ban is running. It will not be possible to communicate with the server afterwards.

       <b>pidfile</b>
              PID filename.  Default: /var/run/fail2ban/fail2ban.pid
              This is used to store the process ID of the fail2ban server.

       <b>allowipv6</b>
              option to allow IPv6 interface - auto, yes (on, true, 1) or no (off, false, 0).  Default: auto
              This value can be used to declare fail2ban whether IPv6 is allowed or not.

       <b>dbfile</b> Database filename. Default: /var/lib/fail2ban/fail2ban.sqlite3
              This defines where the persistent data for fail2ban is stored. This persistent data allows bans to
              be  reinstated  and  continue  reading  log  files  from  the  last read position when fail2ban is
              restarted. A value of <u>None</u> disables this feature.

       <b>dbmaxmatches</b>
              Max number of matches stored in database per ticket. Default: 10
              This option sets the max number of matched log-lines could be stored per ticket in  the  database.
              This also affects values resolvable via tags <b>&lt;ipmatches&gt;</b> and <b>&lt;ipjailmatches&gt;</b> in actions.

       <b>dbpurgeage</b>
              Database purge age in seconds. Default: 86400 (24hours)
              This sets the age at which bans should be purged from the database.

       The config parameters of section [Thread] are:

       <b>stacksize</b>
              Stack size of each thread in fail2ban. Default: 0 (platform or configured default)
              This  specifies the stack size (in KiB) to be used for subsequently created threads, and must be 0
              or a positive integer value of at least 32.

</pre><h4><b>JAIL</b> <b>CONFIGURATION</b> <b>FILE(S)</b> <b>(</b><u><b>jail.conf</b></u><b>)</b></h4><pre>
       The following options are applicable to any jail. They appear in a section specifying the jail name or in
       the <u>[DEFAULT]</u> section which defines default values to be used if not specified in the individual section.

       <b>filter</b> name of the filter -- filename of the filter in /etc/fail2ban/filter.d/ without  the  .conf/.local
              extension.
              Only one filter can be specified.

       <b>logpath</b>
              filename(s) of the log files to be monitored, separated by new lines.
              Globs  --  paths  containing  * and ? or [0-9] -- can be used however only the files that exist at
              start up matching this glob pattern will be considered.

              Optional space separated option 'tail' can be added to the end of the path to cause the  log  file
              to be read from the end, else default 'head' option reads file from the beginning

              Ensure syslog or the program that generates the log file isn't configured to compress repeated log
              messages  to  "<u>*last</u>  <u>message</u>  <u>repeated</u> <u>5</u> <u>time*s</u>" otherwise it will fail to detect. This is called
              <u>RepeatedMsgReduction</u> in rsyslog and should be <u>Off</u>.

       <b>logencoding</b>
              encoding of log files used for decoding. Default value of "auto" uses current system locale.

       <b>logtimezone</b>
              Force the time zone for log lines that don't have one.

              If this option is not specified, log lines from which no explicit time zone  has  been  found  are
              interpreted  by fail2ban in its own system time zone, and that may turn to be inappropriate. While
              the best practice is to configure the monitored applications to  include  explicit  offsets,  this
              option is meant to handle cases where that is not possible.

              The  supported time zones in this option are those with fixed offset: Z, UTC[+-]hhmm (you can also
              use GMT as an alias to UTC).

              This option has no effect on log lines on which an explicit time zone has been found.  Examples:

                      logtimezone = UTC
                      logtimezone = UTC+0200
                      logtimezone = GMT-0100

       <b>banaction</b>
              banning action (default iptables-multiport) typically specified in the <u>[DEFAULT]</u> section  for  all
              jails.
              This parameter will be used by the standard substitution of <u>action</u> and can be redefined central in
              the  <u>[DEFAULT]</u>  section inside <u>jail.local</u> (to apply it to all jails at once) or separately in each
              jail, where this substitution will be used.

       <b>banaction_allports</b>
              the same as <u>banaction</u> but for some "allports" jails  like  "pam-generic"  or  "recidive"  (default
              iptables-allports).

       <b>action</b> action(s) from <u>/etc/fail2ban/action.d/</u> without the <u>.conf</u>/<u>.local</u> extension.
              Arguments  can  be passed to actions to override the default values from the [Init] section in the
              action file. Arguments are specified by:

                     [name=value,name2=value,name3="values,values"]

              Values can also be quoted (required when value includes a  ",").  More  that  one  action  can  be
              specified (in separate lines).

       <b>ignoreself</b>
              boolean value (default true) indicates the banning of own IP addresses should be prevented

       <b>ignoreip</b>
              list  of  IPs  not  to  ban.  They  can  include  a  DNS  resp.  CIDR mask too. The option affects
              additionally to <b>ignoreself</b> (if true) and don't need to contain own DNS resp. IPs  of  the  running
              host.

       <b>ignorecommand</b>
              command  that  is executed to determine if the current candidate IP for banning (or failure-ID for
              raw IDs) should not be banned. This option operates alongside the <b>ignoreself</b> and <b>ignoreip</b> options.
              It is executed first, only if neither <b>ignoreself</b> nor <b>ignoreip</b> match the criteria.
              IP will not be banned if command returns successfully (exit code 0).  Like ACTION FILES, tags like
              &lt;ip&gt; are can be included in the ignorecommand value and will be substituted before execution.

       <b>ignorecache</b>
              provide cache parameters (default disabled) for ignore failure check (caching of the  result  from
              <b>ignoreip</b>, <b>ignoreself</b> and <b>ignorecommand</b>), syntax:

                      ignorecache = key="&lt;F-USER&gt;@&lt;ip-host&gt;", max-count=100, max-time=5m
                      ignorecommand = if [ "&lt;F-USER&gt;" = "technical" ] &amp;&amp; [ "&lt;ip-host&gt;" = "my-host.example.com" ]; then exit 0; fi;
                                      exit 1
              This  will  cache  the  result of <b>ignorecommand</b> (does not call it repeatedly) for 5 minutes (cache
              time) for maximal 100 entries (cache size), using values substituted like  "user@host"  as  cache-
              keys.  Set option <b>ignorecache</b> to empty value disables the cache.

       <b>bantime</b>
              effective ban duration (in seconds or time abbreviation format).

       <b>findtime</b>
              time interval (in seconds or time abbreviation format) before the current time where failures will
              count towards a ban.

       <b>maxretry</b>
              number of failures that have to occur in the last <b>findtime</b> seconds to ban the IP.

       <b>backend</b>
              backend to be used to detect changes in the logpath.
              It  defaults to "auto" which will try "pyinotify", "systemd" before "polling". Any of these can be
              specified. "pyinotify" is only valid on Linux systems with the "pyinotify" Python libraries.

       <b>usedns</b> use DNS to resolve HOST names that appear in the logs. By default it is "warn" which will  resolve
              hostnames  to  IPs  however  it  will  also  log a warning. If you are using DNS here you could be
              blocking the wrong IPs due to the asymmetric nature of reverse DNS (that the application  used  to
              write  the  domain name to log) compared to forward DNS that fail2ban uses to resolve this back to
              an IP (but not necessarily the same one). Ideally you should configure your applications to log  a
              real IP. This can be set to "yes" to prevent warnings in the log or "no" to disable DNS resolution
              altogether (thus ignoring entries where hostname, not an IP is logged)..

       <b>prefregex</b>
              regex  (Python  <b>reg</b>ular  <b>ex</b>pression)  to  parse  a  common  part  containing in every message (see
              <b>prefregex</b> in section FILTER FILES for details).

       <b>failregex</b>
              regex (Python <b>reg</b>ular <b>ex</b>pression) to be added  to  the  filter's  failregexes  (see  <b>failregex</b>  in
              section  FILTER  FILES  for  details).  If this is useful for others using your application please
              share you regular expression with the fail2ban developers by reporting  an  issue  (see  REPORTING
              BUGS below).

       <b>ignoreregex</b>
              regex which, if the log line matches, would cause Fail2Ban not consider that line.  This line will
              be ignored even if it matches a failregex of the jail or any of its filters.

       <b>maxmatches</b>
              max  number  of  matched  log-lines the jail would hold in memory per ticket. By default it is the
              same value as <b>maxretry</b> of jail (or default).  This option also affects values resolvable  via  tag
              <b>&lt;matches&gt;</b> in actions.

   <b>Backends</b>
       Available options are listed below.

       <b>pyinotify</b>
              requires  pyinotify  (a  file  alteration monitor) to be installed. If pyinotify is not installed,
              Fail2ban will use auto.

       <b>polling</b>
              uses a polling algorithm which does not require external libraries.

       <b>systemd</b>
              uses systemd python library to access the systemd journal. Specifying <b>logpath</b>  is  not  valid  for
              this  backend  and instead utilises <b>journalmatch</b> from the jails associated filter config. Multiple
              systemd-specific flags can be passed to the backend, including <b>journalpath</b>  and  <b>journalfiles</b>,  to
              explicitly  set  the  path to a directory or set of files. <b>journalflags</b>, which by default is 4 and
              excludes user session files, can be set to include  them  with  <b>journalflags=1</b>,  see  the  python-
              systemd documentation for other settings and further details. Examples:

              backend = systemd[journalpath=/run/log/journal/machine-1]
              backend = systemd[journalfiles="/path/to/system.journal, /path/to/user.journal"]
              backend = systemd[journalflags=1]

   <b>Actions</b>
       Each  jail  can  be  configured with only a single filter, but may have multiple actions. By default, the
       name of a action is the action filename, and in the case of Python actions, the ".py" file  extension  is
       stripped.  Where  multiple  of  the same action are to be used, the <b>actname</b> option can be assigned to the
       action to avoid duplication e.g.:

       [ssh-iptables-ipset]
       enabled = true
       action = smtp.py[dest=<a href="mailto:chris@example.com">chris@example.com</a>, actname=smtp-chris]
                smtp.py[dest=<a href="mailto:sally@example.com">sally@example.com</a>, actname=smtp-sally]

</pre><h4><b>TIME</b> <b>ABBREVIATION</b> <b>FORMAT</b></h4><pre>
       The time entries in fail2ban configuration (like <b>findtime</b> or <b>bantime</b>)  can  be  provided  as  integer  in
       seconds or as string using special abbreviation format (e. g. <b>600</b> is the same as <b>10m</b>).

       <b>Abbreviation</b> <b>tokens:</b>

              years?, yea?, yy?
              months?, mon?
              weeks?, wee?, ww?
              days?, da, dd?
              hours?, hou?, hh?
              minutes?, min?, mm?
              seconds?, sec?, ss?

              The question mark (?) means the optional character, so <b>day</b> as well as <b>days</b> can be used.

       You  can  combine multiple tokens in format (separated with space resp. without separator), e. g.: <b>1y</b> <b>6mo</b>
       or <b>1d12h30m</b>.
       Note that tokens <b>m</b> as well as <b>mm</b> means minutes, for month use abbreviation <b>mo</b> or <b>mon</b>.

       The time format can be tested using <b>fail2ban-client</b>:

              fail2ban-client --str2sec 1d12h

</pre><h4><b>ACTION</b> <b>CONFIGURATION</b> <b>FILES</b> <b>(</b><u><b>action.d/*.conf</b></u><b>)</b></h4><pre>
       Action files specify which commands are executed to ban and unban an IP address.

       Like with jail.conf files, if  you  desire  local  changes  create  an  <u>[actionname].local</u>  file  in  the
       <u>/etc/fail2ban/action.d</u> directory and override the required settings.

       Action files have two sections, <b>Definition</b> and <b>Init</b> .

       The  [Init] section enables action-specific settings. In <u>jail.conf/jail.local</u> these can be overridden for
       a particular jail as options of the action's specification in that jail.

       The following commands can be present in the [Definition] section.

       <b>actionstart</b>
              command(s) executed when the jail starts.

       <b>actionstop</b>
              command(s) executed when the jail stops.

       <b>actioncheck</b>
              command(s) ran before any other action. It aims to verify if the environment is still ok.

       <b>actionban</b>
              command(s) that bans the IP address after <b>maxretry</b> log lines matches within last <b>findtime</b> seconds.

       <b>actionunban</b>
              command(s) that unbans the IP address after <b>bantime</b>.

       The [Init] section allows for action-specific settings. In <u>jail.conf/jail.local</u> these can be  overwritten
       for  a  particular  jail  as  options to the jail. The following are special tags which can be set in the
       [Init] section:

       <b>timeout</b>
              The maximum period of time in seconds that a command can executed, before being killed.

       Commands specified in the [Definition] section are executed through a system shell so  shell  redirection
       and  process control is allowed. The commands should return 0, otherwise error would be logged.  Moreover
       if <b>actioncheck</b> exits with non-0 status, it is taken as indication that firewall status  has  changed  and
       fail2ban  needs  to  reinitialize  itself  (i.e.  issue  <b>actionstop</b>  and <b>actionstart</b> commands).  Tags are
       enclosed in &lt;&gt;.  All the elements of [Init] are tags that are replaced in all action commands.  Tags  can
       be added by the <b>fail2ban-client</b> using the "set &lt;JAIL&gt; action &lt;ACT&gt;" command. <b>&lt;br&gt;</b> is a tag that is always
       a new line (\n).

       More  than  a  single command is allowed to be specified. Each command needs to be on a separate line and
       indented with whitespace(s) without blank lines.  The  following  example  defines  two  commands  to  be
       executed.

        actionban = iptables -I fail2ban-&lt;name&gt; --source &lt;ip&gt; -j DROP
                    echo ip=&lt;ip&gt;, match=&lt;match&gt;, time=&lt;time&gt; &gt;&gt; /var/log/fail2ban.log

   <b>Action</b> <b>Tags</b>
       The  following  tags  are  substituted  in the actionban, actionunban and actioncheck (when called before
       actionban/actionunban) commands.

       <b>ip</b>     IPv4 IP address to be banned. e.g. 192.168.0.2

       <b>failures</b>
              number of times the failure occurred in the log file. e.g. 3

       <b>ipfailures</b>
              As per <b>failures</b>, but total of all failures for that ip address across all jails from the  fail2ban
              persistent database. Therefore the database must be set for this tag to function.

       <b>ipjailfailures</b>
              As per <b>ipfailures</b>, but total based on the IPs failures for the current jail.

       <b>time</b>   UNIX (epoch) time of the ban. e.g. 1357508484

       <b>matches</b>
              concatenated  string  of the log file lines of the matches that generated the ban. Many characters
              interpreted by shell get escaped to prevent injection, nevertheless use with caution.

       <b>ipmatches</b>
              As per <b>matches</b>, but includes all lines for the IP which are contained with the fail2ban persistent
              database. Therefore the database must be set for this tag to function.

       <b>ipjailmatches</b>
              As per <b>ipmatches</b>, but matches are limited for the IP and for the current jail.

</pre><h4><b>PYTHON</b> <b>ACTION</b> <b>FILES</b></h4><pre>
       Python based actions can also be used, where the file name must be <u>[actionname].py</u>. The Python file  must
       contain  a variable <u>Action</u> which points to Python class. This class must implement a minimum interface as
       described by <u>fail2ban.server.action.ActionBase</u>, which can be inherited from to ease implementation.

</pre><h4><b>FILTER</b> <b>FILES</b> <b>(</b><u><b>filter.d/*.conf</b></u><b>)</b></h4><pre>
       Filter definitions are those in <u>/etc/fail2ban/filter.d/*.conf</u> and <u>filter.d/*.local</u>.

       These are used to identify failed authentication attempts in log files and to extract the host IP address
       (or hostname if <b>usedns</b> is <b>true</b>).

       Like action files, filter files are ini files. The main section is the [Definition] section.

       There are several standard filter definitions used in the [Definition] section:

       <b>prefregex</b>
              is the regex (<b>reg</b>ular <b>ex</b>pression) to parse a common part containing in  every  message,  which  is
              applied  after <b>datepattern</b> found a match, before the search for any <b>failregex</b> or <b>ignoreregex</b> would
              start.
              If this regex doesn't match the process is starting immediately with next message and  search  for
              any <b>failregex</b> does not occur.
              If  <b>prefregex</b>  contains <u>&lt;F-CONTENT&gt;...&lt;/F-CONTENT&gt;</u>, the part of message enclosed between this tags
              will be extracted and herafter used as whole message for search with <b>failregex</b> or <b>ignoreregex</b>.

              For example:
                      prefregex = ^%(__prefix_line)s (?:ERROR|FAILURE) &lt;F-CONTENT&gt;.+&lt;/F-CONTENT&gt;$
                      failregex = ^user not found
                                  ^authentication failed
                                  ^unknown authentication method

              You can use <b>prefregex</b> in order to:

                     - specify 1 common regex to match some common part present  in  every  messages  (do  avoid
                     unneeded match in every <b>failregex</b> if you have more as one);

                     -  to  cut  some  interesting part of message only (to simplify <b>failregex</b>) enclosed between
                     tags <u>&lt;F-CONTENT&gt;</u> <u>and</u> <u>&lt;/F-CONTENT&gt;</u>;

                     - to gather some failure identifier (e. g. some prefix  matched  by  <u>&lt;F-MLFID&gt;...&lt;F-MLFID/&gt;</u>
                     tag)  to  identify  several  messages  belonging  to  same session, where a connect message
                     containing IP followed by failure message(s) that are not contain IP; this provides  a  new
                     multi-line  parsing  method  as replacement for old (slow an ugly) multi-line parsing using
                     buffering window (<u>maxlines</u> &gt; 1 and <u>&lt;SKIPLINES&gt;</u>);

                     - to ignore some wrong, too long or even unneeded messages (a.k.a.  parasite  log  traffic)
                     which can be also present in journal, before <b>failregex</b> search would take place.

       <b>failregex</b>
              is  the  regex (<b>reg</b>ular <b>ex</b>pression) that will match failed attempts. The standard replacement tags
              can be used as part of the regex:

                     <u>&lt;HOST&gt;</u> - common regex for IP addresses and hostnames (if <b>usedns</b> is enabled). Fail2Ban  will
                     work out which one of these it actually is.

                     <u>&lt;ADDR&gt;</u> - regex for IP addresses (both families).

                     <u>&lt;IP4&gt;</u> - regex for IPv4 addresses.

                     <u>&lt;IP6&gt;</u> - regex for IPv6 addresses.

                     <u>&lt;DNS&gt;</u> - regex to match hostnames.

                     <u>&lt;CIDR&gt;</u> - helper regex to match CIDR (simple integer form of net-mask).

                     <u>&lt;SUBNET&gt;</u> - regex to match sub-net addresses (in form of IP/CIDR, also single IP is matched,
                     so part /CIDR is optional).

                     <u>&lt;F-ID&gt;...&lt;/F-ID&gt;</u> - free regex capturing group targeting identifier used for ban (instead of
                     IP address or hostname).

                     <u>&lt;F-*&gt;...&lt;/F-*&gt;</u>  -  free  regex capturing named group stored in ticket, which can be used in
                     action.
                     For example <u>&lt;F-USER&gt;[^@]+&lt;/F-USER&gt;</u> matches and stores a user name, that can be used in action with interpolation tag <u>&lt;F-USER&gt;</u>.

                     <u>&lt;F-ALT_*n&gt;...&lt;/F-ALT_*n&gt;</u> - free regex capturing alternative named group stored in ticket.
                     For example first found matched value defined in regex as <u>&lt;F-ALT_USER&gt;</u>, <u>&lt;F-ALT_USER1&gt;</u> or <u>&lt;F-ALT_USER2&gt;</u> would be stored as &lt;F-USER&gt; (if direct match is not found or empty).

              Every of abovementioned tags can be specified in <b>prefregex</b> and in <b>failregex</b>, thereby if specified in both, the value matched in <b>failregex</b> overwrites a value matched in <b>prefregex</b>.
              All standard tags like IP4 or IP6 can be also specified with custom regex using <u>&lt;F-*&gt;...&lt;/F-*&gt;</u> syntax, for example <u>(?:ip4:&lt;F-IP4&gt;\S+&lt;/F-IP4&gt;|ip6:&lt;F-IP6&gt;\S+&lt;/F-IP6&gt;)</u>.
              Tags <u>&lt;ADDR&gt;</u>, <u>&lt;HOST&gt;</u> and <u>&lt;SUBNET&gt;</u> would also match the IP address enclosed in square brackets.

              <b>NOTE:</b> the <b>failregex</b> will be applied to the remaining part of message after <b>prefregex</b> processing (if specified), which in turn takes place after <b>datepattern</b> processing (whereby the string of timestamp matching the best pattern, cut out from the message).

              For multiline regexs (parsing with <u>maxlines</u> greater that 1) the tag <u>&lt;SKIPLINES&gt;</u> can be used to separate lines. This allows lines between the matched lines to continue to be searched for other failures. The tag can be used multiple times.
              This is an obsolete handling and if the lines contain some common identifier, better would be to use new handling (with tags <u>&lt;F-MLFID&gt;...&lt;F-MLFID/&gt;</u>).

       <b>ignoreregex</b>
              is the regex to identify log entries that should be ignored by Fail2Ban, even if they match failregex.

       <b>maxlines</b>
              specifies the maximum number of lines to buffer to match multi-line regexs. For some log formats this will not required to be changed. Other logs may require to increase this value if a particular log file is frequently written to.

       <b>datepattern</b>
              specifies a custom date pattern/regex as an alternative to the default date detectors e.g. %%Y-%%m-%%d %%H:%%M(?::%%S)?.
              For a list of valid format directives, see Python library documentation for strptime behaviour.
              <b>NOTE:</b> due to config file string substitution, that %'s must be escaped by an % in config files.
              Also, special values of <u>Epoch</u> (UNIX Timestamp), <u>TAI64N</u> and <u>ISO8601</u> can be used as datepattern.
              Normally the regexp generated for datepattern additionally gets word-start and word-end boundaries to avoid accidental match inside of some word in a message.
              There are several prefixes and words with special meaning that could be specified with custom datepattern to control resulting regex:

                     <u>{DEFAULT}</u> - can be used to add default date patterns of fail2ban.

                     <u>{DATE}</u> - can be used as part of regex that will be replaced with default date patterns.

                     <u>{^LN-BEG}</u> - prefix (similar to <u>^</u>) changing word-start boundary to line-start boundary (ignoring up to 2 characters). If used as value (not as a prefix), it will also set all default date patterns (similar to <u>{DEFAULT}</u>), but anchored at begin of message line.

                     <u>{UNB}</u> - prefix to disable automatic word boundaries in regex.

                     <u>{NONE}</u> - value would allow one to find failures totally without date-time in log message. Filter will use now as a timestamp (or last known timestamp from previous line with timestamp).

       <b>journalmatch</b>
              specifies the systemd journal match used to filter the journal entries. See <b><a href="../man1/journalctl.1.html">journalctl</a>(1)</b> and <b><a href="../man7/systemd.journal-fields.7.html">systemd.journal-fields</a>(7)</b> for matches syntax and more details on special journal fields. This option is only valid for the <u>systemd</u> backend.

       Similar to actions, filters may have an [Init] section also (optional since v.0.10). All parameters of both sections [Definition] and [Init] can be overridden (redefined or extended) in <u>jail.conf</u> or <u>jail.local</u> (or in related <u>filter.d/filter-name.local</u>).
       Every option supplied in the jail to the filter overwrites the value specified in [Init] section, which in turm would overwrite the value in [Definition] section.
       Besides the standard settings of filter both sections can be used to initialize filter-specific options.

       Filters can also have a section called [INCLUDES]. This is used to read other configuration files.

       <b>before</b> indicates that this file is read before the [Definition] section.

       <b>after</b>  indicates that this file is read after the [Definition] section.

</pre><h4><b>AUTHOR</b></h4><pre>
       Fail2ban was originally written by Cyril Jaquier  &lt;<a href="mailto:cyril.jaquier@fail2ban.org">cyril.jaquier@fail2ban.org</a>&gt;.   At  the  moment  it  is
       maintained  and  further  developed  by  Yaroslav  O.  Halchenko  &lt;<a href="mailto:debian@onerussian.com">debian@onerussian.com</a>&gt;,  Daniel  Black
       &lt;<a href="mailto:daniel.subs@internode.on.net">daniel.subs@internode.on.net</a>&gt; and Steven Hiscocks &lt;<a href="mailto:steven-fail2ban@hiscocks.me.uk">steven-fail2ban@hiscocks.me.uk</a>&gt; along with  a  number
       of  contributors.   See <b>THANKS</b> file shipped with Fail2Ban for a full list.  Manual page written by Daniel
       Black and Yaroslav Halchenko.

</pre><h4><b>REPORTING</b> <b>BUGS</b></h4><pre>
       Report bugs to https://github.com/fail2ban/fail2ban/issues

</pre><h4><b>COPYRIGHT</b></h4><pre>
       Copyright © 2013 the Fail2Ban Team
       Copyright of modifications held by their respective authors.
       Licensed under the GNU General Public License v2 (GPL) or (at your option) any later version.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/fail2ban-server.1.html">fail2ban-server</a>(1)

Fail2Ban                                          November 2015                                     <u><a href="../man5/JAIL.CONF.5.html">JAIL.CONF</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>