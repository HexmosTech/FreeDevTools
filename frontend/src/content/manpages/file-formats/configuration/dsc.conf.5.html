<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dsc.conf - Configuration for the DNS Statistics Collector</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/oarc-dsc">oarc-dsc_2.15.2-3_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dsc.conf - Configuration for the DNS Statistics Collector

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The file <u>dsc.conf</u> contains defaults for the program <b><a href="../man1/dsc.1.html">dsc</a>(1)</b> <b>.</b>  Each line is a configuration option and may
       have arguments in the form <u>option</u> <u>value;</u>.  Comment lines must have a hash sign (#) in the first column.

       Since  <b><a href="../man1/dsc.1.html">dsc</a>(1)</b> version 2.2.0, a configuration line may not be divided with CR/LF and quoted characters are
       not understood (\quote).

</pre><h4><b>CONFIGURATION</b></h4><pre>
       <b>local_address</b> IP [ MASK / BITS ] ;
              Specifies the DNS server's local IP address with an optional mask/bits for local networks.  It  is
              used  to  determine  the direction of an IP packet: sending, receiving, or other.  You may specify
              multiple local addresses by repeating the <b>local_address</b> line any number of times.

       <b>run_dir</b> PATH ;
              A directory that will become <u>dsc</u> current directory after it starts.  Output files will be  written
              here, as will any core dumps.

       <b>minfree_bytes</b> BYTES ;
              If  the  filesystem where <u>dsc</u> writes its output files does not have at least this much free space,
              then <u>dsc</u> will not write the files.  This prevents <u>dsc</u> from filling up the filesystem.   The  files
              that  would  have  been  written  are  simply  lost and cannot be recovered.  Output files will be
              written again when the filesystem has the necessary free space.

       <b>pid_file</b> " FILE " ;
              The file where <u>dsc</u> will store its process id.

       <b>bpf_program</b> " RULE " ;
              A Berkeley Packet Filter program string.  You may use this to further restrict  the  traffic  seen
              but  note  that  <u>dsc</u>  currently  has  one  indexer  that  looks at all IP packets.  If you specify
              something like <b>udp</b> <b>port</b> <b>53</b> that indexer will not work.

              However, if you want to monitor multiple DNS servers with separate <u>dsc</u> instances on one  collector
              box, then you may need to use <b>bpf_program</b> to make sure that each <u>dsc</u> process sees only the traffic
              it should see.

              Note  that  this  directive must go before the <b>interface</b> directive because <u>dsc</u> makes only one pass
              through the configuration file and the BPF filter is set when the interface is initialized.

       <b>dns_port</b> NUMBER ;
              <u>dsc</u> will only parse traffic coming to or leaving the DNS port (default 53), this option  lets  you
              control which port that is in case it's not standard.

       <b>pcap_buffer_size</b> NUMBER ;
              Set  the  buffer  size (in bytes) for pcap, increasing this may help if you see dropped packets by
              the kernel but increasing it too much may have other side effects.

              Note that this directive must go before the <b>interface</b> directive because <u>dsc</u> makes  only  one  pass
              through the configuration file and the pcap buffer size is set when the interface is initialized.

       <b>pcap_thread_timeout</b> MILLISECONDS ;
              Set the internal timeout pcap-thread uses when waiting for packets, the default is 100 ms.

              Note that this directive must go before the <b>interface</b> directive.

       <b>drop_ip_fragments</b> ;
              Drop all packets that are fragments.

              Note that this directive must go before the <b>interface</b> directive.

       <b>interface</b> IFACE | FILE ;
              The  interface  name  to  sniff packets from or a pcap file to read packets from.  You may specify
              multiple interfaces by repeating the <b>interface</b> line any number of times.

              Under Linux (kernel v2.2+) libpcap can use an "any" interface which will  include  any  interfaces
              the  host  has  but  these  interfaces  will  not  be  put into promiscuous mode which may prevent
              capturing traffic that is not directly related to the host.

       <b>dnstap_file</b> FILE ;
       <b>dnstap_unixsock</b> FILE [ USER ][ :GROUP ] [ UMASK ] ;
       <b>dnstap_tcp</b> IP PORT ;
       <b>dnstap_udp</b> IP PORT ;
              Specify DNSTAP input from a file, UNIX socket,  UDP  or  TCP  connections  (dsc  will  listen  for
              incoming  connections).   This type of input is delivered directly from the DNS software itself as
              encapsulated DNS packets as seen or as made by the software.   See  https://dnstap.info  for  more
              information about DNSTAP.

              For  UNIX  sockets  there  are  additional optional options to control access to it.  The user and
              group access are specified together as strings (USER:GROUP), separated with a colon if a group  is
              specified.   The  file  permissions are controlled by a file mode creation mask (UMASK, must being
              with 0) which is set temporarily during socket creation.  It  is  not  necessary  to  specify  all
              options, you can specify only USER, only :GROUP or only UMASK.

              Example  below shows how to give read and write access to somegroup, remove permissions for others
              and how the resulting socket file permissions would be:

                dnstap_unixsock /path/to/file.sock :somegroup 0007;

                srwxrwx--- 1 root somegroup    0 Date dd HH:MM /path/to/file.sock

              NOTE:

              -      Only one DNSTAP input can be specified at a time currently.

              -      Configuration needs to match that of the DNS software.

       <b>dnstap_network</b> IPV4 IPV6 PORT ;
              Specify DNSTAP network information.

              Per DNSTAP specification, some information may be not included such as receiver or sender of  DNS.
              To  be able to produce statistics, <u>dsc</u> needs to know what to put in place when that information is
              missing.  This is configured by <u>dnstap_network</u> and should be the primary IP addresses and port  of
              the DNS software.

              Default values are <b>127.0.0.1</b> <b>::1</b> <b>53</b>.

       <b>qname_filter</b> NAME FILTER ;
              This  directive  allows you to define custom filters to match query names in DNS messages.  Please
              see section QNAME FILTERS for more information.

       <b>datasets</b> NAME TYPE LABEL:FIRST LABEL:SECOND FILTERS [ PARAMETERS ] ;
              This directive is the heart of <b>dsc</b>.  However, it is also the most complex (see section DATASETS).

              See section EXAMPLE for a set of defined good datasets which is also installed as <b>dsc.conf.sample</b>.

       <b>bpf_vlan_tag_byte_order</b> TYPE ;
              <u>dsc</u> knows about VLAN tags.  Some operating systems (FreeBSD-4.x) have a bug whereby the  VLAN  tag
              id  is byte-swapped.  Valid values for this directive are <b>host</b> and <b>net</b> (the default).  Set this to
              <b>host</b> if you suspect your operating system has the VLAN tag byte order bug.

       <b>match_vlan</b> ID [ ID ... ] ;
              A white-space separated list of VLAN identifiers.  If set, only the  packets  belonging  to  these
              VLANs are analyzed.

       <b>statistics_interval</b> SECONDS ;
              Specify how often <b>dsc</b> should write statistics, default to 60 seconds.

       <b>no_wait_interval</b> ;
              Do  not  wait  on  interval  sync  to  start  capturing,  normally  DSC  will  sleep  for time() %
              statistics_interval to align with the minute (as was the default interval before) but now  if  you
              change the interval to more then a minute you can use with option to begin capture right away.

       <b>output_format</b> FORMAT ;
              Specify  the  output format.  You may specify multiple formats by repeating the <b>output_format</b> line
              any number of times.  Default output format is XML, see  section  DATA  FORMATS  and  FILE  NAMING
              CONVENTIONS.

       <b>output_user</b> USER ;
              Specify which user should own the output file, default to the user running <u>dsc</u>.

       <b>output_group</b> GROUP ;
              Specify which group should own the output file, default to the group of the user running <u>dsc</u>.

       <b>output_mod</b> FILE_MODE_BITS ;
              Specify the file mode bits (in octal) for the output file permissions, default to 0664.

       <b>dump_reports_on_exit</b> ;
              Dump any remaining report before exiting.

              NOTE: Timing in the data files will be off!

       <b>geoip_v4_dat</b> " FILE " [ OPTION ... ] ;
              Specify the GeoIP dat file to open for IPv4 country lookup, see section GEOIP for options.

       <b>geoip_v6_dat</b> " FILE " [ OPTION ... ] ;
              Specify the GeoIP dat file to open for IPv6 country lookup, see section GEOIP for options.

       <b>geoip_asn_v4_dat</b> " FILE " [ OPTION ... ] ;
              Specify the GeoIP dat file to open for IPv4 AS number lookup, see section GEOIP for options.

       <b>geoip_asn_v6_dat</b> " FILE " [ OPTION ... ] ;
              Specify the GeoIP dat file to open for IPv6 AS number lookup, see section GEOIP for options.

       <b>asn_indexer_backend</b> BACKEND ;
              Specify  what  backend  to use for the ASN indexer, either "geoip" for GeoIP Legacy or "maxminddb"
              for MaxMind DB (GeoIP2).

       <b>country_indexer_backend</b> BACKEND ;
              Specify what backend to  use  for  the  country  indexer,  either  "geoip"  for  GeoIP  Legacy  or
              "maxminddb" for MaxMind DB (GeoIP2).

       <b>maxminddb_asn</b> " FILE " ;
              Specify the MaxMind DB file to use for ASN lookups.

       <b>maxminddb_country</b> " FILE " ;
              Specify the MaxMind DB file to use for country lookups.

       <b>client_v4_mask</b> NETMASK ;
              Set the IPv4 MASK for client_subnet INDEXERS.

       <b>client_v6_mask</b> NETMASK ;
              Set the IPv6 MASK for client_subnet INDEXERS.

       <b>response_time_mode</b> MODE ;
              Set the output MODE of the response time indexer:

              <b>bucket</b> Count  response  time in buckets of microseconds, see <b>response_time_bucket_size</b> for setting
                     the size of the buckets.

              <b>log10</b>  Count response time in logarithmic scale with base 10.

              <b>log2</b>   Count response time in logarithmic scale with base 2.

       <b>response_time_max_queries</b> NUMBER ;
              Set the maximum number of queries to keep track of.

       <b>response_time_full_mode</b> MODE ;
              If the number of queries tracked exceeds <b>response_time_max_queries</b> the MODE will  control  how  to
              handle it:

              <b>drop_query</b>
                     Drop the incoming query.

              <b>drop_oldest</b>
                     Drop the oldest query being tracked and accept the incoming one.

       <b>response_time_max_seconds</b> SECONDS ;
              Set the maximum seconds to keep a query but a query can still be matched to a response while being
              outside this limit, see <b>response_time_max_sec_mode</b> on how to handle those situations.

       <b>response_time_max_sec_mode</b> MODE ;
              Control   how   to  handle  queries  and  responses  which  are  match  successfully  but  exceeds
              <b>response_time_max_seconds</b>:

              <b>ceil</b>   The query will be counted as successful but the time it took will be  the  maximum  seconds
                     (think ceiling, or ceil()).

              <b>timed_out</b>
                     The query will be counted as timed out.

       <b>response_time_bucket_size</b> SIZE ;
              Control the size of bucket (microseconds) in bucket mode.

       <b>knowntlds_file</b> FILE ;
              Load    known    TLDs    from    FILE,   this   should   be   or   have   the   same   format   as
              <u>https://data.iana.org/TLD/tlds-alpha-by-domain.txt</u>.

       <b>tld_list</b> FILE ;
              This option changes what DSC considers a TLD (similar to  Public  Suffix  List)  and  affects  any
              indexers  that  gathers statistics on TLDs, such as the <u>tld</u>, <u>second_ld</u> and <u>third_ld</u> indexers.  The
              file format is simply one line per suffix and supports commenting out lines with <b>#</b>.  You  can  use
              <b>dsc-psl-convert</b>  to convert the Public Suffix List to this format, see <u><a href="../man5/dsc-psl-convert.5.html">dsc-psl-convert</a></u>(5) for more
              information and examples on how to setup.

</pre><h4><b>DATASETS</b></h4><pre>
       A <b>dataset</b> is a 2-D array of counters.  For example, you might have a dataset with “Query Type” along  one
       dimension  and  “Query  Name  Length” on the other.  The result is a table that shows the distribution of
       query name lengths for each query type.

       A dataset has the following format:

       <b>datasets</b> NAME TYPE LABEL:FIRST LABEL:SECOND FILTERS [ PARAMETERS ] ;

       <b>NAME</b>   The name of the dataset, this must be unique and is used in the filename for the output files.

       <b>TYPE</b>   The protocol layer, available layers are:
                  ip
                  dns

       <b>LABEL</b>  The label of the dimensions.

       <b>FIRST</b>  The indexer for the first dimension, see INDEXERS sections.

       <b>SECOND</b> The indexer for the second dimension, see INDEXERS sections.

       <b>FILTERS</b>
              One or more filters, see FILTERS sections.

       <b>PARAMETERS</b>
              Zero or more parameters, see section PARAMETERS.

</pre><h4><b>INDEXERS</b> <b>AND</b> <b>FILTERS</b></h4><pre>
       An <u>indexer</u> is simply a function that transforms the attributes of an IP/DNS message into an array  index.
       For  some attributes the transformation is straightforward.  For example, the “Query Type” indexer simply
       extracts the query type value from a DNS message and uses this 16-bit value as the array index.

       Other attributes are slightly more complicated.  For example, the “TLD” indexer extracts the TLD  of  the
       QNAME field of a DNS message and maps it to an integer.  The indexer maintains a simple internal table of
       TLD-to-integer  mappings.   The  actual  integer  values are unimportant because the TLD strings, not the
       integers, appear in the resulting data.

       When you specify an indexer on a <b>dataset</b> line, you must provide both the name of the indexer and a label.
       The Label appears as an attribute in the output.

       For example the following line:

           dataset the_dataset dns Foo:foo Bar:bar queries-only;

       Would produce the following XML output:

           &lt;array name="the_dataset" dimensions="2" start_time="1091663940" ...
             &lt;dimension number="1" type="Foo"/&gt;
             &lt;dimension number="2" type="Bar"/&gt;
             &lt;data&gt;
               &lt;Foo val="1"&gt;
                 &lt;Bar val="0" count="4"/&gt;
                 ...
                 &lt;Bar val="100" count="41"/&gt;
               &lt;/Foo&gt;
               &lt;Foo val="2"&gt;
                 ...
               &lt;/Foo&gt;
             &lt;/data&gt;
           &lt;/array&gt;

</pre><h4><b>IP</b> <b>INDEXERS</b></h4><pre>
       <u>dsc</u> includes only minimal support for collecting IP-layer stats.  Mostly we are interested in finding out
       the mix of IP protocols received by the DNS server.  It can also show us if/when the DNS  server  is  the
       subject of denial-of-service attack.

       <b>ip_direction</b>
              One  of  three  values:  <b>sent</b>,  <b>recv</b>  or  <b>else</b>.   Direction is determined based on the setting for
              <b>local_address</b> in the configuration file.

       <b>ip_proto</b>
              The IP protocol type, e.g.: <b>tcp</b>, <b>udp</b> or <b>icmp</b>.  Note  that  the  <b>bpf_program</b>  setting  affects  all
              traffic  seen.   If  the program contains the word “udp” then you won't see any counts for non-UDP
              traffic.

       <b>ip_version</b>
              The IP version number, e.g.: <b>4</b> or <b>6</b>.  Can be used to compare how much traffic comes  in  via  IPv6
              compared to IPv4.

</pre><h4><b>IP</b> <b>FILTERS</b></h4><pre>
       Currently there is only one IP protocol filter: <b>any</b>.  It includes all received packets.

</pre><h4><b>DNS</b> <b>INDEXERS</b></h4><pre>
       <b>certain_qnames</b>
              This  indexer  isolates  the  two most popular query names seen by DNS root servers: <u>localhost</u> and
              <u>[a--m].root-servers.net</u>.

       <b>client_subnet</b>
              Groups DNS messages together by the subnet of the client's IP address.  The subnet  is  masked  by
              /24  for  IPv4  and  by  /96  for  IPv6.   We use this to make datasets with large, diverse client
              populations more manageable and to provide a small amount of privacy and anonymization.

       <b>client</b> The IP (v4 and v6) address of the DNS client.

       <b>server</b> The IP (v4 and v6) address of the DNS server.

       <b>country</b>
              The country code of the IP (v4 and v6), see section GEOIP.

       <b>asn</b>    The AS (autonomous system) number of the IP (v4 and v6), see section GEOIP.

       <b>do_bit</b> This indexer has only two values: 0 or 1.  It indicates whether or not the “DO” bit is  set  in  a
              DNS  query.   According  to RFC 2335: <u>Setting</u> <u>the</u> <u>DO</u> <u>bit</u> <u>to</u> <u>one</u> <u>in</u> <u>a</u> <u>query</u> <u>indicates</u> <u>to</u> <u>the</u> <u>server</u>
              <u>that</u> <u>the</u> <u>resolver</u> <u>is</u> <u>able</u> <u>to</u> <u>accept</u> <u>DNSSEC</u> <u>security</u> <u>RRs.</u>

       <b>edns_version</b>
              The EDNS version number, if any, in a DNS query.  EDNS Version 0 is documented in RFC 2671.

       <b>edns_bufsiz</b>
              The EDNS buffer size per 512 chunks (0-511, 512-1023 etc).

       <b>edns_cookie</b>
              Indicates whether or not a <a href="../man0/EDNS.0.html">EDNS</a>(0) Cookie (RFC7873) was present with "yes" or "no".

       <b>edns_cookie_len</b>
              The combined length of the <a href="../man0/EDNS.0.html">EDNS</a>(0) client and server cookies.

       <b>edns_cookie_client</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Cookie bytes as a hexadecimal string.

       <b>edns_cookie_server</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Server Cookie bytes as a hexadecimal string.

       <b>edns_ecs</b>
              Indicates whether or not a <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Subnet (RFC7871) was present with "yes" or "no".

       <b>edns_ecs_family</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Subnet address family.

       <b>edns_ecs_source_prefix</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Subnet source prefix-length.

       <b>edns_ecs_scope_prefix</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Subnet scope prefix-length.

       <b>edns_ecs_address</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Subnet address bytes as a hexadecimal string.

       <b>edns_ecs_subnet</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Subnet address as an IPv4/IPv6 textual address.

       <b>edns_ede</b>
              Indicates whether or not a <a href="../man0/EDNS.0.html">EDNS</a>(0) Extended DNS Errors (RFC8914) was present with "yes" or "no".

       <b>edns_ede_code</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Extended DNS Errors code.

       <b>edns_ede_textlen</b>
              The length of the <a href="../man0/EDNS.0.html">EDNS</a>(0) Extended DNS Errors extra-text.

       <b>edns_ede_text</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) Extended DNS Errors extra-text.

       <b>edns_nsid</b>
              Indicates whether or not a <a href="../man0/EDNS.0.html">EDNS</a>(0) DNS Name Server Identifier (RFC5001) was present with "yes"  or
              "no".

       <b>edns_nsid_len</b>
              The length of the <a href="../man0/EDNS.0.html">EDNS</a>(0) DNS Name Server Identifier (NSID).

       <b>edns_nsid_data</b>
              The <a href="../man0/EDNS.0.html">EDNS</a>(0) DNS Name Server Identifier (NSID) bytes as a hexadecimal string.

       <b>edns_nsid_text</b>
              The  <a href="../man0/EDNS.0.html">EDNS</a>(0)  DNS  Name Server Identifier (NSID) as a string of printable characters.  Unprintable
              characters are replaced with ".".

       <b>idn_qname</b>
              This indexer has only two values: 0 or 1.  It returns 1 when the first QNAME in  the  DNS  message
              question  section  is  an  internationalized  domain name (i.e., containing non-ASCII characters).
              Such QNAMEs begin with the string <u>xn--</u>.  This convention is documented in RFC 3490.

       <b>msglen</b> The overall length (size) of the DNS message.

       <b>null</b>   A “no-op” indexer that always returns the same value.  This can be used to  effectively  turn  the
              2-D table into a 1-D array.

       <b>opcode</b> The  DNS  message  opcode  is  a  four-bit  field.   QUERY  is the most common opcode.  Additional
              currently defined opcodes include: IQUERY, STATUS, NOTIFY, and UPDATE.

       <b>qclass</b> The DNS message query class (QCLASS) is a 16-bit value.   IN  is  the  most  common  query  class.
              Additional currently defined query class values include: CHAOS, HS, NONE, and ANY.

       <b>qname</b>  The  full  QNAME  string  from the first (and usually only) QNAME in the question section of a DNS
              message.

       <b>qnamelen</b>
              The length of the first (and usually only) QNAME in a DNS message question section.  Note this  is
              the “expanded” length if the message happens to take advantage of DNS message “compression”.

       <b>label_count</b>
              The  number  of  labels  (between "." dots) in the first (and usually only) QNAME in a DNS message
              question section.  Note that a value of 0 (zero) means DNS root (.).

       <b>qtype</b>  The query type (QTYPE) for the first QNAME in the DNS message question section.  Well-known  query
              types include: A, AAAA, A6, CNAME, PTR, MX, NS, SOA, and ANY.

       <b>query_classification</b>
              A stateless classification of “bogus” queries:

              non-auth-tld
                     When the TLD is not one of the IANA-approved TLDs.

              root-servers.net
                     A query for a root server IP address.

              localhost
                     A query for the localhost IP address.

              a-for-root
                     An “A” query for the DNS root (.).

              a-for-a
                     An “A” query for an IPv4 address.

              rfc1918-ptr
                     A PTR query for an RFC 1918 address.

              funny-class
                     A query with an unknown/undefined query class.

              funny-qtype
                     A query with an unknown/undefined query type.

              src-port-zero
                     When the UDP message's source port equals zero.

              malformed
                     A malformed DNS message that could not be entirely parsed.

       <b>rcode</b>  The  RCODE  value  in  a  DNS  response.   The  most  common response codes are 0 (NO ERROR) and 3
              (NXDOMAIN).

       <b>rd_bit</b> This indexer returns 1 if the RD (recursion desired) bit is set in the query.  Usually  only  stub
              resolvers set the RD bit.  Usually authoritative servers do not offer recursion to their clients.

       <b>tc_bit</b> This  indexer returns 1 if the TC (truncated) bit is set (in a response).  An authoritative server
              sets the TC bit when the entire response won't fit into a UDP message.

       <b>tld</b>    The TLD of the first QNAME in a DNS message's question section.

       <b>second_ld</b>
              The Second LD of the first QNAME in a DNS message's question section.

       <b>third_ld</b>
              The Third LD of the first QNAME in a DNS message's question section.

       <b>transport</b>
              Indicates whether the DNS message is carried via UDP or TCP.

       <b>dns_ip_version</b>
              The IP version number that carried the DNS message.

       <b>dns_source_port</b>
              The source port of the DNS message.

       <b>dns_sport_range</b>
              The source port of the DNS message per 1024 chunks (0-1023, 1024-2047 etc).

       <b>qr_aa_bits</b>
              The "qr_aa_bits" dataset may be useful when <b>dsc</b> is monitoring an authoritative name server.   This
              dataset  counts the number of DNS messages received with each combination of QR,AA bits.  Normally
              the authoritative name server should *receive* only *queries*.  If the name server is  the  target
              of a DNS reflection attack, it will probably receive DNS *responses* which have the QR bit set.

       <b>response_time</b>
              An indexer to track queries and return the response time in buckets along with other state buckets
              for timeouts, missing queries (received a response but have never seen the query), dropped queries
              (due  to  memory  limitations)  and  internal  errors.   Queries  are matched against responses by
              checking (in this order) the DNS ID, the IP version and protocol, client IP, client  port,  server
              IP  and  last  server  port.   There  are a few configuration options to control how response time
              statistics are gathered and handled, please see CONFIGURATION.  NOTE: Only one  instance  of  this
              indexer can be used in a dataset, this is due to the state to stores and the design of DSC.

       <b>encryption</b>
              Indicates  whether the DNS message was carried over an encrypted connection or not, and if so over
              which.  For example "unencrypted", "dot" (DNS-over-TLS), "doh" (DNS-over-HTTPS).  This information
              is only available via DNSTAP and if supported by the software generating it.

</pre><h4><b>DNS</b> <b>FILTERS</b></h4><pre>
       You must specify one or more of the following filters (separated by commas) on the  <b>dataset</b>  line.   Note
       that multiple filters are <u>AND</u>ed together.  That is, they narrow the input stream, rather than broaden it.

       <b>any</b>    The no-op filter, counts all messages.

       <b>queries-only</b>
              Count only DNS query messages.  A query is a DNS message where the QR bit is set to 0.

       <b>replies-only</b>
              Count only DNS response messages.  A response is a DNS message where the QR bit is set to 1.

       <b>nxdomains-only</b>
              Count only NXDOMAIN responses.

       <b>popular-qtypes</b>
              Count only DNS messages where the query type is one of: A, NS, CNAME, SOA, PTR, MX, AAAA, A6, ANY.

       <b>idn-only</b>
              Count only DNS messages where the query name is in the internationalized domain name format.

       <b>aaaa-or-a6-only</b>
              Count only DNS messages where the query type is AAAA or A6.

       <b>root-servers-net-only</b>
              Count only DNS messages where the query name is within the <u>root-servers.net</u> domain.

       <b>chaos-class</b>
              Counts  only  DNS  messages where QCLASS is equal to CHAOS (3).  The CHAOS class is generally used
              for only the special <u>hostname.bind</u> and <u>version.bind</u> queries.

       <b>priming-query</b>
              Count only DNS messages where the query type is NS and QNAME is “.”.

       <b>servfail-only</b>
              Count only SERVFAIL responses.

       <b>authentic-data-only</b>
              Count only DNS messages with the AD bit is set.

       <b>edns0-only</b>
              Count only DNS messages with <a href="../man0/EDNS.0.html">EDNS</a>(0) options.

       <b>edns0-cookie-only</b>
              Count only DNS messages with <a href="../man0/EDNS.0.html">EDNS</a>(0) Cookie option.

       <b>edns0-nsid-only</b>
              Count only DNS messages with <a href="../man0/EDNS.0.html">EDNS</a>(0) DNS Name Server Identifier option.

       <b>edns0-ede-only</b>
              Count only DNS messages with <a href="../man0/EDNS.0.html">EDNS</a>(0) Extended DNS Errors option.

       <b>edns0-ecs-only</b>
              Count only DNS messages with <a href="../man0/EDNS.0.html">EDNS</a>(0) Client Subnet option.

</pre><h4><b>QNAME</b> <b>FILTERS</b></h4><pre>
       Defines a custom QNAME-based filter for DNS messages.  If you refer to this named  filter  on  a  dataset
       line,  then only queries or replies for matching QNAMEs will be counted.  The QNAME argument is a regular
       expression.  For example:

           qname_filter WWW-Only ^www. ;
           dataset qtype dns All:null Qtype:qtype queries-only,WWW-Only ;

</pre><h4><b>PARAMETERS</b></h4><pre>
       <u>dsc</u> currently supports the following optional parameters:

       <b>min-count</b>=NN
              Cells with counts less than <b>NN</b> are not included in the output.  Instead, they are aggregated  into
              the special values <u>-:SKIPPED:-</u> and <u>-:SKIPPED_SUM:-</u>.  This helps reduce the size of datasets with a
              large number of small counts.

       <b>max-cells</b>=NN
              A  different,  perhaps  better,  way  of  limiting  the  size  of a dataset.  Instead of trying to
              determine an appropriate <b>min-count</b> value in advance, <b>max-cells</b> allows  you  put  a  limit  on  the
              number of cells to include for the second dataset dimension.  If the dataset has 9 possible first-
              dimension  values,  and  you  specify a <b>max-cell</b> count of 100, then the dataset will not have more
              than 900 total values.  The cell values are sorted and the top <b>max-cell</b> values are output.  Values
              that fall below the limit are aggregated into the special <u>-:SKIPPED:-</u> and <u>-:SKIPPED_SUM:-</u> entries.

</pre><h4><b>FILE</b> <b>NAMING</b> <b>CONVENTIONS</b></h4><pre>
       The filename is in the format:
           ${timestamp}.dscdata.${format}

       For example:
           1154649660.dscdata.xml

</pre><h4><b>DATA</b> <b>FORMATS</b></h4><pre>
       <b>XML</b>    A dataset XML file has the following structure:

       &lt;array name="dataset-name" dimensions="2" start_time="unix-seconds"
               stop_time="unix-seconds"&gt;
         &lt;dimension number="1" type="Label1"/&gt;
         &lt;dimension number="2" type="Label2"/&gt;
         &lt;data&gt;
           &lt;Label1 val="D1-V1"&gt;
             &lt;Label2 val="D2-V1" count="N1"/&gt;
             &lt;Label2 val="D2-V2" count="N2"/&gt;
             &lt;Label2 val="D2-V3" count="N3"/&gt;
           &lt;/Label1&gt;
           &lt;Label1 val="D1-V2"&gt;
             &lt;Label2 val="D2-V1" count="N1"/&gt;
             &lt;Label2 val="D2-V2" count="N2"/&gt;
             &lt;Label2 val="D2-V3" count="N3"/&gt;
           &lt;/Label1&gt;
         &lt;/data&gt;
       &lt;/array&gt;

       <b>JSON</b>   A dataset JSON file has the following structure:

       {
         "name": "dataset-name",
         "start_time": unix-seconds,
         "stop_time": unix-seconds,
         "dimensions": [ "Label1", "Label2" ],
         "data": [
           {
             "Label1": "D1-V1",
             "Label2": [
               { "val": "D2-V1", "count": N1 },
               { "val": "D2-V2", "count": N2 },
               { "val": "D2-V3", "count": N3 }
             ]
           },
           {
             "Label1": "D1-V2-base64",
             "base64": true,
             "Label2": [
               { "val": "D2-V1", "count": N1 },
               { "val": "D2-V2-base64", "base64": true, "count": N2 },
               { "val": "D2-V3", "count": N3 }
             ]
           }
         ]
       }

       <b>dataset-name</b>, <b>Label1</b>, and <b>Label2</b> come from the dataset definition.

       The <b>start_time</b> and <b>stop_time</b> attributes are given in Unix seconds.  They are normally  60-seconds  apart.
       <u>dsc</u> usually starts a new measurement interval on 60 second boundaries.  That is:

           stop_time mod{60} == 0

       The  <b>Label1</b>  attributes (<u>D1-V1</u>, <u>D1-V2</u>) are values for the first dimension indexer.  Similarly, the <b>Label2</b>
       attributes (<u>D2-V1</u>, <u>D2-V2</u> <u>D2-V3</u>) are values for the second dimension indexer.   For  some  indexers  these
       values are numeric, for others they are strings.  If the value contains certain non-printable characters,
       the string is base64-encoded and the optional BASE64 attribute is set to 1/true.

       There  are  two  special  <b>val</b>s  that  help keep large datasets down to a reasonable size: <u>-:SKIPPED:-</u> and
       <u>-:SKIPPED_SUM:-</u>.  These may be present on datasets that use the <u>min-count</u> and <u>max-cells</u>  parameters  (see
       section  PARAMETERS).   <u>-:SKIPPED:-</u>  is  the  number  of  cells  that  were  not  included in the output.
       <u>-:SKIPPED_SUM:-</u>, is the sum of the counts for all the skipped cells.

       Note that “one-dimensional datasets” still use two dimensions in the output.  The  first  dimension  type
       and value will be “All” as shown in the example below:

           &lt;array name="rcode" dimensions="2" start_time="1154649600"
                   stop_time="1154649660"&gt;
             &lt;dimension number="1" type="All"/&gt;
             &lt;dimension number="2" type="Rcode"/&gt;
             &lt;data&gt;
               &lt;All val="ALL"&gt;
                 &lt;Rcode val="0" count="70945"/&gt;
                 &lt;Rcode val="3" count="50586"/&gt;
                 &lt;Rcode val="4" count="121"/&gt;
                 &lt;Rcode val="1" count="56"/&gt;
                 &lt;Rcode val="5" count="44"/&gt;
               &lt;/All&gt;
             &lt;/data&gt;
           &lt;/array&gt;

       The  <b>count</b>  values  are  always  integers.  If the count for a particular tuple is zero, it should not be
       included in the output.

       Note that the contents of the output do not indicate where it came from.  In particular, the  server  and
       node that it came from are not present.

</pre><h4><b>GEOIP</b></h4><pre>
       Country  code  and  AS number lookup is available using MaxMind GeoIP Legacy API if it was enabled during
       compilation.

       Multiple options can be give to the database and are directly linked to the options for <u>GeoIP_open()</u>  but
       without the prefix of <b>GEOIP_</b>, example:

           geoip_v4_dat "/usr/local/share/GeoIP/GeoIP.dat" STANDARD MEMORY_CACHE;
           geoip_asn_v6_dat "/usr/local/share/GeoIP/GeoIPASNumv6.dat" MEMORY_CACHE;

       GeoIP documentation says:

       <b>STANDARD</b>
              Read database from file system.  This uses the least memory.

       <b>MEMORY_CACHE</b>
              Load database into memory.  Provides faster performance but uses more memory.

       <b>CHECK_CACHE</b>
              Check for updated database.  If database has been updated, reload file handle and/or memory cache.

       <b>INDEX_CACHE</b>
              Cache  only  the  the  most frequently accessed index portion of the database, resulting in faster
              lookups than GEOIP_STANDARD, but less memory usage than GEOIP_MEMORY_CACHE.  This  is  useful  for
              larger  databases such as GeoIP Legacy Organization and GeoIP Legacy City.  Note: for GeoIP Legacy
              Country, Region and Netspeed databases, GEOIP_INDEX_CACHE is equivalent to GEOIP_MEMORY_CACHE.

       <b>MMAP_CACHE</b>
              Load database into mmap shared memory.  MMAP is not available for 32bit Windows.

</pre><h4><b>EXAMPLE</b></h4><pre>
       local_address 127.0.0.1;
       local_address ::1;
       #local_address 127.0.0.0 255.0.0.0;
       #local_address 192.168.0.0 24;
       #local_address 10.0.0.0 8;

       run_dir "/var/lib/dsc";

       minfree_bytes 5000000;

       pid_file "/run/dsc.pid";

       # Example filters
       #
       #bpf_program "udp port 53";
       #bpf_program "tcp port 53 or udp port 53";

       # Use this to see only DNS *queries*
       #
       #bpf_program "udp dst port 53 and udp[10:2] &amp; 0x8000 = 0";

       #dns_port 53;
       #pcap_buffer_size 4194304;
       #pcap_thread_timeout 100;
       #drop_ip_fragments;
       interface eth0;
       #interface any;

       #dnstap_file /path/to/file.dnstap;
       #dnstap_unixsock /path/to/unix.sock;
       #dnstap_tcp 127.0.0.1 5353;
       #dnstap_udp 127.0.0.1 5353;
       #dnstap_network 127.0.0.1 ::1 53;

       dataset qtype dns All:null Qtype:qtype queries-only;
       dataset rcode dns All:null Rcode:rcode replies-only;
       dataset opcode dns All:null Opcode:opcode queries-only;
       dataset rcode_vs_replylen dns Rcode:rcode ReplyLen:msglen replies-only;
       dataset client_subnet dns All:null ClientSubnet:client_subnet queries-only max-cells=200;
       dataset qtype_vs_qnamelen dns Qtype:qtype QnameLen:qnamelen queries-only;
       dataset qtype_vs_tld dns Qtype:qtype TLD:tld queries-only,popular-qtypes max-cells=200;
       dataset certain_qnames_vs_qtype dns CertainQnames:certain_qnames Qtype:qtype queries-only;
       dataset client_subnet2 dns Class:query_classification ClientSubnet:client_subnet queries-only max-cells=200;
       dataset client_addr_vs_rcode dns Rcode:rcode ClientAddr:client replies-only max-cells=50;
       dataset chaos_types_and_names dns Qtype:qtype Qname:qname chaos-class,queries-only;
       #dataset country_code dns All:null CountryCode:country queries-only;
       #dataset asn_all dns IPVersion:dns_ip_version ASN:asn queries-only max-cells=200;
       dataset idn_qname dns All:null IDNQname:idn_qname queries-only;
       dataset edns_version dns All:null EDNSVersion:edns_version queries-only;
       dataset edns_bufsiz dns All:null EDNSBufSiz:edns_bufsiz queries-only;
       dataset do_bit dns All:null D0:do_bit queries-only;
       dataset rd_bit dns All:null RD:rd_bit queries-only;
       dataset idn_vs_tld dns All:null TLD:tld queries-only,idn-only;
       dataset ipv6_rsn_abusers dns All:null ClientAddr:client queries-only,aaaa-or-a6-only,root-servers-net-only max-cells=50;
       dataset transport_vs_qtype dns Transport:transport Qtype:qtype queries-only;
       dataset client_port_range dns All:null PortRange:dns_sport_range queries-only;
       #dataset second_ld_vs_rcode dns Rcode:rcode SecondLD:second_ld replies-only max-cells=50;
       #dataset third_ld_vs_rcode dns Rcode:rcode ThirdLD:third_ld replies-only max-cells=50;
       dataset direction_vs_ipproto ip Direction:ip_direction IPProto:ip_proto any;
       #dataset dns_ip_version_vs_qtype dns IPVersion:dns_ip_version Qtype:qtype queries-only;
       #dataset response_time dns All:null ResponseTime:response_time;
       #dataset priming_queries dns Transport:transport EDNSBufSiz:edns_bufsiz priming-query,queries-only;
       #dataset priming_responses dns All:null ReplyLen:msglen priming-query,replies-only;
       #dataset qr_aa_bits dns Direction:ip_direction QRAABits:qr_aa_bits any;
       #dataset servfail_qname dns ALL:null Qname:qname servfail-only,replies-only;
       #dataset ad_qname dns ALL:null Qname:qname authentic-data-only,replies-only;
       #dataset label_count dns All:null LabelCount:label_count any;
       #dataset encryption dns All:null Encryption:encryption queries-only;

       #statistics_interval 60;
       #no_wait_interval;
       output_format XML;
       #output_format JSON;
       #output_user root;
       #output_group root;
       #output_mod 0664;

       #geoip_v4_dat "/usr/share/GeoIP/GeoIP.dat" STANDARD MEMORY_CACHE MMAP_CACHE;
       #geoip_v6_dat "/usr/share/GeoIP/GeoIPv6.dat";
       #geoip_asn_v4_dat "/usr/share/GeoIP/GeoIPASNum.dat" MEMORY_CACHE;
       #geoip_asn_v6_dat "/usr/share/GeoIP/GeoIPASNumv6.dat" MEMORY_CACHE;

       #asn_indexer_backend geoip;
       #country_indexer_backend geoip;
       #maxminddb_asn "/path/to/GeoLite2/ASN.mmdb";
       #maxminddb_country "/path/to/GeoLite2/Country.mmdb";

       #client_v4_mask 255.255.255.0;
       #client_v6_mask ffff:ffff:ffff:ffff:ffff:ffff:0000:0000;

       #response_time_mode log10;
       #response_time_max_queries 1000000;
       #response_time_full_mode drop_query;
       #response_time_max_seconds 5;
       #response_time_max_sec_mode ceil;
       #response_time_bucket_size 100;

       #knowntlds_file file;

</pre><h4><b>FILES</b></h4><pre>
       /etc/dsc/dsc.conf
       /etc/dsc/dsc.conf.sample

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <a href="../man1/dsc.1.html">dsc</a>(1), <a href="../man1/dsc-psl-convert.1.html">dsc-psl-convert</a>(1)

</pre><h4><b>AUTHORS</b></h4><pre>
       Jerry Lundström, DNS-OARC
       Duane Wessels, Measurement Factory / Verisign
       Ken Keys, Cooperative Association for Internet Data Analysis
       Sebastian Castro, New Zealand Registry Services

       Maintained by DNS-OARC

              <u>https://www.dns-oarc.net/tools/dsc</u>

</pre><h4><b>BUGS</b></h4><pre>
       For issues and feature requests please use:

              <u>https://github.com/DNS-OARC/dsc/issues</u>

       For question and help please use:

              <u><a href="mailto:dsc@dns-oarc.net">dsc@dns-oarc.net</a></u>

DNS Statistics Collector                             2.15.2                                          <u><a href="../man5/dsc.conf.5.html">dsc.conf</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>