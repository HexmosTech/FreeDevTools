<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xinetd.conf - Extended Internet Services Daemon configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/xinetd">xinetd_2.3.15.4-6_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       xinetd.conf - Extended Internet Services Daemon configuration file

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>xinetd.conf</b>  is  the  configuration file that determines the services provided by <b>xinetd</b>.  Any line whose
       first non-white-space character is a '#' is considered a comment line. Empty lines are ignored.

       The file contains entries of the form:

              <b>service</b> <b>&lt;service_name&gt;</b>
              <b>{</b>
                     <b>&lt;attribute&gt;</b> <b>&lt;assign_op&gt;</b> <b>&lt;value&gt;</b> <b>&lt;value&gt;</b> <b>...</b>
                     <u>...</u>
              }

       The assignment operator, <u>assign_op,</u> can be one of <b>'=',</b> <b>'+=',</b> <b>'-='.</b>  The majority  of  attributes  support
       only  the  simple  assignment  operator,  <b>'='.</b>   Attributes  whose  value  is a set of values support all
       assignment operators.  For such attributes, <b>'+='</b> means adding a value to the set and <b>'-='</b> means  removing
       a value from the set.  A list of these attributes will be given after all the attributes are described.

       Each  entry  defines  a  service  identified  by  the <u>service_name</u>.  The following is a list of available
       attributes:

       <b>id</b>               This attribute is used to uniquely identify a service.  This  is  useful  because  there
                        exist  services that can use different protocols and need to be described with different
                        entries in the configuration file.  By default, the  service  id  is  the  same  as  the
                        service name.

       <b>type</b>             Any combination of the following values may be used:

                        <b>RPC</b>         if this is an RPC service

                        <b>INTERNAL</b>    if this is a service provided by <b>xinetd</b>.

                        <b>TCPMUX/TCPMUXPLUS</b>
                                    if this is a service that will be started according to the RFC 1078 protocol
                                    on  the  TCPMUX  well-known port. See the section describing TCPMUX services
                                    below.

                        <b>UNLISTED</b>    if this is a service not listed in a standard system file (like <u><a href="file:/etc/rpc">/etc/rpc</a></u> for
                                    RPC services, or <u><a href="file:/etc/services">/etc/services</a></u> for non-RPC services).

       <b>flags</b>            Any combination of the following flags may be used:

                        <b>INTERCEPT</b>   Intercept packets or accepted connections in order to verify that  they  are
                                    coming from acceptable locations (internal or multi-threaded services cannot
                                    be intercepted).

                        <b>NORETRY</b>     Avoid retry attempts in case of fork failure.

                        <b>IDONLY</b>      Accept connections only when the remote end identifies the remote user (i.e.
                                    the  remote host must run an identification server).  This flag applies only
                                    to connection-based services.  This flag is ineffective if  the  <b>USERID</b>  log
                                    option is not used.

                        <b>NAMEINARGS</b>  This  will  cause  the  first  argument  in "server_args" to be argv[0] when
                                    executing the server, as specified in "server".  This allows you to use tcpd
                                    by putting tcpd in "server" and the name of the server in "server_args" like
                                    in normal inetd.

                        <b>NODELAY</b>     If the service is a tcp service and  the  NODELAY  flag  is  set,  then  the
                                    TCP_NODELAY  flag  will  be  set on the socket.  If the service is not a tcp
                                    service, this option has no effect.

                        <b>KEEPALIVE</b>   If the service is a tcp service and the KEEPALIVE  flag  is  set,  then  the
                                    SO_KEEPALIVE socket flag will be set on the socket.  If the service is not a
                                    tcp service, this option has no effect.

                        <b>NOLIBWRAP</b>   This disables internal calling of the tcpwrap library to determine access to
                                    the  service.   This may be needed in order to use libwrap functionality not
                                    available to long-running processes such as xinetd; in this case,  the  tcpd
                                    program  can  be  called explicitly (see also the NAMEINARGS flag).  For RPC
                                    services using TCP transport, this flag is automatically turned on,  because
                                    xinetd cannot get remote host address information for the rpc port.

                        <b>SENSOR</b>      This  replaces  the  service  with  a  sensor  that  detects accesses to the
                                    specified port. NOTE: It will NOT detect stealth scans. This flag should  be
                                    used  only  on services that you know you don't need. When an access is made
                                    to this service's port, the IP Address is added to a global no_access  list.
                                    This  causes  all  subsequent accesses from the originating IP address to be
                                    denied access until the deny_time setting expires. The amount of time  spent
                                    on  this  list  is  configurable as the deny_time attribute. The SENSOR flag
                                    will also cause xinetd to consider the server attribute to  be  INTERNAL  no
                                    matter  what  is typed on the same line. Another important thing to remember
                                    is that if the socket_type is set to stream, then the wait attribute  should
                                    be set to no.

                        <b>IPv4</b>        Sets the service to be an IPv4 service (AF_INET).

                        <b>IPv6</b>        Sets  the  service to be an IPv6 service (AF_INET6), if IPv6 is available on
                                    the system.

                        <b>LABELED</b>     The LABELED flag will tell xinetd to change the  child  processes  SE  Linux
                                    context  to  match that of the incoming connection as it starts the service.
                                    This only works for external tcp non-waiting servers  and  is  an  error  if
                                    applied to an internal, udp, or tcp-wait server.

                        <b>REUSE</b>       The  REUSE  flag  is  deprecated.  All services now implicitly use the REUSE
                                    flag.

       <b>v6only</b>           This is boolean "yes" or "no".  This will  result  in  a  service  accepting  only  IPv6
                        connections,  instead  of  both IPv6 and IPv4 connections.  The default is determined by
                        the "bindv6only" kernel variable.

       <b>disable</b>          This is boolean "yes" or "no".  This will result in the service being disabled  and  not
                        starting.

       <b>socket_type</b>      Possible values for this attribute include:

                        <u>stream</u>      stream-based service

                        <u>dgram</u>       datagram-based service

                        <u>raw</u>         service that requires direct access to IP

                        <u>seqpacket</u>   service that requires reliable sequential datagram transmission

       <b>protocol</b>         determines  the  protocol  that  is employed by the service.  The protocol must exist in
                        <u>/etc/protocols.</u>  If this attribute is not defined, the default protocol employed by  the
                        service will be used.

       <b>wait</b>             This  attribute  determines  if  the  service  is  single-threaded or multi-threaded and
                        whether or not  xinetd  accepts  the  connection  or  the  server  program  accepts  the
                        connection.  If its value is <u>yes</u>, the service is single-threaded; this means that <b>xinetd</b>
                        will start the server and then it will stop handling requests for the service until  the
                        server  dies  and  that the server software will accept the connection. If the attribute
                        value is <u>no</u>, the service is multi-threaded and <b>xinetd</b> will  keep  handling  new  service
                        requests  and  xinetd  will  accept  the  connection.  It should be noted that udp/dgram
                        services normally expect the value to be yes since udp is not connection oriented, while
                        tcp/stream servers normally expect the value to be no.

       <b>user</b>             determines the uid for the server process. The user attribute can either be numeric or a
                        name. If a name is given (recommended),  the user name must exist in <u>/etc/passwd.</u>   This
                        attribute is ineffective if the effective user ID of <b>xinetd</b> is not super-user.

       <b>group</b>            determines  the gid for the server process. The group attribute can either be numeric or
                        a name. If a name is given (recommended), the group name must exist in <u>/etc/group.</u>  If a
                        group is not specified, the group  of  <u>user</u>  will  be  used  (from  <u><a href="file:/etc/passwd">/etc/passwd</a>).</u>   This
                        attribute is ineffective if the effective user ID of <b>xinetd</b> is not super-user and if the
                        <b>groups</b> attribute is not set to 'yes'.

       <b>instances</b>        determines  the  number  of servers that can be simultaneously active for a service (the
                        default is no limit). The value of this attribute can be either a  number  or  <b>UNLIMITED</b>
                        which means that there is no limit.

       <b>nice</b>             determines the server priority. Its value is a (possibly negative) number; check <a href="../man3/nice.3.html">nice</a>(3)
                        for more information.

       <b>server</b>           determines the program to execute for this service.

       <b>server_args</b>      determines  the  arguments  passed  to the server. In contrast to <b>inetd</b>, the server name
                        should <u>not</u> be included in <u>server_args</u>.

       <b>libwrap</b>          overrides the service name passed to libwrap (which defaults to  the  server  name,  the
                        first  server_args  component  with  NAMEINARGS,  the  id  for internal services and the
                        service name for redirected services).  This attribute is only valid if xinetd has  been
                        configured with the libwrap option.

       <b>only_from</b>        determines  the remote hosts to which the particular service is available.  Its value is
                        a list of IP addresses which can be specified in any combination of the following ways:

                        <b>a)</b>   a numeric address in the form of %d.%d.%d.%d. If the rightmost  components  are  0,
                             they  are  treated as wildcards (for example, 128.138.12.0 matches all hosts on the
                             128.138.12 subnet).  0.0.0.0 matches all Internet addresses.   IPv6  hosts  may  be
                             specified  in  the  form  of  abcd:ef01::2345:6789.   The  rightmost  rule for IPv4
                             addresses does not apply to IPv6 addresses.

                        <b>b)</b>   a factorized address in the form of %d.%d.%d.{%d,%d,...}.  There is no need for all
                             4 components (i.e. %d.%d.{%d,%d,...%d} is also ok).  However, the  factorized  part
                             must be at the end of the address.  This form does not work for IPv6 hosts.

                        <b>c)</b>   a network name (from <u><a href="file:/etc/networks">/etc/networks</a>).</u> <u>This</u> <u>form</u> <u>does</u> <u>not</u> <u>work</u> <u>for</u> <u>IPv6</u> <u>hosts.</u>

                        <b>d)</b>   a  host  name.  When a connection is made to xinetd, a reverse lookup is performed,
                             and the canonical name returned is compared to the specified host  name.   You  may
                             also  use  domain  names  in the form of .domain.com.  If the reverse lookup of the
                             client's IP is within .domain.com, a match occurs.

                        <b>e)</b>   an ip address/netmask range in the form of 1.2.3.4/32.  IPv6 address/netmask ranges
                             in the form of 1234::/46 are also valid.

                        Specifying this attribute without a value makes the service available to nobody.

       <b>no_access</b>        determines the remote hosts to which the particular service is  unavailable.  Its  value
                        can  be  specified  in  the  same way as the value of the <b>only_from</b> attribute. These two
                        attributes determine the location access control enforced by <b>xinetd</b>. If none of the  two
                        is  specified  for  a service, the service is available to anyone. If both are specified
                        for a service, the one that is the better match for  the  address  of  the  remote  host
                        determines  if the service is available to that host (for example, if the <b>only_from</b> list
                        contains 128.138.209.0 and the <b>no_access</b> list contains 128.138.209.10 then the host with
                        the address 128.138.209.10 can not access the service).

       <b>access_times</b>     determines the time intervals when the service is available. An interval  has  the  form
                        <u>hour:min-hour:min</u> (connections <u>will</u> be accepted at the bounds of an interval). Hours can
                        range from 0 to 23 and minutes from 0 to 59.

       <b>log_type</b>         determines where the service log output is sent. Select just one of the two formats:

                        <b>SYSLOG</b>  <u>syslog_facility</u> <u>[syslog_level]</u>
                               The  log  output  is  sent to syslog at the specified facility. Possible facility
                               names include: <u>daemon,</u> <u>auth,</u> <u>authpriv,</u> <u>user,</u> <u>mail,</u> <u>lpr,</u> <u>news,</u> <u>uucp,</u> <u>ftp</u> <u>local0-7.</u>
                               Possible level names include: <u>emerg,</u> <u>alert,</u> <u>crit,</u>  <u>err,</u>  <u>warning,</u>  <u>notice,</u>  <u>info,</u>
                               <u>debug.</u>   If  a  level  is  not present, the messages will be recorded at the <u>info</u>
                               level.

                        <b>FILE</b>  <u>file</u> <u>[soft_limit</u> <u>[hard_limit]]</u>
                               The log output is appended to <u>file</u> which will be created if it  does  not  exist.
                               Two  limits  on  the size of the log file can be optionally specified.  The first
                               limit is a soft one; <b>xinetd</b> will log a message  the  first  time  this  limit  is
                               exceeded  (if  <b>xinetd</b>  logs  to  syslog,  the  message  will be sent at the <u>alert</u>
                               priority level).  The second limit is a hard limit; <b>xinetd</b> will stop logging  for
                               the  affected  service  (if the log file is a common log file, then more than one
                               service may be affected) and will log a message about this  (if  <b>xinetd</b>  logs  to
                               syslog,  the  message will be sent at the <u>alert</u> priority level).  If a hard limit
                               is not specified, it defaults to the soft limit increased by  1%  but  the  extra
                               size  must be within the parameters LOG_EXTRA_MIN and LOG_EXTRA_MAX which default
                               to 5K and 20K respectively (these constants are defined in <u>xconfig.h</u>).

       <b>log_on_success</b>   determines what information is logged when a server is  started  and  when  that  server
                        exits  (the  service  id  is  always included in the log entry).  Any combination of the
                        following values may be specified:

                        <b>PID</b>         logs the server process id (if the service is implemented by <b>xinetd</b>  without
                                    forking another process the logged process id will be 0)

                        <b>HOST</b>        logs the remote host address

                        <b>USERID</b>      logs  the  user  id  of  the  remote  user using the RFC 1413 identification
                                    protocol.  This option is available only for multi-threaded stream services.

                        <b>EXIT</b>        logs the fact that a server  exited  along  with  the  exit  status  or  the
                                    termination signal (the process id is also logged if the <b>PID</b> option is used)

                        <b>DURATION</b>    logs the duration of a service session

                        <b>TRAFFIC</b>     logs the total bytes in and out for a redirected service.

       <b>log_on_failure</b>   determines what information is logged when a server cannot be started (either because of
                        a lack of resources or because of access control restrictions). The service id is always
                        included  in  the  log  entry along with the reason for failure.  Any combination of the
                        following values may be specified:

                        <b>HOST</b>        logs the remote host address.

                        <b>USERID</b>      logs the user id of the  remote  user  using  the  RFC  1413  identification
                                    protocol.  This option is available only for multi-threaded stream services.

                        <b>ATTEMPT</b>     logs  the fact that a failed attempt was made (this option is implied by all
                                    others).

       <b>rpc_version</b>      determines the RPC version for a RPC service. The version can be a single  number  or  a
                        range in the form <u>number</u>-<u>number</u>.

       <b>rpc_number</b>       determines  the  number  for  an  <u>UNLISTED</u> RPC service (this attribute is ignored if the
                        service is not unlisted).

       <b>env</b>              The value of this attribute is a list  of  strings  of  the  form  'name=value'.   These
                        strings  will  be  added  to  the  environment  before  starting a server (therefore the
                        server's environment will include <b>xinetd</b>'s environment plus the specified strings).

       <b>passenv</b>          The value of this attribute is a list of environment variables from <b>xinetd</b>'s environment
                        that will be passed to the server.  An empty list implies passing no  variables  to  the
                        server  except  for  those explicitly defined using the <u>env</u> attribute.  (notice that you
                        can use this attribute in conjunction with the <u>env</u> attribute  to  specify  exactly  what
                        environment will be passed to the server).

       <b>port</b>             determines  the  service  port.  If  this attribute is specified for a service listed in
                        <u><a href="file:/etc/services">/etc/services</a>,</u> it must be equal to the port number listed in that file.

       <b>redirect</b>         Allows a tcp service to be redirected to another  host.   When  xinetd  receives  a  tcp
                        connection  on  this  port it spawns a process that establishes a connection to the host
                        and port number specified, and forwards all data between the two hosts.  This option  is
                        useful  when  your  internal  machines are not visible to the outside world.  Syntax is:
                        redirect = (ip address) (port).  You can also use a hostname instead of the  IP  address
                        in  this field.  The hostname lookup is performed only once, when xinetd is started, and
                        the first IP address returned is the one that is used until xinetd  is  restarted.   The
                        "server"  attribute  is  not  required  when  this option is specified.  If the "server"
                        attribute is specified, this attribute takes priority.

       <b>bind</b>             Allows a service to be bound to a specific interface on the machine.  This means you can
                        have a telnet server listening on a local, secured interface, and not  on  the  external
                        interface.   Or  one  port  on  one interface can do something, while the same port on a
                        different interface can do something completely different.  Syntax: bind =  (ip  address
                        of interface).

       <b>interface</b>        Synonym for bind.

       <b>banner</b>           Takes  the  name  of  a file to be splatted at the remote host when a connection to that
                        service is established.  This banner is printed regardless of access control.  It should
                        *always* be printed when a connection has been made.  <b>xinetd</b> outputs the file as-is,  so
                        you  must  ensure  the  file  is  correctly  formatted  for  the service's protocol.  In
                        particular, if the protocol requires CR-LF pairs for line termination, you  must  supply
                        them.

       <b>banner_success</b>   Takes  the  name  of  a file to be splatted at the remote host when a connection to that
                        service is granted.  This banner is printed  as  soon  as  access  is  granted  for  the
                        service.   <b>xinetd</b>  outputs  the  file  as-is,  so  you must ensure the file is correctly
                        formatted for the service's protocol.  In particular, if  the  protocol  requires  CR-LF
                        pairs for line termination, you must supply them.

       <b>banner_fail</b>      Takes  the  name  of  a file to be splatted at the remote host when a connection to that
                        service is denied.  This banner is printed immediately upon denial of access.   This  is
                        useful  for informing your users that they are doing something bad and they shouldn't be
                        doing it anymore.  <b>xinetd</b> outputs the file  as-is,  so  you  must  ensure  the  file  is
                        correctly formatted for the service's protocol.  In particular, if the protocol requires
                        CR-LF pairs for line termination, you must supply them.

       <b>per_source</b>       Takes an integer or "UNLIMITED" as an argument.  This specifies the maximum instances of
                        this service per source IP address.  This can also be specified in the defaults section.

       <b>cps</b>              Limits  the  rate  of incoming connections.  Takes two arguments.  The first argument is
                        the number of connections per second to handle.  If the rate of incoming connections  is
                        higher  than this, the service will be temporarily disabled.  The second argument is the
                        number of seconds to wait before re-enabling the service after  it  has  been  disabled.
                        The default for this setting is 50 incoming connections and the interval is 10 seconds.

       <b>max_load</b>         Takes  a  floating  point  value  as  the  load at which the service will stop accepting
                        connections.  For example: 2 or 2.5.  The service will  stop  accepting  connections  at
                        this  load.   This is the one minute load average.  This is an OS dependent feature, and
                        currently only Linux, Solaris, and FreeBSD are supported for this.  This feature is only
                        available if xinetd was configured with the -with-loadavg option.

       <b>groups</b>           Takes either "yes" or "no".  If the groups attribute is set to "yes", then the server is
                        executed with access to the groups that  the  server's  effective  UID  has  access  to.
                        Alternatively,  if the <b>group</b> attribute is set, the server is executed with access to the
                        groups specified.  If the groups attribute is set to "no", then the server runs with  no
                        supplementary  groups.   This attribute must be set to "yes" for many BSD systems.  This
                        attribute can be set in the defaults section as well.

       <b>mdns</b>             Takes either "yes" or "no".  On systems  that  support  mdns  registration  of  services
                        (currently  only  Mac  OS  X),  this will enable or disable registration of the service.
                        This defaults to "yes".

       <b>umask</b>            Sets the inherited umask for the service.  Expects an octal value.  This option  may  be
                        set  in  the  "defaults"  section  to set a umask for all services.  xinetd sets its own
                        umask to the previous umask OR'd with 022.  This is the umask that will be inherited  by
                        all child processes if the umask option is not used.

       <b>enabled</b>          Takes  a  list  of service ID's to enable.  This will enable only the services listed as
                        arguments to this attribute; the rest will be disabled.  If you have 2 ftp services, you
                        will need to list both of their ID's and not just ftp. (ftp is the service name, not the
                        ID. It might accidentally be the ID, but  you  better  check.)  Note  that  the  service
                        "disable"  attribute  can  prevent  a service from being enabled despite being listed in
                        this attribute.

       <b>include</b>          Takes a filename in the form of "include /etc/xinetd/service".  The file is then  parsed
                        as  a  new  configuration  file.   It  is  not  the  same thing as pasting the file into
                        xinetd.conf where the include directive is given.  The included file must be in the same
                        form as xinetd.conf.  This may not be specified from  within  a  service.   It  must  be
                        specified outside a service declaration.

       <b>includedir</b>       Takes  a  directory  name  in the form of "includedir /etc/xinetd.d".  Every file inside
                        that directory, excluding files with names containing a dot ('.') or ending with a tilde
                        ('~'), will be parsed as xinetd configuration  files.   The  files  will  be  parsed  in
                        alphabetical  order  according  to the C locale. This allows you to specify services one
                        per file within a directory.  The <b>includedir</b> directive may not be specified from  within
                        a service declaration.

       <b>rlimit_as</b>        Sets  the Address Space resource limit for the service. One parameter is required, which
                        is either a positive integer representing the number of bytes to set the limit to (K  or
                        M  may  be  used to specify kilobytes/megabytes) or "UNLIMITED".  Due to the way Linux's
                        libc malloc is implemented, it is more  useful  to  set  this  limit  than  rlimit_data,
                        rlimit_rss and rlimit_stack. This resource limit is only implemented on Linux systems.

       <b>rlimit_files</b>     Sets  the  maximum  number  of  open  files  that the service may use.  One parameter is
                        required, which is a positive integer representing the number of open file  descriptors.
                        Practical limit of this number is around 1024000.

       <b>rlimit_cpu</b>       Sets  the  maximum  number  of  CPU  seconds that the service may use.  One parameter is
                        required, which is either a positive integer representing  the  number  of  CPU  seconds
                        limit to, or "UNLIMITED".

       <b>rlimit_data</b>      Sets  the  maximum data size resource limit for the service.  One parameter is required,
                        which is either a positive integer representing the number of bytes or "UNLIMITED".

       <b>rlimit_rss</b>       Sets the maximum resident set size limit for the service.  Setting this value  low  will
                        make  the  process  a likely candidate for swapping out to disk when memory is low.  One
                        parameter is required, which is either a positive integer  representing  the  number  of
                        bytes or "UNLIMITED".

       <b>rlimit_stack</b>     Set  the  maximum stack size limit for the service.  One parameter is required, which is
                        either a positive integer representing the number of bytes or "UNLIMITED".

       <b>deny_time</b>        Sets the time span that access to all services on all IP addresses are denied to someone
                        that sets off the SENSOR. The unit of time is in minutes.  Valid options  are:  FOREVER,
                        NEVER,  and a numeric value. FOREVER causes the IP address not to be purged until xinetd
                        is restarted. NEVER has the effect of just logging the offending IP address.  A  typical
                        time  value  would  be  60  minutes. This should stop most DOS attacks while allowing IP
                        addresses that come from a pool to be recycled for legitimate purposes. This option must
                        be used in conjunction with the SENSOR flag.

       You don't need to specify all of the above attributes for each service.  The necessary attributes  for  a
       service are:

              <b>socket_type</b>
              <b>user</b>              (non-<u>internal</u> services only)
              <b>server</b>            (non-<u>internal</u> services only)
              <b>wait</b>
              <b>protocol</b>          (<u>RPC</u> and <u>unlisted</u> services only)
              <b>rpc_version</b>       (<u>RPC</u> services only)
              <b>rpc_number</b>        (<u>unlisted</u> RPC services only)
              <b>port</b>              (<u>unlisted</u> non-RPC services only)

       The following attributes support all assignment operators:

              <b>only_from</b>
              <b>no_access</b>
              <b>log_on_success</b>
              <b>log_on_failure</b>
              <b>passenv</b>
              <b>env</b>               (does not support the <b>'-='</b> operator)

       These  attributes  can  also  appear more than once in a service entry.  The remaining attributes support
       only the <b>'='</b> operator and can appear at most once in a service entry.

       The configuration file may also contain a single defaults entry that has the form

              <b>defaults</b>
              <b>{</b>
                     <b>&lt;attribute&gt;</b> <b>=</b> <b>&lt;value&gt;</b> <b>&lt;value&gt;</b> <b>...</b>
                     <u>...</u>
              <b>}</b>

       This entry provides default attribute values for service entries that  don't  specify  those  attributes.
       Possible default attributes:

              <b>log_type</b>          (cumulative effect)
              <b>bind</b>
              <b>per_source</b>
              <b>umask</b>
              <b>log_on_success</b>    (cumulative effect)
              <b>log_on_failure</b>    (cumulative effect)
              <b>only_from</b>         (cumulative effect)
              <b>no_access</b>         (cumulative effect)
              <b>passenv</b>           (cumulative effect)
              <b>instances</b>
              <b>disabled</b>          (cumulative effect)
              <b>enabled</b>           (cumulative effect)
              <b>banner</b>
              <b>banner_success</b>
              <b>banner_fail</b>
              <b>per_source</b>
              <b>groups</b>
              <b>cps</b>
              <b>max_load</b>
              Attributes with a cumulative effect can be specified multiple times
              with the values specified each time accumulating (i.e. '=' does the same thing as '+=').  With the
              exception of <u>disabled</u> they all have the same meaning as if they were specified in a service entry.
              <u>disabled</u>  determines  services  that  are  disabled even if they have entries in the configuration
              file. This allows for quick reconfiguration by specifying  disabled  services  with  the  <u>disabled</u>
              attribute  instead  of  commenting  them  out.   The  value  of  this attribute is a list of space
              separated service ids.  <u>enabled</u> has the same properties as disabled.  The  difference  being  that
              <u>enabled</u> is a list of which services are to be enabled.  If <u>enabled</u> is specified, only the services
              specified  are  available.   If  <u>enabled</u> is not specified, all services are assumed to be enabled,
              except those listed in <u>disabled.</u>

</pre><h4><b>INTERNAL</b> <b>SERVICES</b></h4><pre>
       <b>xinetd</b> provides the following services internally (both stream and datagram based): <u>echo,</u> <u>time,</u>  <u>daytime,</u>
       <u>chargen,</u> and <u>discard.</u>  These services are under the same access restrictions as all other services except
       for  the  ones that don't require <b>xinetd</b> to fork another process for them. Those ones (<u>time</u>, <u>daytime</u>, and
       the datagram-based <u>echo</u>, <u>chargen</u>, and <u>discard</u>) have no limitation in the number of <b>instances.</b>

</pre><h4><b>TCPMUX</b> <b>Services</b></h4><pre>
       <b>xinetd</b> supports TCPMUX services that conform to RFC 1078. These services may not have a  well-known  port
       associated with them, and can be accessed via the TCPMUX well-known port.

       For  each  service  that  is  to  be  accessed  via  TCPMUX,  a service entry in <b>/etc/xinetd.conf</b> or in a
       configuration file in an <b>includedir</b> directory must exist.

       The <u>service_name</u> field (as defined above for each service in  any  <b>xinetd</b>  configuration  file)  must  be
       identical to the string that is passed (according to RFC 1078 protocol) to <b>xinetd</b> when the remote service
       requestor  first  makes  the  connection  on  the TCPMUX well-known port.  Private protocols should use a
       service name that has a high probability of being unique. One way is to prepend  the  service  name  with
       some form of organization ID.

       The  <u>type</u>  field  can  be  either <b>TCPMUX</b> or <b>TCPMUXPLUS</b>. If the type is <b>TCPMUXPLUS</b>, <b>xinetd</b> will handle the
       initial protocol handshake (as defined in RFC 1078)  with  the  calling  process  before  initiating  the
       service. If the type is <b>TCPMUX</b>, the server that is started is responsible for performing the handshake.

       The  <u>type</u> field should also include <b>UNLISTED</b> if the service is not listed in a standard system file (like
       <u><a href="file:/etc/rpc">/etc/rpc</a></u> for RPC services, or <u><a href="file:/etc/services">/etc/services</a></u> for non-RPC services).

       The <u>socket_type</u> for these services must be <b>stream</b>, and the <u>protocol</u> must be <b>tcp</b>.

       Following is a sample TCPMUX service configuration:

              service myorg_server
              {
                     disable             = no
                     type                = TCPMUX
                     socket_type         = stream
                     protocol            = tcp
                     wait                = no
                     user                = root
                     server              = /usr/bin/my_server_exec
              }

       Besides a service entry for each service that can be accessed via the TCPMUX well-known port,  a  service
       entry for TCPMUX itself must also be included in the <b>xinetd</b> configuration. Consider the following sample:

              service tcpmux
              {
                     type                = INTERNAL
                     id                  = tcpmux
                     socket_type         = stream
                     protocol            = tcp
                     user                = root
                     wait                = no
              }

</pre><h4><b>NOTES</b></h4><pre>
       1.    The following service attributes <u>cannot</u> be changed on reconfiguration: <b>socket_type,</b> <b>wait,</b> <b>protocol,</b>
             <b>type.</b>

       2.    When the attributes <u>only_from</u> and <u>no_access</u> are not specified for a service (either directly or via
             <u>defaults</u>) the address check is considered successful (i.e. access will not be denied).

       3.    The maximum line length of the configuration file is limited to 16 KiB (it might be less on systems
             without mmap, the length limit is two times the optimal I/O blocksize then).

       4.    The  address  check is based on the IP address of the remote host and not on its domain address. We
             do this so that we can avoid remote name lookups which may  take  a  long  time  (since  <b>xinetd</b>  is
             single-threaded,  a name lookup will prevent the daemon from accepting any other requests until the
             lookup is resolved).  The down side of this scheme is that if the  IP  address  of  a  remote  host
             changes,  then  access  to that host may be denied until <b>xinetd</b> is reconfigured.  Whether access is
             actually denied or not will depend on whether the new  host  IP  address  is  among  those  allowed
             access.  For  example, if the IP address of a host changes from 1.2.3.4 to 1.2.3.5 and only_from is
             specified as 1.2.3.0 then access will not be denied.

       5.    If the <b>USERID</b> log option is specified and the remote host either does  not  run  an  identification
             server  or  the  server sends back a bad reply, access will not be denied unless the <u>IDONLY</u> service
             flag is used.

       6.    Interception works by forking a process which acts as a filter between the remote host(s)  and  the
             local  server.   This  obviously has a performance impact so it is up to you to make the compromise
             between security and performance for each service.  The  following  tables  show  the  overhead  of
             interception.   The  first table shows the time overhead-per-datagram for a UDP-based service using
             various datagram sizes.  For TCP-based services we measured  the  bandwidth  reduction  because  of
             interception while sending a certain amount of data from client to server (the time overhead should
             the  same  as for UDP-based services but it is "paid" only by the first packet of a continuous data
             transmission).  The amount of data is given in the table as  <u>system_calls</u>x<u>data_sent_per_call</u>,  i.e.
             each  <u><a href="../man2/send.2.html">send</a>(2)</u>  system  call transferred so many bytes of data.  The bandwidth reduction is given in
             terms of bytes per second and as a percentage of the bandwidth when interception is not  performed.
             All measurements were done on a SparcStation IPC running SunOS 4.1.

                    Datagram size (bytes)    Latency (msec)
                    ---------------------    --------------
                    64                       1.19
                    256                      1.51
                    1024                     1.51
                    4096                     3.58

                    Bytes sent               Bandwidth reduction
                    ----------               -------------------
                    10000x64                 941 (1.2%)
                    10000x256                4,231 (1.8%)
                    10000x1024               319,300 (39.5%)
                    10000x4096               824,461 (62.1%)

</pre><h4><b>EXAMPLE</b></h4><pre>
              #
              # Sample configuration file for xinetd
              #

              defaults
              {
                     log_type            = FILE /var/log/servicelog
                     log_on_success      = PID
                     log_on_failure      = HOST
                     only_from           = 128.138.193.0 128.138.204.0
                     only_from           = 128.138.252.1
                     instances           = 10
                     disabled            = rstatd
              }

              #
              # Note 1: the protocol attribute is not required
              # Note 2: the instances attribute overrides the default
              #
              service login
              {
                     socket_type         = stream
                     protocol            = tcp
                     wait                = no
                     user                = root
                     server              = /usr/sbin/in.rlogind
                     instances           = UNLIMITED
              }

              #
              # Note 1: the instances attribute overrides the default
              # Note 2: the log_on_success flags are augmented
              #
              service shell
              {
                     socket_type         = stream
                     wait                = no
                     user                = root
                     instances           = UNLIMITED
                     server              = /usr/sbin/in.rshd
                     log_on_success      += HOST
              }

              service ftp
              {
                     socket_type         = stream
                     wait                = no
                     nice                = 10
                     user                = root
                     server              = /usr/sbin/in.ftpd
                     server_args         = -l
                     instances           = 4
                     log_on_success      += DURATION HOST USERID
                     access_times        = 2:00-9:00 12:00-24:00
              }

              # Limit telnet sessions to 8 Mbytes of memory and a total
              # 20 CPU seconds for child processes.
              service telnet
              {
                     socket_type         = stream
                     wait                = no
                     nice                = 10
                     user                = root
                     server              = /usr/sbin/in.telnetd
                     rlimit_as           = 8M
                     rlimit_cpu          = 20
              }

              #
              # This entry and the next one specify internal services. Since
              # this is the same service using a different socket type, the
              # id attribute is used to uniquely identify each entry
              #
              service echo
              {
                     id                  = echo-stream
                     type                = INTERNAL
                     socket_type         = stream
                     user                = root
                     wait                = no
              }

              service echo
              {
                     id                  = echo-dgram
                     type                = INTERNAL
                     socket_type         = dgram
                     user                = root
                     wait                = no
              }

              #
              # Sample RPC service
              #
              service rstatd
              {
                     type                = RPC
                     socket_type         = dgram
                     protocol            = udp
                     server              = /usr/sbin/rpc.rstatd
                     wait                = yes
                     user                = root
                     rpc_version         = 2-4
                     env                 = LD_LIBRARY_PATH=/etc/securelib
              }

              #
              # Sample unlisted service
              #
              service unlisted
              {
                     type                = UNLISTED
                     socket_type         = stream
                     protocol            = tcp
                     wait                = no
                     server              = /home/user/some_server
                     port                = 20020
              }

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1L/xinetd.1L.html">xinetd</a>(1L),</u>

       <u><a href="../man5/xinetd.log.5.html">xinetd.log</a>(5)</u>

       Postel J., <u>Echo</u> <u>Protocol</u>, RFC 862, May 1983

       Postel J., <u>Discard</u> <u>Protocol</u>, RFC 863, May 1983

       Postel J., <u>Character</u> <u>Generator</u> <u>Protocol</u>, RFC 864, May 1983

       Postel J., <u>Daytime</u> <u>Protocol</u>, RFC 867, May 1983

       Postel J., Harrenstien K., <u>Time</u> <u>Protocol</u>, RFC 868, May 1983

       M. Lottor, <u>TCP</u> <u>Port</u> <u>Service</u> <u>Multiplexer</u> <u>(TCPMUX)</u>, RFC 1078 Nov 1988

       StJohns M.,  <u>Identification</u> <u>Protocol</u>, RFC 1413, February 1993

</pre><h4><b>BUGS</b></h4><pre>
       If the <b>INTERCEPT</b> flag is not used, access control on the address of the remote host is not performed when
       <u>wait</u> is <u>yes</u> and <u>socket_type</u> is <u>stream</u>.

       The NOLIBWRAP flag is automatically turned on for RPC services whose <u>socket_type</u> is <u>stream</u> because xinetd
       cannot determine the address of the remote host.

       If  the  <b>INTERCEPT</b>  flag is not used, access control on the address of the remote host for services where
       <u>wait</u> is <u>yes</u> and <u>socket_type</u> is <u>dgram</u> is performed only on the first packet. The server  may  then  accept
       packets from hosts not in the access control list. This can happen with <b>RPC</b> services.

       There is no way to put a SPACE in an environment variable.

       When <u>wait</u> is <u>yes</u> and <u>socket_type</u> is <u>stream</u>, the socket passed to the server can only accept connections.

       The <b>INTERCEPT</b> flag is not supported for internal services or multi-threaded services.

                                                  14 June 2001                                    <u><a href="../man5/XINETD.CONF.5.html">XINETD.CONF</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>