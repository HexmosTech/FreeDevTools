<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>just-serve-config - The format of the configuration used by the serve subcommand of justbuild(1)</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/justbuild">justbuild_1.5.1-1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       just-serve-config - The format of the configuration used by the <b>serve</b> subcommand of <b><a href="../man1/justbuild.1.html">justbuild</a></b>(1)

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  file  is  read  as JSON.  Any other serialization describing the same JSON object is equivalent.  We
       assume, that in JSON objects, each key occurs at most once; it is implementation defined how  repetitions
       of the same key are treated.

   <b>Location</b> <b>objects</b>
       The  general  syntax  and  semantics  of  a location object are described in <b><a href="../man5/just-mrrc.5.html">just-mrrc</a></b>(5).  Here we use a
       restricted form where the value for key <u>"root"</u> can only be either <u>"home"</u> or <u>"system"</u>.   This  is  because
       just serve is not aware of the concept of workspaces.

   <b>The</b> <b>just-serve</b> <b>configuration</b> <b>format</b>
       The configuration file is given by a JSON object.

       • The value for the key <u>"local</u> <u>build</u> <u>root"</u> is a single location object, specifying the path to use as the
         root  for  local  CAS,  cache,  and  build  directories.  The path will be created if it does not exist
         already.

       • The value for the  key  <u>"repositories"</u>  is  a  list  of  location  objects,  specifying  paths  to  Git
         repositories  for  <b>justbuild</b>  <b>serve</b>  to use as additional object lookup locations.  The paths are to be
         used in the order given and only if requested objects are not found in the local build root.

       • The value for the key <u>"logging"</u> is a JSON object specifying logging options.
       For subkey <u>"files"</u> the value is a list of location objects, specifying one or more  local  log  files  to
       use.
       For subkey <u>"limit"</u> the value is an integer setting the default for the log limit.
       For subkey <u>"restrict</u> <u>stderr</u> <u>limit"</u> the value is an integer setting a restriction for the log on stderr.
       For subkey <u>"plain"</u> the value is a flag.  If set, do not use ANSI escape sequences to highlight messages.
       For  subkey  <u>"append"</u>  the  value  is a flag.  If set, append messages to log file instead of overwriting
       existing.

       • The value for the key <u>"authentication"</u> is a JSON object specifying client-side  authentication  options
         for <b>justbuild</b> <b>serve</b> when communicating with the remote execution endpoint.
       For subkey <u>"ca</u> <u>cert"</u> the value is a single location object, specifying the path to a TLS CA certificate.
       For  subkey  <u>"client</u>  <u>cert"</u>  the  value  is a single location object, specifying the path to a TLS client
       certificate.
       For subkey <u>"client</u> <u>key"</u> the value is a single location object, specifying the path to a TLS client key.

       • The value for the key <u>"remote</u> <u>service"</u> is a JSON object specifying the  server  arguments  for  running
         <b>justbuild</b> <b>serve</b> as a service.
       For  subkey  <u>"interface"</u> the value specifies the interface of the service.  If unset, the loopback device
       is used.
       For subkey <u>"port"</u> the value specifies the port to which the service is to listen.  If unset, the  service
       will choose to the first available one.
       For  subkey  <u>"pid</u> <u>file"</u> the value is a single location object, specifying the path to a file to which the
       pid should be stored in plain text.  If the file exists, it will be overwritten.
       For subkey <u>"info</u> <u>file"</u> the value specifies a single location object, specifying the path to a  file  file
       to  which the used port, interface, and pid should be stored in JSON format.  If the file exists, it will
       be overwritten.
       For subkey <u>"server</u> <u>cert"</u> the value is a single location object, specifying  the  path  to  a  TLS  server
       certificate.
       For subkey <u>"server</u> <u>key"</u> the value is a single location object, specifying the path to a TLS server key.

       • The  value  for  the  key  <u>"execution</u>  <u>endpoint"</u>  is a JSON object specifying the arguments of a remote
         execution endpoint to be used by <b>justbuild</b> <b>serve</b>.
       For subkey <u>"address"</u> the value is a string specifying the remote execution address in a NAME:PORT format.
       For subkey <u>"client</u> <u>address"</u> the value is a string specifying the remote execution  address  used  by  the
       client in a NAME:PORT format.  If not provided, it defaults to <u>"address"</u>.
       For subkey <u>"compatible"</u> the value is a flag which specifies whether the remote endpoint uses the original
       remote execution protocol.
       If the key <u>"execution</u> <u>endpoint"</u> is given, the following three keys will be evaluated as well:

         • <u>"max-attempts"</u>:  the value must be a number specifying the maximum number of attempts to perform when
           a remote  procedure  call  (to  the  <u>"execution</u>  <u>endpoint"</u>  given)  fails  because  the  resource  is
           unavailable.
         • <u>"initial-backoff-seconds"</u>:  the  value  must be a number; before retrying the second time, the client
           will wait the given amount of seconds plus a jitter, to better distribute the workload.
         • <u>"max-backoff-seconds"</u>: the value must be a number; from the third attempt (included) on, the  backoff
           time  is doubled at each attempt, until it exceeds the "max-backoff-seconds" value.  From that point,
           the waiting time is computed as "max-backoff-seconds" value plus a jitter.

       • The value for the key <u>"jobs"</u> specifies the number of jobs to run.  If unset, the  number  of  available
         cores is used.

       • The  value  for  the  key  <u>"build"</u>  is  a  JSON  object specifying arguments used by <b>justbuild</b> <b>serve</b> to
         orchestrate remote builds.
       For subkey <u>"build</u> <u>jobs"</u> the value specifies the number of jobs to run during a remote build.   If  unset,
       the same value as for outer key <u>"jobs"</u> is used.
       For subkey <u>"action</u> <u>timeout"</u> the value in a number specifying the timeout limit in seconds for actions run
       during a remote build.  If unset, the default value 300 is used.
       For  subkey  <u>"target-cache</u>  <u>write</u>  <u>strategy"</u>  the value has to be one of the values <u>"disable"</u>, <u>"sync"</u>, or
       <u>"split"</u>.  The default is <u>"sync"</u>, giving the instruction to synchronize artifacts and  write  target-level
       cache  entries.   The  value  <u>"split"</u>  does  the  same using blob splitting when synchronizing artifacts,
       provided it is supported by the remote-execution endpoint.   The  value  <u>"disable"</u>  disables  adding  new
       entries  to  the  target-level  cache,  which defeats the purpose of typical set up to share target-level
       computations between clients.
       For the subkey <u>"local</u> <u>launcher"</u>, if given, the value has to be a  list.   This  list  is  used  as  local
       launcher  for  the  build in the case the serve process acts simultaneously as remote-execution endpoint.
       If unset (or null), the value ["env", "--"] will be taken as default.

</pre><h4><b>EXAMPLE</b></h4><pre>
       An example serve configuration file could look as follows.

              { "local build root": {"root": "system", "path": "var/just-serve/root"}
              , "authentication":
                { "ca cert":
                  {"root": "system", "path": "etc/just-serve/certs/ca.crt"}
                , "client cert":
                  {"root": "system", "path": "etc/just-serve/certs/client.crt"}
                , "client key":
                  {"root": "system", "path": "etc/just-serve/certs/client.key"}
                }
              , "remote service":
                { "interface": "192.0.2.1"
                , "port": 9999
                , "pid file":
                  {"root": "system", "path": "var/run/just-serve/server.pid"}
                , "server cert":
                  {"root": "system", "path": "etc/just-serve/certs/server.crt"}
                , "server key":
                  {"root": "system", "path": "etc/just-serve/certs/server.key"}
                }
              , "execution endpoint": {"address": "198.51.100.1:8989"}
              , "repositories":
                [ {"root": "system", "path": "var/just-serve/repos/third-party-distfiles"}
                , {"root": "system", "path": "var/just-serve/repos/project-foo"}
                , {"root": "system", "path": "var/just-serve/repos/project-bar"}
                ]
              , "logging":
                {"files": [{"root": "home", "path": ".log/just-serve/latest"}]}
              , "jobs": 8
              , "build": {"build jobs": 128}
              , "max-attempts": 10
              , "initial-backoff-seconds": 10
              , "max-backoff-seconds": 60
              }

</pre><h4><b>See</b> <b>also</b></h4><pre>
       <b><a href="../man1/justbuild.1.html">justbuild</a></b>(1), <b><a href="../man5/just-mrrc.5.html">just-mrrc</a></b>(5)

                                                                    <u>JUST</u> <u>SERVE</u> <u><a href="../man5/CONFIG.5.html">CONFIG</a>(5)</u> <u>|</u> <u>File</u> <u>Formats</u> <u>Manual</u>()
</pre>
 </div>
</div></section>
</div>
</body>
</html>