<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>firehol-mark - set a stateful mark from the usermark group</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/firehol-doc">firehol-doc_3.1.8+ds-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       firehol-mark - set a stateful mark from the usermark group

</pre><h4><b>SYNOPSIS</b></h4><pre>
       { mark | mark46 } <u>value</u> <u>chain</u> <u>rule-params</u>

       mark4 <u>value</u> <u>chain</u> <u>rule-params</u>

       mark6 <u>value</u> <u>chain</u> <u>rule-params</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Marks on packets can be matched by traffic shaping, routing, and firewall rules for controlling traffic.

              <b>Note</b> Behaviour changed significantly in FireHOL v3 compared to earlier versions

              There  is  also  a  mark  parameter  which  allows  matching  marks  within  individual rules (see
              <a href="../man5/firehol-params.5.html">firehol-params</a>(5)).

       FireHOL uses iptables masks to break the single 32-bit integer mark value into smaller groups and  allows
       you  to  set  and  match  them  independently.  The markdef group definitions to set this up are found in
       firehol-defaults.conf

       The mark helper command sets values within the usermark group.  You can set <u>value</u> between 0 (no mark) and
       size-1.  The default size for usermark is 128, so 127 is highest <u>value</u> possible.   The  default  usermark
       types  are  stateful+permanent,  meaning  the initial match will only be done on NEW packets and the mark
       will be restored to all packets in the connection.

       The <u>chain</u> will be used to find traffic to mark.  It can  be  any  of  the  <a href="../man8/iptables.8.html">iptables</a>(8)  built  in  chains
       belonging  to the mangle table.  The chain names are: INPUT, FORWARD, OUTPUT, PREROUTING and POSTROUTING.
       The names are case-sensitive.

       The <u>rule-params</u> define a set of rule parameters to match the traffic that is  to  be  marked  within  the
       chosen chain.  See <a href="../man5/firehol-params.5.html">firehol-params</a>(5) for more details.

       Any mark commands must be declared before the first router or interface.

              <b>Note</b>

              If  you  want  to do policy based routing based on <a href="../man8/iptables.8.html">iptables</a>(8) marks, you will need to disable the
              Root Path Filtering on the interfaces involved (rp_filter in sysctl).

              FireQOS will read the FireHOL mark definitions and set up  suitable  offsets  and  marks  for  the
              various  groups.   If  you  are using a different tool, you should look at the emitted firewall to
              determine the final masks and values to use.

</pre><h4><b>EXAMPLES</b></h4><pre>
               # mark with 1, packets sent by the local machine
               mark 1 OUTPUT

               # mark with 2, packets routed by the local machine
               mark 2 FORWARD

               # mark with 3, packets routed by the local machine, sent from
               #              192.0.2.2 destined for port TCP/25 of 198.51.100.1
               mark 3 FORWARD proto tcp dport 25 dst 198.51.100.1 src 192.0.2.2

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       • <a href="../man1/firehol.1.html">firehol</a>(1) - FireHOL program

       • <a href="../man5/firehol.conf.5.html">firehol.conf</a>(5) - FireHOL configuration

       • <a href="../man5/firehol-params.5.html">firehol-params</a>(5) - optional rule parameters

       • <a href="../man5/firehol-connmark.5.html">firehol-connmark</a>(5) - set a stateful mark from the connmark group

       • <a href="../man8/iptables.8.html">iptables</a>(8) - administration tool for IPv4 firewalls

       • <a href="../man8/ip6tables.8.html">ip6tables</a>(8) - administration tool for IPv6 firewalls

       • <a href="../man8/ip.8.html">ip</a>(8) - show / manipulate routing, devices, policy routing and tunnels

       • FireHOL Website

       • Working With Marks Wiki Page

       • FireHOL Online PDF Manual

       • FireHOL Online Documentation

       • Linux Advanced Routing &amp; Traffic Control HOWTO

</pre><h4><b>AUTHORS</b></h4><pre>
       FireHOL Team.

FireHOL Reference                               Built 13 Apr 2025                                <u><a href="../man5/firehol-mark.5.html">firehol-mark</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>