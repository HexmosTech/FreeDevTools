<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>firehol-blacklist - set up a unidirectional or bidirectional blacklist</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/firehol-doc">firehol-doc_3.1.8+ds-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       firehol-blacklist - set up a unidirectional or bidirectional blacklist

</pre><h4><b>SYNOPSIS</b></h4><pre>
       {  blacklist  |  blacklist4  | blacklist6 } [ <u>type</u> ] [ inface <u>device</u> ] [ log <u>“text”</u> ] [ nolog ] [ connlog
       <u>“text”</u> ] [ loglimit <u>“text”</u> ] [ accounting <u>accounting_name</u> ] <u>ip</u>...  [ except <u>rule-params</u>  [or  <u>rule-params</u>
       [or ...  ]]]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The blacklist helper command creates a blacklist for the <u>ip</u> list given (which can be in quotes or not).

       If  the  type  full  or  all is supplied (or no type at all), a bidirectional <u>stateless</u> blacklist will be
       generated.  The firewall will REJECT all traffic going to the IP addresses and DROP  all  traffic  coming
       from them.

       If  the  type  stateful  is supplied, a bidirectional <u>stateful</u> blacklist will be generated.  The firewall
       will REJECT all traffic going to the IP addresses and DROP all traffic coming from them.

       The differences between full and stateful are:

       1. stateful is resource efficient, since  only  the  packets  that  initiate  connections  are  examined.
          Established connections will never be re-tested against the blacklist.

       2. when using full and an ipset is updated to match the IP of an established connection, this established
          connection will immediately be blocked too.

       If  the  type input or him, her, it, this, these is supplied, a unidirectional <u>stateful</u> blacklist will be
       generated.  Connections can be established to such IP addresses, but the IP addresses will not be able to
       connect to the firewall or hosts protected by it.

       Using log (log every packet), connlog (log connections once),  or  loglimit  (log  packets  according  to
       global throttling settings), the text will be logged when matching packets are found.

       Using nolog will disable logging for this rule.

       Using  inface,  the  blacklist  will  be  created  on  the interface device only (this includes forwarded
       traffic).

       accounting will update the NFACCT accounting with the name given.

       If the keyword except is found, then all the parameters following it are  rules  to  match  packets  that
       should excluded from the blacklist (i.e. they are a whitelist for this blacklist).  See <a href="../man5/firehol-params.5.html">firehol-params</a>(5)
       for more details.

       Blacklists must be declared before the first router or interface.

       IP   Lists   for  abuse,  malware,  attacks,  proxies,  anonymizers,  etc  can  be  downloaded  with  the
       contrib/update-ipsets.sh script.  Information about the supported IP Lists can  be  found  at  FireHOL IP
       Lists

</pre><h4><b>EXAMPLES</b></h4><pre>
              blacklist full 192.0.2.1 192.0.2.2
              blacklist input "192.0.2.3 192.0.2.4"
              blacklist full inface eth0 log "BADGUY" 192.0.1.1 192.0.1.2

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       • <a href="../man1/firehol.1.html">firehol</a>(1) - FireHOL program

       • <a href="../man5/firehol.conf.5.html">firehol.conf</a>(5) - FireHOL configuration

       • FireHOL Website

       • FireHOL Online PDF Manual

       • FireHOL Online Documentation

       • FireHOL IP Lists

</pre><h4><b>AUTHORS</b></h4><pre>
       FireHOL Team.

FireHOL Reference                               Built 13 Apr 2025                           <u><a href="../man5/firehol-blacklist.5.html">firehol-blacklist</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>