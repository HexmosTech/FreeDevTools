<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>policy.conf - Configuration file for openCryptoki policies.</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/opencryptoki">opencryptoki_3.25.0+dfsg-0ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       policy.conf - Configuration file for openCryptoki policies.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       openCryptoki uses a policy configuration file at /etc/opencryptoki/policy.conf

       This configuration file restricts the operations of openCryptoki to a specific set of allowed operations.
       The policy allows users to restrict keys to a minimal cryptographic strength, restrict supported elliptic
       curves, mechanisms, MGFs, KDFs, or PRFs.

</pre><h4><b>SYNTAX</b></h4><pre>
       This  file  starts  with  a  version  specification  of  the  form  <b>version</b>  <b>policy-0</b>  followed by policy
       constraints.

       A policy constraint assigns a value to a configuration key.  The syntax depends of the value of the key:

       <b>strength</b>

              This key defines the minimal required strength for keys,  and  digest  and  signature  sizes.   It
              corresponds  to  the definition in /etc/opencryptoki/strength.conf.  Valid values are 0, 112, 128,
              192, and 256.  The special value 0 allows every key and arbitrary size of digests and  signatures.
              The format is a simple assignment:

              strength = number

              If  other  values  are used, they are rounded up to the next supported value.  Values greater than
              256 are rounded down to 256.

       <b>allowedmechs</b>

              This key specifies a list of mechanisms that are allowed by this policy.  The list should  contain
              a  comma-separated  list  of  <b>CKM_</b>  constants supported by openCryptoki. The list is placed inside
              brackets:

              allowedmechs ( mech1, mech2 )

              Note: This key is optional.  If not present, all mechanisms are allowed.   If  an  empty  list  is
              provided, no mechanism would be allowed.

       <b>allowedcurves</b>

              This  key  specifies  a  list  of  allowed elliptic curves.  Keys that do not belong to any of the
              allowed curves cannot be created or used.  The list has the same format as the <b>allowedmechs</b> key:

              allowedcurves ( curve1, curve2 )

              Valid curve names are:

              •      BRAINPOOL_P160R1

              •      BRAINPOOL_P160T1

              •      BRAINPOOL_P192R1

              •      BRAINPOOL_P192T1

              •      BRAINPOOL_P224R1

              •      BRAINPOOL_P224T1

              •      BRAINPOOL_P256R1

              •      BRAINPOOL_P256T1

              •      BRAINPOOL_P320R1

              •      BRAINPOOL_P320T1

              •      BRAINPOOL_P384R1

              •      BRAINPOOL_P384T1

              •      BRAINPOOL_P512R1

              •      BRAINPOOL_P512T1

              •      PRIME192V1

              •      SECP224R1

              •      PRIME256V1

              •      SECP384R1

              •      SECP521R1

              •      SECP256K1

              •      CURVE25519

              •      CURVE448

              •      ED25519

              •      ED448

       Note: This key is optional.  If not present, all curves are allowed.  An empty list allows no curve.

       <b>allowedmgfs</b>

              This key specifies the allowed Message Generation Functions (MGFs) for use in  RSA  OAEP  and  RSA
              PSS.   The  value  is  a  list of <b>CKG_</b> constants supported by openCryptoki.  The list has the same
              format as the <b>allowedmechs</b> key:

              allowedmgfs ( mgf1, mgf2 )

              Note: This key is optional.  If not present, all MGFs are allowed.  An empty list allows no MGF.

       <b>allowedkdfs</b>

              This key specifies the allowed Key Derivation Functions (KDFs) for use in ECDH key derivation  and
              Kyber  KEM.   The  value is a list of <b>CKD_</b> constants supported by openCryptoki.  This list has the
              same format as the <b>allowedmechs</b> key:

              allowedkdfs ( kdf1, kdf2 )

              Note: This key is optional.  If not present, all KDFs are allowed.  An empty list allows no KDF.

       <b>allowedprfs</b>

              This key specifies the allowed Pseudo-Random Functions (PRFs) for use in PKCS #5 PBKDF.  The value
              is  a  list  of  PRFs.   Currently,  the  only  supported  value  is   <b>CKP_PKCS5_PBKD2_HMAC_SHA256</b>
              <b>CKP_PKCS5_PBKD2_HMAC_SHA512</b> which leads to the list

              allowedprfs ( CKP_PKCS5_PBKD2_HMAC_SHA512, CKP_PKCS5_PBKD2_HMAC_SHA256 )

              Note: This key is optional.  If not present, all PRFs are allowed.  An empty list allows no PRF.

</pre><h4><b>NOTES</b></h4><pre>
       The policy configuration file has to be owned by <b>root:pkcs11</b> and have mode 0640.  Otherwise, openCryptoki
       will return <b>CKR_FUNCTION_FAILED</b> on <b>C_Initialize</b> and log the reason into syslog.

       The pound sign ('#') is used to indicate a comment.  Both the comment character and any text after it, up
       to  the  end  of  the  line,  are  ignored.  The comment character can be used at the beginning of a line
       (including before the file version specification), after the strength value, after a  comma,  and  before
       and after the bracket.

       Since the policy indirectly refers to a strength configuration, a strength configuration has to exist and
       be  valid.   If  no  strength  configuration  exists,  no policy will be enforced.  If an existing policy
       configuration is invalid, openCryptoki cannot be used.

       openCryptoki uses some cryptographic operations to store token objects.   These  operations  have  to  be
       allowed  by  the  policy.   Which  operations  are needed depends on the token store format and the token
       (since the ICSF Token as a remote token uses different crypto operations to store its management data):

              FIPS compliant format
                     Token  stores  in  the  FIPS  compliant  format  need   the   mechanisms   <b>CKM_AES_KEY_GEN,</b>
                     <b>CKM_AES_KEY_WRAP,</b>  <b>CKM_AES_GCM,</b>  <b>CKM_PKCS5_PBKD2,</b>  the PRF <b>CKP_PKCS5_PBKD2_HMAC_SHA512,</b> and
                     must allow 256 bit AES keys.

              legacy format
                     Token  stores  in  legacy  format  need  the  mechanisms  <b>CKM_DES3_KEY_GEN,</b>   <b>CKM_DES3_CBC,</b>
                     <b>CKM_AES_KEY_GEN,</b>  <b>CKM_AES_CBC,</b>  <b>CKM_SHA1,</b>  <b>CKM_MD5</b>  and  must allow 2-key TDES keys (80 bit
                     symmetric keys with 64 bit signatures).

              ICSF Token store
                     <b>CKM_AES_KEY_GEN,</b>    <b>CKM_AES_CBC,</b>    <b>CKM_SHA1,</b>    <b>CKM_MD5</b>    <b>CKM_PKCS5_PBKD2,</b>    the     PRF
                     <b>CKP_PKCS5_PBKD2_HMAC_SHA256,</b> and must allow 256 bit AES keys.

       Tokens cannot be loaded if their token store format is not supported by the policy.  If a token cannot be
       loaded,  a message is printed into syslog detailing the policy violation.  To fix this problem, make sure
       the token format is allowed by your policy (either by satisfying  above  constraints  or  by  temporarily
       removing /etc/opencryptoki/policy.conf) and migrate your token store, e.g., to the FIPS-compliant format.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/strength.conf.5.html">strength.conf</a></b>(5),
       <b><a href="../man7/opencryptoki.7.html">opencryptoki</a></b>(7),
       <b><a href="../man1/pkcstok_migrate.1.html">pkcstok_migrate</a></b>(1),
       /usr/share/doc/opencryptoki/policy-example.conf

3.25.0                                           September 2021                                   <u><a href="../man5/POLICY.CONF.5.html">POLICY.CONF</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>