<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selabel_x  -  userspace  SELinux labeling interface and configuration file format for the X Window System</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/selinux-utils">selinux-utils_3.8.1-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       selabel_x  -  userspace  SELinux labeling interface and configuration file format for the X Window System
       contexts backend. This backend is also used to  determine  the  default  context  for  labeling  remotely
       connected X clients

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;selinux/label.h&gt;</b>

       <b>int</b> <b>selabel_lookup(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                          <b>char</b> <b>**</b><u>context</u><b>,</b>
                          <b>const</b> <b>char</b> <b>*</b><u>object_name</u><b>,</b> <b>int</b> <u>object_type</u><b>);</b>

       <b>int</b> <b>selabel_lookup_raw(struct</b> <b>selabel_handle</b> <b>*</b><u>hnd</u><b>,</b>
                          <b>char</b> <b>**</b><u>context</u><b>,</b>
                          <b>const</b> <b>char</b> <b>*</b><u>object_name</u><b>,</b> <b>int</b> <u>object_type</u><b>);</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  X contexts backend maps from X Window System object names into security contexts. It is used to find
       the appropriate context for X Window  System  objects  whose  significance  and/or  usage  semantics  are
       determined primarily by name. The returned <u>context</u> must be freed using <b><a href="../man3/freecon.3.html">freecon</a></b>(3).
       <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) describes the function with its return and error codes.

       This backend is also used to determine the default context for labeling remotely connected X clients.

       The <u>object_type</u> argument should be set to one of the following values:

              <b>SELABEL_X_PROP</b>
                     The <u>object_name</u> argument specifies the name of a window property, such as "WM_NAME".

              <b>SELABEL_X_SELN</b>
                     The <u>object_name</u> argument specifies the name of a selection, such as "PRIMARY".

              <b>SELABEL_X_EXT</b>
                     The <u>object_name</u> argument specifies the name of a protocol extension, such as "RENDER".

              <b>SELABEL_X_EVENT</b>
                     The <u>object_name</u> argument specifies the name of an event type, such as "X11:ButtonPress".

              <b>SELABEL_X_CLIENT</b>
                     The  <u>object_name</u>  argument is ignored, however it should be set to either <u>*</u> (an asterisk or
                     'wildcard' that will select the default entry) or a specific entry such as "remote" in  the
                     X  contexts file as shown in the <b>EXAMPLE</b> section. The default context for labeling remote X
                     clients is then returned.

              <b>SELABEL_X_POLYPROP</b>
                     Like <b>SELABEL_X_PROP</b>, but checks if the property was marked as being  polyinstantiated.  See
                     <b>NOTES</b> below.

              <b>SELABEL_X_POLYSELN</b>
                     Like  <b>SELABEL_X_SELN</b>, but checks if the selection was marked as being polyinstantiated. See
                     <b>NOTES</b> below.

       Any messages generated by <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3) are sent to <u>stderr</u> by default, although this can  be  changed
       by <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3).

       <b>selabel_lookup_raw</b> behaves identically to <b>selabel_lookup</b> but does not perform context translation.

       The <b>FILES</b> section details the configuration files used to determine the X object context.

</pre><h4><b>OPTIONS</b></h4><pre>
       In  addition  to  the  global options described in <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), this backend recognizes the following
       options:

              <b>SELABEL_OPT_PATH</b>
                     A non-null value for this option specifies a path to a file that will be opened in lieu  of
                     the standard X contexts file (see the <b>FILES</b> section for details).

</pre><h4><b>FILES</b></h4><pre>
       The X context file used to retrieve a default context depends on the <b>SELABEL_OPT_PATH</b> parameter passed to
       <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3).  If  <u>NULL</u>,  then the <b>SELABEL_OPT_PATH</b> value will default to the active policy X contexts
       location  (as  returned  by  <b><a href="../man3/selinux_x_context_path.3.html">selinux_x_context_path</a></b>(3)),  otherwise  the  actual  <b>SELABEL_OPT_PATH</b>  value
       specified is used.

       The default X object contexts file is:
              <u><a href="file:/etc/selinux/">/etc/selinux/</a>{SELINUXTYPE}/contexts/x_contexts</u>

       Where <u>{SELINUXTYPE}</u> is the entry from the selinux configuration file <u>config</u> (see <b><a href="../man5/selinux_config.5.html">selinux_config</a></b>(5)).

       The  entries  within  the  X  contexts  file  are  shown in the <b>Object</b> <b>Name</b> <b>String</b> <b>Values</b> and <b>FILE</b> <b>FORMAT</b>
       sections.

</pre><h4><b>Object</b> <b>Name</b> <b>String</b> <b>Values</b></h4><pre>
       The string name assigned to each <u>object_type</u> argument that can be present in the X contexts file are:
                                       ┌────────────────────┬────────────────┐
                                       │ <u>object_type</u>        │ <b>Text</b> <b>Name</b>      │
                                       ├────────────────────┼────────────────┤
                                       │ <b>SELABEL_X_PROP</b>     │ property       │
                                       ├────────────────────┼────────────────┤
                                       │ <b>SELABEL_X_SELN</b>     │ selection      │
                                       ├────────────────────┼────────────────┤
                                       │ <b>SELABEL_X_EXT</b>      │ extension      │
                                       ├────────────────────┼────────────────┤
                                       │ <b>SELABEL_X_EVENT</b>    │ event          │
                                       ├────────────────────┼────────────────┤
                                       │ <b>SELABEL_X_CLIENT</b>   │ client         │
                                       ├────────────────────┼────────────────┤
                                       │ <b>SELABEL_X_POLYPROP</b> │ poly_property  │
                                       ├────────────────────┼────────────────┤
                                       │ <b>SELABEL_X_POLYSELN</b> │ poly_selection │
                                       └────────────────────┴────────────────┘

</pre><h4><b>FILE</b> <b>FORMAT</b></h4><pre>
       Each line within the X contexts file is as follows:
              <u>object_type</u> <u>object_name</u> <u>context</u>

       Where:
              <u>object_type</u>
                     This is the string representation of the object type shown in the <b>Object</b> <b>Name</b> <b>String</b> <b>Values</b>
                     section.  There can be multiple lines with the same <u>object_type</u> string  that  will  form  a
                     block of entries (each with a different <u>object_name</u> entry).
              <u>object_name</u>
                     These  are  the object names of the specific X-server resource such as <b>PRIMARY</b>, <b>CUT_BUFFER0</b>
                     etc. They are generally defined in the X-server source code (<u>protocol.txt</u> and  <u>BuiltInAtoms</u>
                     in  the  dix  directory  of the xorg-server source package).  The entry can contain '*' for
                     wildcard matching or '?' for substitution.  Note that if the '*' is  used,  then  be  aware
                     that  the order of entries in the file is important. The '*' on its own is used to ensure a
                     default fallback context is assigned and should be the last entry in the <u>object_type</u> block.
              <u>context</u>
                     The security context that will be applied to the object.

       Example 1:

       # object_type  object_name  context
       selection      PRIMARY      system_u:object_r:clipboard_xselection_t:s0
       selection      *            system_u:object_r:xselection_t:s0

       Example 2 - This example shows how a client entry can be configured to ensure an entry is always found:

       # object_type  object_name  context
       client         *            system_u:object_r:remote_t:s0

</pre><h4><b>NOTES</b></h4><pre>
       1.  Properties and selections are marked as either polyinstantiated or not. For  these  name  types,  the
           "POLY"  option  searches  only  the  names  marked  as being polyinstantiated, while the other option
           searches only the names marked as not being polyinstantiated. Users of  the  interface  should  check
           both mappings, optionally taking action based on the result (e.g. polyinstantiating the object).

       2.  If  contexts  are  to  be  validated,  then the global option <b>SELABEL_OPT_VALIDATE</b> must be set before
           calling <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3). If this is not set, then it  is  possible  for  an  invalid  context  to  be
           returned.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/selinux.8.html">selinux</a></b>(8), <b><a href="../man3/selabel_open.3.html">selabel_open</a></b>(3), <b><a href="../man3/selabel_lookup.3.html">selabel_lookup</a></b>(3), <b><a href="../man3/selabel_stats.3.html">selabel_stats</a></b>(3), <b><a href="../man3/selabel_close.3.html">selabel_close</a></b>(3),
       <b><a href="../man3/selinux_set_callback.3.html">selinux_set_callback</a></b>(3), <b><a href="../man3/selinux_x_context_path.3.html">selinux_x_context_path</a></b>(3), <b><a href="../man3/freecon.3.html">freecon</a></b>(3), <b><a href="../man5/selinux_config.5.html">selinux_config</a></b>(5)

Security Enhanced Linux                            29 Nov 2011                                      <u><a href="../man5/selabel_x.5.html">selabel_x</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>