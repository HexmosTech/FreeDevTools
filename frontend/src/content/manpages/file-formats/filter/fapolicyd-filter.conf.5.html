<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fapolicyd-filter.conf - fapolicyd filter configuration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/fapolicyd">fapolicyd_1.3.4-1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       fapolicyd-filter.conf - fapolicyd filter configuration file

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  file  <u>/etc/fapolicyd/fapolicyd-filter.conf</u>  contains configuration of the filter for the application
       allowlisting daemon. This filter specifies an allow or exclude list of files from a trust  source.  Valid
       line  starts  with  character  '+',  '-'  or  '#'  for  comments.  The  rest  of the line contains a path
       specification. Space can be used as indentation to add more specific filters to the previous  one.  Note,
       that  only one space is required for one level of an indent. If  there are multiple specifications on the
       same indentation level they extend the previous line with lower indentation, usually  a  directory.   The
       path may be specified using the glob pattern. A directory specification has to end with a slash ‘/’.

       The  filters  are  processed  as follows: Starting from the up the to bottom while in case of a match the
       result (+/-) is set unless there is an indented block which describes more detailed specification of  the
       parent level match. The same processing logic is applied to the inner filters definitions. If there is no
       match, the parent’s result is set. If there is no match at all, the default result is minus (-).

       If  the  result  was a plus (+), the respective file from a trust source is imported to the TrustDB. Vice
       versa, if the result was a minus (-), the respective file is not imported.

       From a performance point of view it is better to design an indented filter because in the ideal situation
       each component of the path is compared only once. In contrast to it, a filter without any indentation has
       to contain a full path which makes  the  pattern  more  complicated  and  thus  slower  to  process.  The
       motivation  behind  this is to have a flexible configuration and keep the TrustDB as small as possible to
       make the look-ups faster.

       <b>#</b> <b>this</b> <b>is</b> <b>simple</b> <b>allow</b> <b>list</b>
       <b>-</b> <b>/usr/bin/some_binary1</b>
       <b>-</b> <b>/usr/bin/some_binary2</b>
       <b>+</b> <b>/</b>

       <b>#</b> <b>this</b> <b>is</b> <b>the</b> <b>same</b>
       <b>+</b> <b>/</b>
        <b>+</b> <b>usr/bin/</b>
         <b>-</b> <b>some_binary1</b>
         <b>-</b> <b>some_binary2</b>

       <b>#</b> <b>this</b> <b>is</b> <b>similar</b> <b>allow</b> <b>list</b> <b>with</b> <b>a</b> <b>wildcard</b>
       <b>-</b> <b>/usr/bin/some_binary?</b>
       <b>+</b> <b>/</b>

       <b>#</b> <b>this</b> <b>is</b> <b>similar</b> <b>with</b> <b>another</b> <b>wildcard</b>
       <b>+</b> <b>/</b>
        <b>-</b> <b>usr/bin/some_binary*</b>

       <b>#</b> <b>keeps</b> <b>everything</b> <b>except</b> <b>usr/share</b> <b>except</b> <b>python</b> <b>and</b> <b>perl</b> <b>files</b>
       <b>#</b> <b><a href="file:///usr/lib/w3m/cgi-bin/w3mman2html.cgi?ls">/usr/bin/ls</a></b> <b>-</b> <b>result</b> <b>is</b> <b>'+'</b>
       <b>#</b> <b>/usr/share/something</b> <b>-</b> <b>result</b> <b>is</b> <b>'-'</b>
       <b>#</b> <b>/usr/share/abcd.py</b> <b>-</b> <b>result</b> <b>is</b> <b>'+'</b>
       <b>+</b> <b>/</b>
        <b>-</b> <b>usr/share/</b>
         <b>+</b> <b>*.py</b>
         <b>+</b> <b>*.pl</b>

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/fapolicyd.8.html">fapolicyd</a></b>(8), <b><a href="../man1/fapolicyd-cli.1.html">fapolicyd-cli</a></b>(1) <b><a href="../man5/fapolicy.rules.5.html">fapolicy.rules</a></b>(5) and <b><a href="../man7/glob.7.html">glob</a></b>(7)

</pre><h4><b>AUTHOR</b></h4><pre>
       Radovan Sroka

Red Hat                                             June 2023                          <u>FAPOLICYD_FILTER.CONF:</u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>