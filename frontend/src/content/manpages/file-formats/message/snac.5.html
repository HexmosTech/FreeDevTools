<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>snac — message formatting and file format documentation</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/snac2">snac2_2.75-2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       snac — message formatting and file format documentation

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>snac</b> daemon processes messages from other servers in the Fediverse using the ActivityPub protocol.

       This  manual describes the allowed formatting of note messages and the disk storage layout of <b>snac</b> server
       and user data. For the operation manual, see <u><a href="../man1/snac.1.html">snac</a></u>(1).  For the administration manual, see <u><a href="../man8/snac.8.html">snac</a></u>(8).

   <b>Message</b> <b>Formatting</b>
       Message notes respect the entered new line breaks rigurously.  A special subset of Markdown  is  allowed,
       including:

       bold        **text between two pairs of asterisks**

       italic      *text between a pair of asterisks*

       strikethrough text
                   ~~text between a pair of tildes~~

       underlined text
                   __text between two pairs of underscores__

       code        Text `between backticks` is formatted as code.

                   ```
                   /* text between lines with only three backticks is preformatted */
                   int main(int argc, char *argv[])
                   {
                       return 0;
                   }

                   ```

       links       Standalone  URLs are converted to links. Also, from version 2.54, markdown-style links in the
                   form of [link label](url) are also supported.

       attached images
                   Standalone URLs for which the final extension is recognized as an image  (.jpg,  .gif,  .png,
                   etc), are converted to ActivityPub image attachments. Also, from version 2.57, markdown-style
                   image links in the form of ![alt text](image url) are also supported.

       line separators
                   Horizonal rules can be inserted by typing three minus symbols alone in a line.

       quoted text
                   Lines starting with &gt;.

       headers     One,  two  or three # at the beginning of a line plus a space plus some text are converted to
                   HTML headers.

       user mentions
                   Strings in the format @user@host are requested using the Webfinger protocol and converted  to
                   links and mentions if something reasonable is found.

       emoticons /emojis / smileys / silly symbols
                   (Note:  from  version  2.51, these symbols are configurable by the instance administrator, so
                   the available ones may differ).

                   The following traditional ASCII emoticons or special strings are converted to related emojis:

                   :-) :-D X-D ;-) B-) :-( :-* &lt;3 :-/ 8-o
                   %-) :_( :-| &gt;:-( :facepalm: :shrug: :shrug2:
                   :eyeroll: :beer: :beers: :munch: :thumb:

   <b>Accepted</b> <b>HTML</b>
       All HTML tags in entries are neutered except the following ones:

       a p br blockquote ul ol li cite small h2 h3
       span i b u s pre code em strong hr img del

   <b>Disk</b> <b>Layout</b>
       This section documents version 2.7 of the disk storage layout.

       The base directory contains the following files and folders:

       <u>server.json</u>
                   Server configuration.

       <u>user/</u>       Directory holding user subdirectories.

       <u>object/</u>     Directory holding the ActivityPub objects. Filenames are hashes of each message Id, stored in
                   subdirectories starting with the first two letters of the hash.

       <u>queue/</u>      This directory contains the global queue of input/output messages as JSON files.  File  names
                   contain  timestamps  that  indicate  when  the message will be sent. Messages not accepted by
                   their respective servers will be re-enqueued for later retransmission until a maximum  number
                   of retries is reached, then discarded.

       <u>inbox/</u>      Directory storing collected inbox URLs from other instances.

       <u>archive/</u>    If  this directory exists, all input and output messages are logged inside it, including HTTP
                   headers. Only useful for debugging. May grow to enormous sizes.

       <u>error/</u>      If this directory exists, HTTP signature check error headers are logged  here.   Only  useful
                   for debugging.

       <u>log/</u>        If this directory exists, log messages are also stored there in daily files.

       <u>app/</u>        This directory stores Mastodon API apps.

       <u>token/</u>      This directory stores Mastodon API tokens.

       <u>style.css</u>   The server-wide CSS. The content of this file is inserted into the HTML output unless a user-
                   specific one exist in the user's <u>static/</u> folder.

       <u>greeting.html</u>
                   This file is served when the server base URL is requested from a web browser. See <u><a href="../man8/snac.8.html">snac</a></u>(8) for
                   more information about the customization options.

       <u>public.idx</u>  This file contains the list of public posts from all users in the server.

       <u>filter_reject.txt</u>
                   This  (optional)  file contains a list of regular expressions, one per line, to be applied to
                   the content of all incoming posts; if any of them match, the post is  rejected.  This  brings
                   the flexibility and destruction power of regular expressions to your Fediverse experience. To
                   be used wisely (see <u><a href="../man8/snac.8.html">snac</a></u>(8) for more information).

       <u>announcement.txt</u>
                   If  this file is present, an announcement will be shown to logged in users on every page with
                   its contents. It is  also  available  through  the  Mastodon  API.   Users  can  dismiss  the
                   announcement,  which  works by storing the modification time in the "last_announcement" field
                   of the <u>user.json</u> file. When the file is modified, the announcement will then reappear. It can
                   contain only text and will be ignored if it has more than 2048 bytes.

       Each user directory is a subdirectory of <u>BASEDIR/user/</u>,  has  the  user  id  as  name  and  contains  the
       following subdirectories and files:

       <u>user.json</u>   User configuration file.

       <u>user_o.json</u>
                   User  configuration  override file. This file is intended for administrators to override some
                   user preferences. For current version, the fields that can be overridden are 'purge_days' and
                   'email'.

       <u>key.json</u>    Secret/public key PEM data.

       <u>followers.idx</u>
                   This file contains the list of followers as a list of hashed object identifiers.

       <u>followers/</u>  This directory stores hard links to the actor objects in the object storage.

       <u>following/</u>  This directory stores the users being followed as hard links  to  the  'Follow'  or  'Accept'
                   objects in the object storage. File names are the hashes of each actor Id.

       <u>private/</u>    This directory stores hard links to the timeline entries in the object storage.

       <u>private.idx</u>
                   This file contains the list of timeline entries as a list of hashed object identifiers.

       <u>public/</u>     This directory stores hard links to the public timeline entries in the object storage.

       <u>public.idx</u>  This  file  contains  the  list  of  public  timeline  entries  as  a  list  of hashed object
                   identifiers.

       <u>pinned/</u>     This directory stores hard links to pinned posts.

       <u>pinned.idx</u>  This file contains the list of pinned posts as a list of hashed object identifiers.

       <u>bookmark/</u>   This directory stores hard links to bookmarked posts.

       <u>bookmark.idx</u>
                   This file contains the list of pinned posts as a list of hashed object identifiers.

       <u>draft/</u>      This directory stores post drafts.

       <u>draft.idx</u>   This file contains the list of drafts as a list of hashed object identifiers.

       <u>muted/</u>      This directory contains files which names are hashes of muted actors. The content is  a  line
                   containing  the actor URL.  Messages from these actors will be ignored on input and not shown
                   in any timeline.

       <u>hidden/</u>     This directory contains references to the hidden timeline entries.

       <u>limited/</u>    This directory contains references to the actor URLs for limited users (those being  followed
                   but with their boosts blocked).

       <u>queue/</u>      This  directory  contains  the  output queue of messages generated by the user as JSON files.
                   File names contain timestamps that indicate when the  message  will  be  sent.  Messages  not
                   accepted  by  their  respective  servers will be re-enqueued for later retransmission until a
                   maximum number of retries is reached, then discarded.

       <u>static/</u>     Files in this directory are served as-is when requested from the <u>https://HOST/USER/s/...</u>  URL
                   path.  A  special file named <u>style.css</u> can contain user-specific CSS code to be inserted into
                   the HTML of the web interface.

       <u>history/</u>    This directory contains generated HTML files. They may be snapshots of the local timeline  in
                   previous months or other cached data.

       <u>export/</u>     This  directory  will contain exported data in Mastodon-compatible CSV format after executing
                   the 'export_csv' command-line operation.

       <u>import/</u>     Mastodon-compatible CSV files must be copied into this directory to use any of the  importing
                   functions.

       <u>server.pid</u>  This file stores the server PID in a single text line.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/snac.1.html">snac</a></u>(1), <u><a href="../man8/snac.8.html">snac</a></u>(8)

</pre><h4><b>AUTHORS</b></h4><pre>
       grunfink <u>@<a href="mailto:grunfink@comam.es">grunfink@comam.es</a></u>: https://comam.es/snac/grunfink

</pre><h4><b>LICENSE</b></h4><pre>
       See the LICENSE file for details.

Debian                                             $Mdocdate$                                            <u><a href="../man5/SNAC.5.html">SNAC</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>