<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>actions - Shorewall action declaration file</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/shorewall">shorewall_5.2.8-6_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       actions - Shorewall action declaration file

</pre><h4><b>SYNOPSIS</b></h4><pre>

       <b>/etc/shorewall[6]/actions</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       This file allows you to define new ACTIONS for use in rules (see <b><a href="../man5/shorewall-rules.5.html">shorewall-rules</a>(5)</b>[1]). You define the
       iptables rules to be performed in an ACTION in /etc/shorewall/action.<u>action-name</u>.

       Columns are:

       NAME
           The name of the action. ACTION names should begin with an upper-case letter to distinguish them from
           Shorewall-generated chain names and be composed of letters, digits or numbers. If you intend to log
           from the action then the name must be no longer than 11 characters in length if you use the standard
           LOGFORMAT.

       OPTIONS
           Added in Shorewall 4.5.10. Available options are:

           <b>audit</b>
               Added in Shorewall 5.0.7. When this option is specified, the action is expected to have at least
               two parameters; the first is a target and the second is either 'audit' or omitted. If the second
               is 'audit', then the first must be an auditable target (ACCEPT, DROP or REJECT).

           <b>builtin</b>
               Added in Shorewall 4.5.16. Defines the action as a rule target that is supported by your iptables
               but is not directly supported by Shorewall. The action may be used as the rule target in an
               INLINE rule in <b>shorewall-rules</b>[1](5).

               Beginning with Shorewall 4.6.0, the Netfilter table(s) in which the <b>builtin</b> can be used may be
               specified: <b>filter</b>, <b>nat</b>, <b>mangle</b> and <b>raw</b>. If no table name(s) are given, then <b>filter</b> is assumed.
               The table names follow <b>builtin</b> and are separated by commas; for example, "FOOBAR
               builtin,filter,mangle" would specify FOOBAR as a builtin target that can be used in the filter
               and mangle tables.

               Beginning with Shorewall 4.6.4, you may specify the <b>terminating</b> option with <b>builtin</b> to indicate
               to the Shorewall optimizer that the action is terminating (the current packet will not be passed
               to the next rule in the chain).

           <b>inline</b>
               Causes the action body (defined in action.<u>action-name</u>) to be expanded in-line like a macro rather
               than in its own chain. You can list Shorewall Standard Actions in this file to specify the <b>inline</b>
               option.

                   <b>Caution</b>
                   Some of the Shorewall standard actions cannot be used in-line and will generate a warning and
                   the compiler will ignore <b>inline</b> if you try to use them that way:
                       DropSmurfs
                       IfEvent
                       Invalid (Prior to Shorewall 4.5.13)
                       NotSyn (Prior to Shorewall 4.5.13)
                       RST (Prior to Shorewall 4.5.13)
                       TCPFlags

           <b>logjump</b>
               Added in Shorewall 5.0.8. Performs the same function as <b>nolog</b> (below), with the addition that the
               jump to the actions chain is logged if a log level is specified on the action invocation. For
               inline actions, this option is identical to <b>nolog</b>.

           <b>mangle</b>
               Added in Shorewall 5.0.7. Specifies that this action is to be used in <b><a href="../man5/shorewall-mangle.5.html">shorewall-mangle</a>(5)</b>[2]
               rather than <b><a href="../man5/shorewall-rules.5.html">shorewall-rules</a>(5)</b>[1].

           <b>nat</b>
               Added in Shorewall 5.0.13. Specifies that this action is to be used in <b><a href="../man5/shorewall-snat.5.html">shorewall-snat</a>(5)</b>[3]
               rather than <b><a href="../man5/shorewall-rules.5.html">shorewall-rules</a>(5)</b>[1]. The <b>mangle</b> and <b>nat</b> options are mutually exclusive.

           <b>noinline</b>
               Causes any later <b>inline</b> option for the same action to be ignored with a warning.

           <b>nolog</b>
               Added in Shorewall 4.5.11. When this option is specified, the compiler does not automatically
               apply the log level and/or tag from the invocation of the action to all rules inside of the
               action. Rather, it simply sets the $_loglevel and $_logtag shell variables which can be used
               within the action body to apply those logging options only to a subset of the rules.

           <b>proto</b>=<u>protocol</u>
               Added in Shorewall 5.1.10. Specifies that the action is only usable with the specified <u>protocol</u>
               (name or number). When the action is invoked with no protocol specified in the PROTO column, or
               if the action is used as a Policy Action, the named <u>protocol</u> will be assumed. If a protocol is
               specified in the PROTO column of an invocation, then it must match the named <u>protocol</u>.

               The <b>proto</b> option has no effect if the <b>inline</b> or <b>builtin</b> option is specified. A warning is issued
               if <b>proto</b> is specified along with <b>builtin</b>.

           <b>dport</b>=<u>portorservice</u>
               Added in Shorewall 5.2.6. Requires that the <b>proto</b> option be previously given and indicates that
               this action may only be applied to flows with the specified <u>protocol</u> and <u>portorservice</u>.
               <u>portorservice</u> may be a valid port number or the name of a service defined in <a href="file:/etc/services">/etc/services</a> to be
               usable with the specified <u>protocol</u>. If a port or service is specified in the DPORT column of an
               invocation, then it must match the named <u>portorservice</u>.

           <b>section</b>
               Added in Shorewall 5.1.1. When specified, this option causes the rules file section name and a
               comma to be prepended to the parameters passed to the action (if any). Note that this means that
               the first parameter passed to the action by the user is actually the second parameter to the
               action. If the action is invoked out of the blrules file, 'BLACKLIST' is used as the section
               name.

               Given that neither the snat nor the mangle file is sectioned, this parameter has no effect when
               <b>mangle</b> or <b>nat</b> is specified.

           <b>state</b>={<b>UNTRACKED</b>|<b>NEW</b>|<b>ESTABLISHED</b>|<b>RELATED</b>|<b>INVALID</b>}
               Added in Shorewall 5.0.7. Reserved for use by Shorewall in actions.std.

           <b>terminating</b>
               Added in Shorewall 4.6.4. When used with <b>builtin</b>, indicates that the built-in action is
               termiating (i.e., if the action is jumped to, the next rule in the chain is not evaluated).

</pre><h4><b>FILES</b></h4><pre>
       /etc/shorewall/actions

       /etc/shorewall6/actions

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b>https://shorewall.org/Actions.html</b>[4]

       <a href="../man8/shorewall.8.html">shorewall</a>(8)

</pre><h4><b>NOTES</b></h4><pre>
        1. <a href="../man5/shorewall-rules.5.html">shorewall-rules</a>(5)
           https://shorewall.org/manpages/shorewall-rules.html

        2. <a href="../man5/shorewall-mangle.5.html">shorewall-mangle</a>(5)
           https://shorewall.org/manpages/shorewall-mangle.html

        3. <a href="../man5/shorewall-snat.5.html">shorewall-snat</a>(5)
           https://shorewall.org/manpages/shorewall-snat.html

        4. https://shorewall.org/Actions.html
           https://shorewall.org/Actions.html

Configuration Files                                09/24/2020                               <u><a href="../man5/SHOREWALL-ACTIONS.5.html">SHOREWALL-ACTIONS</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>