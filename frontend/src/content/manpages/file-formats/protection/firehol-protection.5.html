<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>firehol-protection - add extra protections to a definition</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/firehol-doc">firehol-doc_3.1.8+ds-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       firehol-protection - add extra protections to a definition

</pre><h4><b>SYNOPSIS</b></h4><pre>
       protection [reverse] strong [<u>requests/period</u> [<u>burst</u>]]

       protection [reverse] <u>flood-protection-type</u> [<u>requests/period</u> [<u>burst</u>]]

       protection [reverse] { bad-packets | <u>packet-protection-type</u> }

       protection [reverse] connlimit <u>connections</u> [mask <u>prefix</u>]

       protection  [reverse]  connrate  <u>rate</u>  [burst  <u>amount</u>] [srcmask <u>prefix</u>] [htable-size <u>buckets</u>] [htable-max
       <u>entries</u>] [htable-expire <u>msec</u>] [htable-gcinterval <u>msec</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The protection subcommand sets protection rules on an interface or router.

       Flood protections honour the values <u>requests/period</u> and <u>burst</u>.  They  are  used  to  limit  the  rate  of
       certain types of traffic.

       The  default  rate  FireHOL  uses is 100 operations per second with a burst of 50.  Run iptables -m limit
       --help for more information.

       The protection type strong will switch on all protections (both  packet  and  flood  protections)  except
       all-floods.  It has aliases full and all.

       The protection type bad-packets will switch on all packet protections but not flood protections.

       You  can  specify  multiple  protection  types by using multiple protection commands or by using a single
       command and enclosing the types in quotes.

              <b>Note</b>

              On a router, protections are normally set up on inface.

              The reverse option will set up the protections on outface.  You must use it as the first keyword.

</pre><h4><b>PACKET</b> <b>PROTECTION</b> <b>TYPES</b></h4><pre>
       bad-packets:
              Drops all the bad packets detected by these rules.

       invalid
              Drops all incoming invalid packets, as detected INVALID by the connection tracker.

              See also FIREHOL_DROP_INVALID in  <a href="../man5/firehol-defaults.conf.5.html">firehol-defaults.conf</a>(5)  which  allows  setting  this  function
              globally.

       fragments
              Drops all packet fragments.

              This  rule  will  probably  never  match  anything  since  <a href="../man8/iptables.8.html">iptables</a>(8)  reconstructs  all  packets
              automatically before the firewall rules are processed whenever connection tracking is running.

       new-tcp-w/o-syn
              Drops all TCP packets that initiate a socket but have not got the SYN flag set.

       malformed-xmas
              Drops all TCP packets that have all TCP flags set.

       malformed-null
              Drops all TCP packets that have all TCP flags unset.

       malformed-bad
              Drops all TCP packets that have illegal combinations of TCP flags set.

   <b>EXAMPLES</b>
              protection bad-packets

</pre><h4><b>FLOOD</b> <b>PROTECTION</b> <b>TYPES</b></h4><pre>
       icmp-floods [<u>requests/period</u> [<u>burst</u>]]
              Allows only a certain amount of ICMP echo requests.

       syn-floods [<u>requests/period</u> [<u>burst</u>]]
              Allows only a certain amount of new TCP connections.

              Be careful to not set the rate too low as the rule is applied to  all  connections  regardless  of
              their final result (rejected, dropped, established, etc).

       all-floods [<u>requests/period</u> [<u>burst</u>]]
              Allows only a certain amount of new connections.

              Be  careful  to  not  set the rate too low as the rule is applied to all connections regardless of
              their final result (rejected, dropped, established, etc).

   <b>EXAMPLES</b>
              protection all-floods 90/sec 40

</pre><h4><b>CLIENT</b> <b>LIMITING</b> <b>TYPES</b></h4><pre>
       These protections were added in v3.

       These protections are used to limit the connections client make, per interface or router.

       They support appending optional rule parameters to limit their scope to certain clients only.

       protection [reverse] connlimit <u>connections</u> [mask <u>prefix</u>]
              Allow only a number of connections per client (implemented with connlimit with fixed type=<u>saddr</u>).

       protection [reverse] connrate <u>rate</u> [burst <u>amount</u>] [srcmask <u>prefix</u>] [htable-size <u>buckets</u>] [htable-max
       <u>entries</u>] [htable-expire <u>msec</u>] [htable-gcinterval <u>msec</u>]
              Allow up to a rate of new connections per client (implemented with hashlimit with fixed  type=<u>upto</u>
              and mode=<u>srcip</u>).

   <b>EXAMPLES</b>
       Limit the number of concurrent connections to 10 per client

              protection connlimit 10 mask 32

       Limit the number of concurrent connections to 100 per client class-C and also limit it to 5 for 1.2.3.4

              protection connlimit 100 mask 24
              protection connlimit 5 src 1.2.3.4

       In  the  last  example  above,  if  you want to give client 1.2.3.4 more connections than all others, you
       should exclude it from the first connlimit statement, like this:

              protection connlimit 100 mask 24 src not 1.2.3.4
              protection connlimit 200 src 1.2.3.4

       Limit all clients to 10 concurrent connections and 60 connections/minute

              protection connlimit 10
              protection connrate 60/minute

</pre><h4><b>KNOWN</b> <b>ISSUES</b></h4><pre>
       When using multiple types in a single command, if the quotes  are  forgotten,  incorrect  rules  will  be
       generated without warning.

       When  using  multiple types in a single command, FireHOL will silently ignore any types that come after a
       group type (bad-packets, strong and its aliases).  Only use group types on their own line.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       • <a href="../man1/firehol.1.html">firehol</a>(1) - FireHOL program

       • <a href="../man5/firehol.conf.5.html">firehol.conf</a>(5) - FireHOL configuration

       • <a href="../man5/firehol-interface.5.html">firehol-interface</a>(5) - interface definition

       • <a href="../man5/firehol-router.5.html">firehol-router</a>(5) - router definition

       • FireHOL Website

       • FireHOL Online PDF Manual

       • FireHOL Online Documentation

</pre><h4><b>AUTHORS</b></h4><pre>
       FireHOL Team.

FireHOL Reference                               Built 13 Apr 2025                          <u><a href="../man5/firehol-protection.5.html">firehol-protection</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>