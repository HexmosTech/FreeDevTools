<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>firehol-cthelper - control connection tracking helpers</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/firehol-doc">firehol-doc_3.1.8+ds-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       firehol-cthelper - control connection tracking helpers

</pre><h4><b>SYNOPSIS</b></h4><pre>
       { cthelper | cthelper4 | cthelper6 } <u>protocol</u> <u>helper</u> <u>where</u> [<u>rule-params</u>]

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  netfilter team has included in the Linux kernel protocol helpers that monitor traffic and allow them
       to work under the connection tracker.

       The following protocol helpers have been provided:

       • amanda

       • ftp

       • tftp (cannot be configured)

       • h323 (cannot be configured)

       • irc (does not support IPv6)

       • netbios_ns (cannot be configured)

       • pptp (does not support IPv6)

       • gre (cannot be configured)

       • sane

       • sip

       By default, the helpers will trust either side of the communication.  This is considered a security issue
       and should be avoided.

       Using cthelper the helpers that can be configured, can be instructed to trust  a  specific  side  of  the
       communication.

       Before doing so, the variable FIREHOL_CONNTRACK_HELPERS_ASSIGNMENT should be set to manual.

       where defines where the trusted traffic is expected.  It can be:

       • IN, INPUT, or PREROUTING to match incoming packets

       • OUT, OUTPUT to match outgoing packets

       • BOTH, BIDIRECTIONAL, or INOUT to match all packets

       The  <u>rule-params</u>  define  a  set of rule parameters to further restrict the traffic that is matched.  See
       <a href="../man5/firehol-params.5.html">firehol-params</a>(5) for more details.

       FIREHOL_CONNTRACK_HELPERS_ASSIGNMENT accepts the following values:

       • kernel which is the default, allows the kernel to determine by itself which side to trust.

       • firehol to have FireHOL automatically generate cthelper statements keeping src, dst, inface and outface
         from the statements that require each helper.  Keep in mind this will only generate valid statements if
         you don’t use NAT at all.  cthelper statements are executed by iptables  before  any  NAT  is  applied,
         while packet filtering is configured after DNAT and before SNAT, resulting in wrong statements when NAT
         is applied.

       • manual to use the cthelper helper to configure the trusts in firehol.conf.

       When  set  to  kernel, FireHOL will set net.netfilter.nf_conntrack_helper=1.  In all other cases, FireHOL
       will set net.netfilter.nf_conntrack_helper=0.

</pre><h4><b>EXAMPLES</b></h4><pre>
               # enable manual protocol helpers mode
               FIREHOL_CONNTRACK_HELPERS_ASSIGNMENT="manual"

               # trust SIP packets we send via interface dsl0
               cthelper sip out outface dsl0

               # trust SIP packets we receive from 10.0.0.1 via eth0
               cthelper sip in inface eth0 src 10.0.0.1

               # trust pptp packets we send via interface wan0 (IPv4 only)
               cthelper4 pptp out outface wan0

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       • <a href="../man1/firehol.1.html">firehol</a>(1) - FireHOL program

       • <a href="../man5/firehol.conf.5.html">firehol.conf</a>(5) - FireHOL configuration

       • FireHOL Website

       • FireHOL Online PDF Manual

       • FireHOL Online Documentation

</pre><h4><b>AUTHORS</b></h4><pre>
       FireHOL Team.

FireHOL Reference                               Built 13 Apr 2025                            <u><a href="../man5/firehol-cthelper.5.html">firehol-cthelper</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>