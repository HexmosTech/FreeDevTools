<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>poolset - persistent memory pool configuration file format</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/libpmem1">libpmem1_1.13.1-1.1ubuntu2_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       poolset - persistent memory pool configuration file format

</pre><h4><b>SYNOPSIS</b></h4><pre>
              mypool.set

</pre><h4><b>DESCRIPTION</b></h4><pre>
       Depending on the configuration of the system, the available non-volatile memory space may be divided into
       multiple  memory devices.  In such case, the maximum size of the transactional object store could be lim‐
       ited by the capacity of a single memory device.  Therefore,  <b><a href="../man7/libpmemobj.7.html">libpmemobj</a></b>(7),  <b><a href="../man7/libpmemblk.7.html">libpmemblk</a></b>(7)  and  <b>libpmem‐</b>
       <b><a href="../man7/log.7.html">log</a></b>(7)  allow  building  object  stores spanning multiple memory devices by creation of persistent memory
       pools consisting of multiple files, where each part of such a <u>pool</u> <u>set</u> may be stored on a different pmem-
       aware filesystem.

       To improve reliability and eliminate single point of failure, <b><a href="../man7/libpmemobj.7.html">libpmemobj</a></b>(7)  also  allows  all  the  data
       written to a persistent memory pool to be copied to local pool <u>replicas</u>, thereby providing backup for the
       persistent  memory  pool by producing a <u>mirrored</u> <u>pool</u> <u>set</u>.  In practice, the pool replicas may be consid‐
       ered as binary copies of the “master” pool set.  Data replication is not supported in  <b><a href="../man7/libpmemblk.7.html">libpmemblk</a></b>(7)  and
       <b><a href="../man7/libpmemlog.7.html">libpmemlog</a></b>(7).

       The <u>set</u> file for each type of pool is a plain text file.  Lines in the file are formatted as follows:

       • The first line of the file must be the literal string “PMEMPOOLSET”

       • The pool parts are specified, one per line, in the format:

         <u>size</u> <u>pathname</u>

       • <u>Replica</u>  sections,  if  any, start with the literal string “REPLICA”.  See <b>REPLICAS</b>, below, for further
         details.

       • Pool set options, if any, start with literal string <u>OPTION</u>.  See <b>POOL</b> <b>SET</b> <b>OPTIONS</b> below for details.

       • Lines starting with “#” are considered comments and are ignored.

       The <u>size</u> must be compliant with the format specified in IEC 80000-13, IEEE 1541 or the Metric Interchange
       Format.  These standards accept SI units with obligatory B - kB, MB, GB, ...  (multiplier by  1000)  suf‐
       fixes, and IEC units with optional “iB” - KiB, MiB, GiB, ..., K, M, G, ... - (multiplier by 1024) suffix‐
       es.

       <u>pathname</u> must be an absolute pathname.

       The  <u>pathname</u> of a part can point to a Device DAX.  Device DAX is the device-centric analogue of Filesys‐
       tem DAX.  It allows memory ranges to be allocated and mapped without need of an intervening file system.

       Pools created on Device DAX have additional options and restrictions:

       • The <u>size</u> may be set to “AUTO”, in which case the size of the device will be automatically  resolved  at
         pool creation time.

       • To  concatenate  more than one Device DAX device into a single pool set, the configured internal align‐
         ment of the devices must be 4KiB, unless the <u>SINGLEHDR</u> or <u>NOHDRS</u> option is used in the pool  set  file.
         See <b>POOL</b> <b>SET</b> <b>OPTIONS</b> below for details.

       Please  see  <b><a href="../man1/ndctl-create-namespace.1.html">ndctl-create-namespace</a></b>(1) for more information on Device DAX, including how to configure de‐
       sired alignment.

       The minimum file size of each part of the pool set is defined as follows:

       • For block pools, as <b>PMEMBLK_MIN_PART</b> in <b>&lt;libpmemblk.h&gt;</b>

       • For object pools, as <b>PMEMOBJ_MIN_PART</b> in <b>&lt;libpmemobj.h&gt;</b>

       • For log pools, as <b>PMEMLOG_MIN_PART</b> in <b>&lt;libpmemlog.h&gt;</b>

       The net pool size of the pool set is equal to:

              net_pool_size = sum_over_all_parts(page_aligned_part_size - 4KiB) + 4KiB

       where

              page_aligned_part_size = part_size &amp; ~(page_size - 1)

       Note that page size is OS specific.  For more information please see <b><a href="../man3/sysconf.3.html">sysconf</a></b>(3).

       The minimum net pool size of a pool set is defined as follows:

       • For block pools, as <b>PMEMBLK_MIN_POOL</b> in <b>&lt;libpmemblk.h&gt;</b>

       • For object pools, as <b>PMEMOBJ_MIN_POOL</b> in <b>&lt;libpmemobj.h&gt;</b>

       • For log pools, as <b>PMEMLOG_MIN_POOL</b> in <b>&lt;libpmemlog.h&gt;</b>

       Here is an example “mypool.set” file:

              PMEMPOOLSET
              OPTION NOHDRS
              100G /mountpoint0/myfile.part0
              200G /mountpoint1/myfile.part1
              400G /mountpoint2/myfile.part2

       The files in the set may be created by running one of the following commands.  To create a block pool:

              $ pmempool create blk &lt;bsize&gt; mypool.set

       To create a log pool:

              $ pmempool create log mypool.set

</pre><h4><b>REPLICAS</b></h4><pre>
       Sections defining replica sets are optional.  There may be multiple replica sections.

       Replica sections begin with a line containing only the literal string “REPLICA”, followed by one or  more
       pool part lines as described above.

       Here is an example “myobjpool.set” file with replicas:

              PMEMPOOLSET
              100G /mountpoint0/myfile.part0
              200G /mountpoint1/myfile.part1
              400G /mountpoint2/myfile.part2

              # local replica
              REPLICA
              500G /mountpoint3/mymirror.part0
              200G /mountpoint4/mymirror.part1

       The files in the object pool set may be created by running the following command:

              $ pmempool create --layout="mylayout" obj myobjpool.set

</pre><h4><b>POOL</b> <b>SET</b> <b>OPTIONS</b></h4><pre>
       Pool  set  options can appear anywhere after the line with <u>PMEMPOOLSET</u> string.  Pool set file can contain
       several pool set options.  The following options are supported:

       • <u>SINGLEHDR</u>

       If the <u>SINGLEHDR</u> option is used, only the first part in each replica  contains  the  pool  part  internal
       metadata.   In  that  case  the effective size of a replica is the sum of sizes of all its part files de‐
       creased once by 4096 bytes.

       When using the <u>SINGLEHDR</u> option, one can concatenate more than one Device DAX devices with  any  internal
       alignments in one replica.

       Using  the  <u>SINGLEHDR</u> option has important implications for data integrity checking and recoverability in
       case of a pool set damage.  See <b>pmempool_sync</b>() API for more information about pool set recovery.

</pre><h4><b>DIRECTORIES</b></h4><pre>
       Providing a directory as a part’s <u>pathname</u> allows the pool to dynamically create files  and  consequently
       removes the user-imposed limit on the size of the pool.

       The  <u>size</u> argument of a part in a directory poolset becomes the size of the address space reservation re‐
       quired for the pool.  In other words, the size argument is the maximum theoretical size of  the  mapping.
       This value can be freely increased between instances of the application, but decreasing it below the real
       required space will result in an error when attempting to open the pool.

       The  directory  must NOT contain user created files with extension <u>.pmem</u>, otherwise the behavior is unde‐
       fined.  If a file created by the library within the directory is in any way  altered  (resized,  renamed)
       the behavior is undefined.

       A  directory  poolset must exclusively use directories to specify paths - combining files and directories
       will result in an error.  A single replica can consist of one or more directories.  If there are multiple
       directories, the address space reservation is equal to the sum of the sizes.

       The order in which the files are created is unspecified, but the library will try to maintain equal usage
       of the directories.

       By default pools grow in 128 megabyte increments.

       Only poolsets with the <u>SINGLEHDR</u> option can safely use directories.

</pre><h4><b>NOTES</b></h4><pre>
       Creation of all the parts of the pool set and the associated replica sets can be  done  with  the  <b>pmemo‐</b>
       <b><a href="../man3/bj_create.3.html">bj_create</a></b>(3), <b><a href="../man3/pmemblk_create.3.html">pmemblk_create</a></b>(3) or <b><a href="../man3/pmemlog_create.3.html">pmemlog_create</a></b>(3) function, or by using the <b><a href="../man1/pmempool.1.html">pmempool</a></b>(1) utility.

       Restoring  data  from  a replica can be done by using the <b><a href="../man1/pmempool-sync.1.html">pmempool-sync</a></b>(1) command or the <b>pmempool_sync</b>()
       API from the <b><a href="../man7/libpmempool.7.html">libpmempool</a></b>(7) library.

       Modifications of a pool set file configuration can be done by using the <b><a href="../man1/pmempool-transform.1.html">pmempool-transform</a></b>(1) command  or
       the <b>pmempool_transform</b>() API from the <b><a href="../man7/libpmempool.7.html">libpmempool</a></b>(7) library.

       When  creating  a pool set consisting of multiple files, or when creating a replicated pool set, the <u>path</u>
       argument passed to <b><a href="../man3/pmemobj_create.3.html">pmemobj_create</a></b>(3), <b><a href="../man3/pmemblk_create.3.html">pmemblk_create</a></b>(3) or <b><a href="../man3/pmemlog_create.3.html">pmemlog_create</a></b>(3) must point  to  the  special
       <u>set</u> file that defines the pool layout and the location of all the parts of the pool set.

       When opening a pool set consisting of multiple files, or when opening a replicated pool set, the <u>path</u> ar‐
       gument passed to <b><a href="../man3/pmemobj_open.3.html">pmemobj_open</a></b>(3), <b><a href="../man3/pmemblk_open.3.html">pmemblk_open</a></b>(3) or <b><a href="../man3/pmemlog_open.3.html">pmemlog_open</a></b>(3) must point to the same <u>set</u> file that
       was used for pool set creation.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/ndctl-create-namespace.1.html">ndctl-create-namespace</a></b>(1),  <b><a href="../man3/pmemblk_create.3.html">pmemblk_create</a></b>(3), <b><a href="../man3/pmemlog_create.3.html">pmemlog_create</a></b>(3), <b><a href="../man3/pmemobj_create.3.html">pmemobj_create</a></b>(3), <b><a href="../man3/sysconf.3.html">sysconf</a></b>(3), <b>libpmem‐</b>
       <b><a href="../man7/blk.7.html">blk</a></b>(7), <b><a href="../man7/libpmemlog.7.html">libpmemlog</a></b>(7), <b><a href="../man7/libpmemobj.7.html">libpmemobj</a></b>(7) and <b>&lt;https://pmem.io&gt;</b>
</pre>
 </div>
</div></section>
</div>
</body>
</html>