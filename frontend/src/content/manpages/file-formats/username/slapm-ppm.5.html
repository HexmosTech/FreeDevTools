<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ppm (Password Policy Module) - extension of the password policy overlay</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/slapd-contrib">slapd-contrib_2.6.9+dfsg-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ppm (Password Policy Module) - extension of the password policy overlay

</pre><h4><b>SYNOPSIS</b></h4><pre>
       ETCDIR/ppm.example

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>ppm</b>  is  an  OpenLDAP module for checking password quality when they are modified.  Passwords are checked
       against the presence or absence of certain character classes.

       This module is used as an extension of the OpenLDAP password policy controls, see  <a href="../man5/slapo-ppolicy.5.html">slapo-ppolicy</a>(5)  sec‐
       tion <b>pwdCheckModule</b>.

</pre><h4><b>USAGE</b></h4><pre>
       Create a password policy entry and indicate the path of the ppm.so library and the content of the desired
       policy.  Use a base64 tool to code / decode the content of the policy stored into <b>pwdCheckModuleArg</b>.

       Here is an example for OpenLDAP 2.6:

              dn: cn=default,ou=policies,dc=my-domain,dc=com
              objectClass: pwdPolicy
              objectClass: top
              objectClass: pwdPolicyChecker
              objectClass: person
              pwdCheckQuality: 2
              pwdAttribute: userPassword
              sn: default
              cn: default
              pwdMinLength: 6
              pwdCheckModuleArg:: bWluUXVhbGl0eSAzCmNoZWNrUkROIDAKY2hlY2tBdHRyaWJ1dGVzCmZvcmJpZGRlbkNoYXJzCm1heENvbnNlY3V0aXZlUGVyQ2xhc3MgMAp1c2VDcmFja2xpYiAwCmNyYWNrbGliRGljdCAvdmFyL2NhY2hlL2NyYWNrbGliL2NyYWNrbGliX2RpY3QKY2xhc3MtdXBwZXJDYXNlIEFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaIDAgMSAwCmNsYXNzLWxvd2VyQ2FzZSBhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiAwIDEgMApjbGFzcy1kaWdpdCAwMTIzNDU2Nzg5IDAgMSAwCmNsYXNzLXNwZWNpYWwgPD4sPzsuOi8hwqfDuSUqwrVewqgkwqPCsibDqX4iIyd7KFstfMOoYF9cw6dew6BAKV3CsD19KyAwIDEgMAoK
              pwdUseCheckModule: TRUE

       For  OpenLDAP  2.5,  you  must  add  a  <b>pwdCheckModule</b>  attribute pointing to the ppm module (for example
       /usr/local/lib/ppm.so), and remove the <b>pwdUseCheckModule</b> attribute.

       See <b>slapo-ppolicy</b> for more information, but to sum up:

       • enable ppolicy overlay in your database.

       • define a default password policy in OpenLDAP configuration or use pwdPolicySubentry attribute to  point
         to the given policy.

       This example show the activation for a <b>slapd.conf</b> file for OpenLDAP 2.6 (see <b>slapd-config</b> and <b>slapo-ppol‐</b>
       <b>icy</b> for more information for <b>cn=config</b> configuration)

              overlay ppolicy
              ppolicy_default "cn=default,ou=policies,dc=my-domain,dc=com"
              ppolicy_check_module /usr/local/openldap/libexec/openldap/ppm.so
              #ppolicy_use_lockout   # for having more infos about the lockout

       For  OpenLDAP 2.5, you must remove <b>ppolicy_check_module</b> parameter as it is managed in the password policy
       definition

</pre><h4><b>FEATURES</b></h4><pre>
       Here are the main features:

       • 4 character classes are defined by default: upper case, lower case, digits and special characters.

       • more character classes can be defined, just write your own.

       • passwords must match the amount of quality points.  A point is validated when at least m characters  of
         the corresponding character class are present in the password.

       • passwords must have at least n of the corresponding character class present, else they are rejected.

       • passwords  must  have  at  the most x occurrences of characters from the corresponding character class,
         else they are rejected.

       • the three previous criteria are checked against any specific character class defined.

       • if a password contains any of the forbidden characters, then it is rejected.

       • if a password contains tokens from the RDN, then it is rejected.

       • if a password contains tokens from defined attributes, then it is rejected.

       • if a password does not pass cracklib check, then it is rejected.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       Since OpenLDAP 2.5 version, ppm configuration is held in a binary attribute of the password policy:  <b>pwd‐</b>
       <b>CheckModuleArg</b>

       The  example file (<b>/usr/local/etc/openldap/ppm.example</b> by default) is to be considered as an example con‐
       figuration, to import in the <b>pwdCheckModuleArg</b> attribute.  It is also used for testing passwords with the
       test program provided.

       If for some reasons, any parameter is not found, it will be given its default value.

       Note: you can still compile ppm to use the configuration file, by enabling <b>PPM_READ_FILE</b>  in  <b>ppm.h</b>  (but
       this  is  deprecated  now).  If you decide to do so, you can use the <b>PPM_CONFIG_FILE</b> environment variable
       for overloading the configuration file path.

       The syntax of a configuration line is:

              parameter value [min] [minForPoint] [max]

       with spaces being delimiters and Line Feed (LF) ending the line.

       Parameter names <b>are</b> case sensitive.

       Lines beginning by a <b>#</b> are considered as comments.

       The default configuration is the following:

              # minQuality parameter
              # Format:
              # minQuality [NUMBER]
              # Description:
              # One point is granted for each class for which MIN_FOR_POINT criteria is fulfilled.
              # defines the minimum point numbers for the password to be accepted.
              minQuality 3

              # checkRDN parameter
              # Format:
              # checkRDN [0 | 1]
              # Description:
              # If set to 1, password must not contain a token from the RDN.
              # Tokens are separated by the following delimiters : space tabulation _ - , ; £
              checkRDN 0

              # checkAttributes parameter
              # Format:
              # checkAttributes [ATTR1,ATTR2,...]
              # Description:
              # Password must not contain a token from the values in the given list of attributes
              # Tokens are substrings of the values of the given attributes,
              # delimited by: space tabulation _ - , ; @
              # For example, if uid="the wonderful entry",
              # password must not contain "the", nor "wonderful", nor "entry"
              checkAttributes

              # forbiddenChars parameter
              # Format:
              # forbiddenChars [CHARACTERS_FORBIDDEN]
              # Description:
              # Defines the forbidden characters list (no separator).
              # If one of them is found in the password, then it is rejected.
              forbiddenChars

              # maxConsecutivePerClass parameter
              # Format:
              # maxConsecutivePerClass [NUMBER]
              # Description:
              # Defines the maximum number of consecutive character allowed for any class
              maxConsecutivePerClass 0

              # useCracklib parameter
              # Format:
              # useCracklib [0 | 1]
              # Description:
              # If set to 1, the password must pass the cracklib check
              useCracklib 0

              # cracklibDict parameter
              # Format:
              # cracklibDict [path_to_cracklib_dictionary]
              # Description:
              # directory+filename-prefix that your version of CrackLib will go hunting for
              # For example, /var/pw_dict resolves as /var/pw_dict.pwd,
              # /var/pw_dict.pwi and /var/pw_dict.hwm dictionary files
              cracklibDict /var/cache/cracklib/cracklib_dict

              # classes parameter
              # Format:
              # class-[CLASS_NAME] [CHARACTERS_DEFINING_CLASS] [MIN] [MIN_FOR_POINT] [MAX]
              # Description:
              # [CHARACTERS_DEFINING_CLASS]: characters defining the class (no separator)
              # [MIN]: If at least [MIN] characters of this class is not found in the password, then it is rejected
              # [MIN_FOR_POINT]: one point is granted if password contains at least [MIN_FOR_POINT] character numbers of this class
              # [MAX]: if &gt; [MAX] occurrences of characters from this class are found, then the password is rejected (0 means no maximum)
              class-upperCase ABCDEFGHIJKLMNOPQRSTUVWXYZ 0 1 0
              class-lowerCase abcdefghijklmnopqrstuvwxyz 0 1 0
              class-digit 0123456789 0 1 0
              class-special &lt;&gt;,?;.:/!§ù%*µ^¨$£²&amp;é~"#'{([-|è`_\ç^à@)]°=}+ 0 1 0

</pre><h4><b>EXAMPLE</b></h4><pre>
       With this policy:

              minQuality 4
              forbiddenChars .?,
              checkRDN 1
              checkAttributes mail
              class-upperCase ABCDEFGHIJKLMNOPQRSTUVWXYZ 0 5 0
              class-lowerCase abcdefghijklmnopqrstuvwxyz 0 12 0
              class-digit 0123456789 0 1 0
              class-special &lt;&gt;,?;.:/!§ù%*µ^¨$£²&amp;é~"#'{([-|è`_\ç^à@)]°=}+ 0 1 0
              class-myClass :) 1 1 0

       the password <b>ThereIsNoCowLevel)</b> is working, because:

       • it has 4 character classes validated : upper, lower, special, and myClass

       • it has no character among .?,

       • it has at least one character among : or )

       but it won’t work for the user uid=John Cowlevel,ou=people,cn=example,cn=com, because the token  “Cowlev‐
       el” from his RDN exists in the password (case insensitive).

       Also,  it  won’t  work  for  a mail attribute containing: “<a href="mailto:thereis@domain.com">thereis@domain.com</a>” because the part “thereis”
       matches the password.

</pre><h4><b>LOGS</b></h4><pre>
       If a user password is rejected by <b>ppm</b>, the user will get this type of message:

       Typical user message from <a href="../man5/ldappasswd.5.html">ldappasswd</a>(5):

                Result: Constraint violation (19)
                Additional info: Password for dn=\"%s\" does not pass required number of strength checks (2 of 3)

       A more detailed message is written to the server log.

       While evaluating a password change, you should observe something looking at this in the logs:

              ppm: entry uid=jack.oneill,ou=people,dc=my-domain,dc=com
              ppm: Reading pwdCheckModuleArg attribute
              ppm: RAW configuration: minQuality 3#012checkRDN 0#012checkAttributes mail,uid#012forbiddenChars#012maxConsecutivePerClass 0#012useCracklib 0#012cracklibDict /var/cache/cracklib/cracklib_dict#012class-upperCase ABCDEFGHIJKLMNOPQRSTUVWXYZ 0 1 0#012class-lowerCase abcdefghijklmnopqrstuvwxyz 0 1 0#012class-digit 0123456789 0 1 0#012class-special &lt;&gt;,?;.:/!§ù%*µ^¨$£²&amp;é~"#'{([-|è`_\ç^à@)]°=}+ 0 1 0
              ppm: Parsing pwdCheckModuleArg attribute
              ppm: get line: minQuality 3
              ppm: Param = minQuality, value = 3, min = (null), minForPoint= (null)
              ppm:  Accepted replaced value: 3
              ppm: get line: checkRDN 0
              ppm: Param = checkRDN, value = 0, min = (null), minForPoint= (null)
              ppm:  Accepted replaced value: 0
              ppm: get line: checkAttributes mail,uid
              ppm: Param = checkAttributes, value = mail,uid, min = (null), minForPoint= (null)
              ppm:  Accepted replaced value: mail,uid
              ppm: get line: forbiddenChars
              ppm: No value, goto next parameter
              ppm: get line: maxConsecutivePerClass 0
              ppm: Param = maxConsecutivePerClass, value = 0, min = (null), minForPoint= (null)
              ppm:  Accepted replaced value: 0
              ppm: get line: useCracklib 0
              ppm: Param = useCracklib, value = 0, min = (null), minForPoint= (null)
              ppm:  Accepted replaced value: 0
              ppm: get line: cracklibDict /var/cache/cracklib/cracklib_dict
              ppm: Param = cracklibDict, value = /var/cache/cracklib/cracklib_dict, min = (null), minForPoint= (null)
              ppm:  Accepted replaced value: /var/cache/cracklib/cracklib_dict
              ppm: get line: class-upperCase ABCDEFGHIJKLMNOPQRSTUVWXYZ 0 1 0
              ppm: Param = class-upperCase, value = ABCDEFGHIJKLMNOPQRSTUVWXYZ, min = 0, minForPoint = 1, max = 0
              ppm:  Accepted replaced value: ABCDEFGHIJKLMNOPQRSTUVWXYZ
              ppm: get line: class-lowerCase abcdefghijklmnopqrstuvwxyz 0 1 0
              ppm: Param = class-lowerCase, value = abcdefghijklmnopqrstuvwxyz, min = 0, minForPoint = 1, max = 0
              ppm:  Accepted replaced value: abcdefghijklmnopqrstuvwxyz
              ppm: get line: class-digit 0123456789 0 1 0
              ppm: Param = class-digit, value = 0123456789, min = 0, minForPoint = 1, max = 0
              ppm:  Accepted replaced value: 0123456789
              ppm: get line: class-special &lt;&gt;,?;.:/!§ù%*µ^¨$£²&amp;é~"#'{([-|è`_\ç^à@)]°=}+ 0 1 0
              ppm: Param = class-special, value = &lt;&gt;,?;.:/!§ù%*µ^¨$£²&amp;é~"#'{([-|è`_\ç^à@)]°=}+, min = 0, minForPoint = 1, max = 0
              ppm:  Accepted replaced value: &lt;&gt;,?;.:/!§ù%*µ^¨$£²&amp;é~"#'{([-|è`_\ç^à@)]°=}+
              ppm: 1 point granted for class class-upperCase
              ppm: 1 point granted for class class-lowerCase
              ppm: Reallocating szErrStr from 64 to 179
              check_password_quality: module error: (/usr/local/openldap/libexec/openldap/ppm.so) Password for dn="uid=jack.oneill,ou=people,dc=my-domain,dc=com" does not pass required number of strength checks (2 of 3).[1]

</pre><h4><b>TESTS</b></h4><pre>
       There is a unit test script: <b>unit_tests.sh</b> that illustrates checking some passwords.

       It is possible to test one particular password using directly the test program:

              cd <a href="file:/usr/local/lib">/usr/local/lib</a>
              LD_LIBRARY_PATH=. ./ppm_test "uid=test,ou=users,dc=my-domain,dc=com" "my_password" "/usr/local/etc/openldap/ppm.example" &amp;&amp; echo OK

</pre><h4><b>FILES</b></h4><pre>
       <b>/usr/local/etc/openldap/ppm.example</b>

              example of ppm configuration to be inserted in <b>pwdCheckModuleArg</b> attribute of given password poli‐
              cy

       <b>ppm.so</b>

              ppm library, loaded by the <b>pwdCheckModule</b> attribute of given password policy (OpenLDAP 2.5) or  by
              the <b>ppolicy_check_module</b> / <b>olcPPolicyCheckModule</b> parameters of the ppolicy overlay (OpenLDAP 2.6)

       <b>ppm_test</b>

              small test program for checking password in a command-line

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/slapo-ppolicy.5.html">slapo-ppolicy</a></b>(5), <b><a href="../man5/slapd-config.5.html">slapd-config</a></b>(5), <b><a href="../man5/slapd.conf.5.html">slapd.conf</a></b>(5)

</pre><h4><b>ACKNOWLEDGEMENTS</b></h4><pre>
       This module was developed in 2014-2022 by David Coutadeur.

ppm                                              August 24, 2021                                          <u><a href="../man5/ppm.5.html">ppm</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>