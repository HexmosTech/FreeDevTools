<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>slapo-otp - OATH One-Time Password module</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/slapd">slapd_2.6.9+dfsg-2ubuntu1_amd64</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       slapo-otp - OATH One-Time Password module

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>moduleload</b> <u>otp.la</u>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>otp</b>  module  allows time-based one-time password, AKA "authenticator-style", and HMAC-based one-time
       password authentication to  be  used  in  conjunction  with  a  standard  LDAP  password  for  two-factor
       authentication.

       With  this  module,  users  would use their password, followed with the one-time password in the password
       prompt to authenticate.

       The password needed for a user to authenticate is calculated based on a counter (current time in case  of
       TOTP)  and  a key that is referenced in the user's LDAP entry. Since the password is based on the time or
       number of uses, it changes periodically. Once used, it cannot be used again so keyloggers  and  shoulder-
       surfers are thwarted. A mobile phone application, such as the Google Authenticator or YubiKey (a <b>prover</b>),
       can  be  used  to  calculate  the user's current one-time password, which is expressed as a (usually six-
       digit) number.

       Alternatively, the value can be calculated by some other application with access to the  user's  key  and
       delivered  to  the user through SMS or some other channel. When prompted to authenticate, the user merely
       appends the code provided by the prover at the end of their password when authenticating.

       This implementation complies with <b>RFC</b> <b>4226</b> <b>HOTP</b> <b>HMAC-Based</b> <b>One</b> <b>Time</b> <b>Passwords</b> and  <b>RFC</b>  <b>6238</b>  <b>TOTP</b>  <b>Time-</b>
       <b>based</b> <b>One</b> <b>Time</b> <b>Passwords</b> and includes support for the SHA-1, SHA-256, and SHA-512 HMAC algorithms.

       The  HMAC  key  used  in the OTP computation is stored in the oathOTPToken entry referenced in the user's
       LDAP entry and the parameters are stored in the oathOTPParams LDAP entry referenced in the token.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       Once the module is configured on the database, it will intercept LDAP simple binds for users  whose  LDAP
       entry has any of the <b>oathOTPUser</b> derived objectlasses attached to it. The attributes linking the user and
       the shared secret are:

              <b>oathTOTPToken:</b> <b>&lt;dn&gt;</b>
                     Mandatory  for <b>oathTOTPUser</b>, indicates that the named entry is designated to hold the time-
                     based one-time password shared secret and the last password used.

              <b>oathHOTPToken:</b> <b>&lt;dn&gt;</b>
                     Mandatory for <b>oathHOTPUser</b>, indicates that the named entry is designated to hold  the  one-
                     time password shared secret and the last password used.

              <b>oathTOTPParams:</b> <b>&lt;dn&gt;</b>
                     Mandatory  for  <b>oathTOTPToken</b>,  indicates  that  the  named entry is designated to hold the
                     parameters to generate time-based one-time password shared secret: its length and algorithm
                     to use as well as the length of each time step and the grace period.

              <b>oathHOTPParams:</b> <b>&lt;dn&gt;</b>
                     Mandatory for <b>oathHOTPToken</b>, indicates that the named  entry  is  designated  to  hold  the
                     parameters  to generate one-time password shared secret: its length and algorithm to use as
                     well as the permitted number of passwords to skip.

       The following parts of the OATH-LDAP schema are implemented.

       General attributes:

              <b>oathSecret:</b> <b>&lt;data&gt;</b>
                     The shared secret is stored here as raw bytes.

              <b>oathOTPLength:</b> <b>&lt;length&gt;</b>
                     The password length, usually 6.

              <b>oathHMACAlgorithm:</b> <b>&lt;OID&gt;</b>
                     The OID of the hash algorithm to use as defined in RFC 8018.  Supported algorithms  include
                     SHA1, SHA224, SHA256, SHA384 and SHA512.

       The HOTP attributes:

              <b>oathHOTPLookAhead:</b> <b>&lt;number&gt;</b>
                     The number of successive HOTP tokens that can be skipped.

              <b>oathHOTPCounter:</b> <b>&lt;number&gt;</b>
                     The order of the last HOTP token successfully redeemed by the user.

       The TOTP attributes:

              <b>oathTOTPTimeStepPeriod:</b> <b>&lt;seconds&gt;</b>
                     The length of the time-step period for TOTP calculation.

              <b>oathTOTPLastTimeStep:</b> <b>&lt;number&gt;</b>
                     The order of the last TOTP token successfully redeemed by the user.

              <b>oathTOTPTimeStepWindow:</b> <b>&lt;number&gt;</b>
                     The  number  of  time  periods  around  the  current time to try when checking the password
                     provided by the user.

              <b>oathTOTPTimeStepDrift:</b> <b>&lt;number&gt;</b>
                     If the client didn't provide the correct token but it still fit with oathTOTPTimeStepWindow
                     above, this attribute records the current offset to provide for slow  clock  drift  of  the
                     client device.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man5/slapd-config.5.html">slapd-config</a></b>(5).

</pre><h4><b>ACKNOWLEDGEMENT</b></h4><pre>
       This  work  was  developed by Ondřej Kuzník and Howard Chu of Symas Corporation for inclusion in OpenLDAP
       Software.

       This work reuses the OATH-LDAP schema developed by Michael Ströder.

SLAPO-OTP                                           2018/6/29                                       <u><a href="../man5/SLAPO_OTP.5.html">SLAPO_OTP</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>