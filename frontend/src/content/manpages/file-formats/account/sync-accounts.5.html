<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>/etc/sync-accounts - configuration file for sync-accounts</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/questing/+package/chiark-scripts">chiark-scripts_8.0.1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       /etc/sync-accounts - configuration file for sync-accounts

</pre><h4><b>DESCRIPTION</b></h4><pre>
       <b>/etc/sync-accounts</b>  contains  the  default  configuration of the <b><a href="../man8/sync-accounts.8.html">sync-accounts</a></b>(8) account synchronisation
       tool.

       The configuration file specifies how to access and update the local password and group  databases,  where
       sync-accounts should log.

       It  also  specifies  the list of (remote) sources for account information, and which accounts and details
       should be copied from each source to the local system.

</pre><h4><b>OVERALL</b> <b>SYNTAX</b> <b>AND</b> <b>SEMANTICS</b></h4><pre>
       The configuration file is parsed as a series of lines.  First, leading and trailing  whitespace  on  each
       line is removed, and then empty lines, or lines starting with <b>#</b>, are removed.

       Each  line  is  parsed  as  a  directive.  The order of directives is significant; some directives set up
       information which later directives rely on.

       The configuration file must contain an <b>end</b> directive; anything after that point is ignored.

</pre><h4><b>GLOBAL</b> <b>DIRECTIVES</b></h4><pre>
       These directives may appear only at the start of  the  file  (before  any  other  directives),  and  each
       directive must appear only once; otherwise, sync-accounts my behave oddly.

       <b>lockpasswd</b>|<b>lockgroup</b> <u>method</u> [<u>details</u> ...]
              Specifies  how  the  passwd  and  group  files  should  be read and/or locked.  See <b>LOCKING</b> <b>METHOD</b>
              <b>DIRECTIVES</b> below.

       <b>logfile</b> <u>filename</u>
              Append log messages to <u>filename</u> instead of stdout.  Errors still go to stderr.

       <b>localformat</b> <b>bsd</b>|<b>std</b>
              Specifies the local password file is in the relevant format: <b>std</b> is the standard V7 password  file
              (with  a  SysV-style  <a href="file:/etc/shadow">/etc/shadow</a> if <a href="file:/etc/shadow">/etc/shadow</a> exists).  <b>bsd</b> is the BSD4.4 master.passwd format,
              and should be used only with <b>lockpasswd</b> <b>runvia</b> <b>vipw</b>.  The default is <b>std</b>.

</pre><h4><b>LOCKING</b> <b>METHOD</b> <b>DIRECTIVES</b></h4><pre>
       One <b>lockgroup</b> and one <b>lockpasswd</b> directive must be present, in the global directives at the start of  the
       config file.

       The  choice of the appropriate directives can be difficult without special knowledge of the local system.
       In general, it is best to use <b>lockpasswd</b> <b>runvia</b> <b>vipw</b> where this is available, as  if  this  works  avoids
       having to know the names of the lockfiles.

       GNU  systems (including GNU/Linux and Debian GNU/BSD) typically lock the group file separately and supply
       <b>vigr</b>, in which case you should use <b>lockgroup</b> <b>vigr</b>.

       Most systems other than GNU do not lock the group file at all (or assume that all programs  which  modify
       the group file will lock the passwd file), in which case <b>lockgroup</b> <b>none</b> is appropriate.

       If  vigr  or vipw is not available or is known to be broken (eg, because it does not lock properly), then
       use <b>link</b>.

       <b>lockpasswd</b>|<b>lockgroup</b> <b>runvia</b> <u>program</u>
              sync-accounts will reinvoke itself using <u>program</u>, which must behave  like  <b>vipw</b>  or  <b>vigr</b>.   sync-
              accounts  will set the <b>EDITOR</b> environment variable to the path it was invoked with (Perl's <b>$0</b>) and
              put some information for its own use into <b>SYNC_ACCOUNTS_*</b> environment variables (which  will  also
              allow  sync-accounts  to  tell that it has already been reinvoked via <u>program</u> and should not do so
              again).

              If both <b>lockpasswd</b> <b>runvia</b> <u>vipw</u> and <b>lockgroup</b> <b>runvia</b> <u>vigr</u> are specified, then it must  be  possible
              and safe for the EDITOR run by <u>vipw</u> to invoke <u>vigr</u>, as this is what sync-accounts will do.

       <b>lockpasswd</b>|<b>lockgroup</b> <b>link</b> <u>suffix</u>|<u>filename</u>
              sync-accounts  will  attempt  to  lock the passwd or group file by making a hardlink from the real
              file to the specified filename.  If <u>suffix</u>|<u>filename</u> starts  with  a  <b>/</b>  it  is  interpreted  as  a
              filename; otherwise it is interpreted as a suffix, to be appended to the real database filename.

       <b>lockpasswd</b>|<b>lockgroup</b> <b>none</b>
              sync-accounts will not attempt to lock the passwd or group files at all.

              <b>lockgroup</b>  <b>none</b>  is  appropriate  on systems where there is no separate locking for the group file
              (either because there is no proper support for automatic editing of the  group  file,  or  because
              you're  expected  to lock the password file), although in the absence of <b>vigr</b> it's inevitable that
              simultaneous changes to the group file made by both the human sysadmin and by  sync-accounts  will
              cause problems.

              <b>lockpasswd</b> <b>none</b> is very dangerous and should not normally be used.  It will cause data loss if any
              other tool for changing password data is used - eg, <b><a href="../man1/passwd.1.html">passwd</a></b>(1).

</pre><h4><b>PER-SOURCE</b> <b>DIRECTIVES</b></h4><pre>
       Within  each  source's section, all of the per-source directives must appear before any account-selection
       directives; otherwise sync-accounts may behave oddly.  If a per-source directive is  repeated,  the  last
       setting takes effect.

       <b>host</b> <u>source</u>
              Starts  a  source's  section.   Usually  each  source will correspond exactly to one host which is
              acting as a source of account data.  The <b>host</b> directive resets the per-source  parameters  to  the
              defaults.   <u>source</u>  need  not be the source host's official name in any sense and is used only for
              identification.  Any <u>source</u> must be named in only one <b>host</b> directive, or sync-accounts may  behave
              oddly.

       <b>getpasswd</b>|<b>getgroup</b>|<b>getshadow</b> <u>command</u>...
              sync-accounts  always fetches account data from sources by running specified commands on the local
              host; it does not contain any network protocols, itself.

              <u>command</u> is fed to <b>sh</b> <b>-c</b> and might typically contain something like
                  <b>ssh</b> <b><a href="mailto:syncacct@remote.host">syncacct@remote.host</a></b> <b>cat</b> <b><a href="file:/etc/passwd">/etc/passwd</a></b>
              where the user syncacct on remote.host is in group shadow, or
                  <b>cat</b> <b>/var/local/sync-accounts/remote.host/passwd</b> where the file named is  copied  across  using
              cron.

              <b>getpasswd</b> must be specified if user data is to be transferred; <b>getgroup</b> must be specified if group
              data is to be transferred.

              <b>getshadow</b>  should  be  specified  iff  getpasswd is specified but the data from getpasswd does not
              contain actual password information, and should emit data in Sys-V shadow password format.

       <b>remoteformat</b> <b>std</b>|<b>bsd</b>
              Specifies the format of  the  output  of  getpasswd.   <b>std</b>  is  standard  V7  passwd  file  format
              (optionally  augmented  by  the  use  of a shadow file fetched with getshadow).  <b>bsd</b> is the BSD4.4
              master.passwd format (and getshadow should not normally  be  used  with  <b>remoteformat</b>  <b>bsd</b>).   The
              default is <b>std</b>.

</pre><h4><b>SYNCHRONISATION</b> <b>SETTINGS</b></h4><pre>
       The following directives affect the way that account data is copied.  They may be freely mixed with other
       directives,  and  repeated.  The setting in effect is the one set by the last relevant settings directive
       before any particular account-selection directive.

       <b>uidmin</b>|<b>uidmax</b> value
              When an account is to be created locally, a uid/gid will be chosen which is one  higher  than  the
              highest  currently in use, except that ids below uidmin or above uidmax are ignored and will never
              be used.  There is no default.

       <b>homebase</b> <u>homebase</u>
              When an account is to be created locally, its  home  directory  will  be  <u>homebase</u><b>/</b><u>username</u>  where
              <u>username</u> is the name of the account.  The default is <b><a href="file:/home">/home</a></b>.

       [<b>no</b>]<b>sameuid</b>
              Specifies  whether uids are supposed to match.  With <b>sameuid</b>, it is an error for the uid or gid of
              a synchronised local account not to match the corresponding remote account, and new local accounts
              will get the remote accounts' ids.  The default is <b>nosameuid</b>.

       <b>usergroups</b> | <b>nousergroups</b> | <b>defaultgid</b> <u>gid</u>
              Specifies whether local accounts are supposed to have corresponding groups, or all be  part  of  a
              particular group.  The default is <b>usergroups</b>.

              With  <b>usergroups</b>,  when a new account is created, the corresponding per-user group will be created
              as well, and per-user groups are created for existing accounts if necessary (if  account  creation
              is enabled).  If the gid or group name for a per-user group is already taken for a different group
              name or gid this will be logged, and processing of that account will be inhibited, but it is not a
              fatal error.

              With  <b>defaultgid</b>,  newly-created  accounts  will  be  made a part of that group, and the groups of
              existing accounts will be left alone.

              With <b>nousergroups</b>, no new accounts can be created, and existing  accounts'  groups  will  be  left
              alone.

       <b>createuser</b> [<u>command</u>] | <b>nocreateuser</b>
              Specifies  whether  accounts  found  on  the  remote host should be created if necessary, and what
              command to run to do the the rest of the account setup (eg, creation  of  home  directory,  etc.).
              The default is <b>nocreateuser</b>.

              If  <b>createuser</b>  is specified without a command then <b>sync-accounts-createuser</b> is used; the supplied
              sync-accounts-createuser program is a reasonable minimal implementation.

              With <b>createuser</b>, either sameuid, or both uidmin and uidmax, must be  specified,  if  accounts  are
              actually to be created.

              The  command  is  passed  to  <b>sh</b>  <b>-c</b>.   See  <b><a href="../man8/sync-accounts-createuser.8.html">sync-accounts-createuser</a></b>(8)  for details of <u>command</u>'s
              environment and functionality.

       <b>group</b>|<b>nogroup</b> <u>glob-pattern</u>
              <b>group</b> specifies that the membership of the local groups  specified  should  be  adjusted  adjusted
              whenever account data for any user is copied, so that the account will be a member of the affected
              group locally iff the source account it is a member of the same group on the source host.

              The  most  recently-encountered  glob-pattern for a particular group takes effect.  The default is
              <b>nogroups</b> <b>*</b>.

              The glob patterns may contain only alphanumerics, the  two  glob  metacharacters  <b>*</b>  <b>?</b>   and  four
              punctuation characters <b>-</b> <b>+</b> <b>.</b> <b>_</b>; <b>\</b>-quoting and character sets and ranges are not supported.

       <b>defaultshell</b> <u>pathname</u>
              Local accounts' shells will, when an account is synchronised, be set to the remote account's shell
              if  the  same  file  exists  locally  and is executable.  Otherwise, this value will be used.  The
              default is <b><a href="file:/bin/sh">/bin/sh</a></b>.

</pre><h4><b>ACCOUNT</b> <b>SELECTION</b></h4><pre>
       These directives specify that the selected accounts are to be synchronised: that is,  the  local  account
       data  will  be unconditionally overwritten (according to the synchronisation settings) with data from the
       current source (according to the most recent <b>host</b> directive).

       Any particular local username will only be synchronised once; the source and settings for  first  account
       selection directive which selects that local username will be used.

       When  an  account  is  synchronised,  the  account  password,  comment  field,  and  shell will be copied
       unconditionally.  If <b>sameuid</b> is in effect  specified  the  uid  will  be  checked  (or  copied,  for  new
       accounts).

       <b>user</b> <u>username</u> [<b>remote</b>=<u>remoteusername</u>]
              Specifies  that  account  data  should  be  copied for local user <u>username</u> from the remote account
              <u>remoteusername</u> (or <u>username</u> if <u>remoteusername</u> is not specified).

       <b>users</b> <u>ruidmin</u>-<u>ruidmax</u>
              Specifies that all remote users whose remote uid is in the given range are to be  synchronised  to
              corresponding  user  accounts.   (Note  that  the  remote uid will only be copied if <b>sameuid</b> is in
              effect.)

       <b>nouser</b> <u>username</u>
              Specifies that data for <u>username</u> <u>is</u> <u>not</u> <u>to</u> <u>be</u> <u>copied,</u> <u>even</u> if subsequent user or users  directives
              suggest that it should be.

       <b>addhere</b>
              This  directive  has  no  effect  on sync-accounts.  However, it is used as a placeholder by grab-
              account: new accounts for creation are inserted just before addhere.  See <b><a href="../man8/grab-account.8.html">grab-account</a></b>(8).

</pre><h4><b>FINAL</b> <b>DIRECTIVE</b></h4><pre>
       <b>end</b>    must appear in the configuration file, usually at the end of the file.  Nothing after it  will  be
              read.

</pre><h4><b>BUGS</b></h4><pre>
       The advice about the correct <b>lockpasswd</b> and <b>lockgroup</b> directives is probably out of date or flatly wrong.

</pre><h4><b>AUTHOR</b></h4><pre>
       <b>sync-accounts</b>  and  this  manpage  are part of the <b>sync-accounts</b> package which was written by Ian Jackson
       &lt;<a href="mailto:ian@chiark.greenend.org.uk">ian@chiark.greenend.org.uk</a>&gt;.      They      are      Copyright      1999-2000,2002      Ian      Jackson
       &lt;<a href="mailto:ian@davenant.greenend.org.uk">ian@davenant.greenend.org.uk</a>&gt;, and Copyright 2000-2001 nCipher Corporation Ltd.

       The  sync-accounts  package is free software; you can redistribute it and/or modify it under the terms of
       the GNU General Public License as published by the Free Software Foundation; either  version  3,  or  (at
       your option) any later version.

       This  is  distributed  in  the  hope  that  it will be useful, but WITHOUT ANY WARRANTY; without even the
       implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.   See  the  GNU  General  Public
       License for more details.

       You  should  have  received  a  copy  of  the GNU General Public License along with this program; if not,
       consult the Free Software Foundation's website at www.fsf.org, or the GNU Project website at www.gnu.org.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man8/sync-accounts.8.html">sync-accounts</a></b>(8),   <b><a href="../man8/grab-account.8.html">grab-account</a></b>(8),   <b><a href="../man8/sync-accounts-createuser.8.html">sync-accounts-createuser</a></b>(8),   <b><a href="../man5/passwd.5.html">passwd</a></b>(5),   <b><a href="../man5/group.5.html">group</a></b>(5),   <b><a href="../man5/shadow.5.html">shadow</a></b>(5),
       <b><a href="../man5/master.passwd.5.html">master.passwd</a></b>(5), <b><a href="../man8/vipw.8.html">vipw</a></b>(8), <b><a href="../man8/vigr.8.html">vigr</a></b>(8)

Greenend                                         15th July 2002                                 <u><a href="../man5/SYNC-ACCOUNTS.5.html">SYNC-ACCOUNTS</a></u>(5)
</pre>
 </div>
</div></section>
</div>
</body>
</html>