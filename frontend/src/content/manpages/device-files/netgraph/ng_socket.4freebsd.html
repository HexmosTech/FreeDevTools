<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ng_socket — netgraph socket node type</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       ng_socket — netgraph socket node type

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;netgraph/ng_socket.h&gt;</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       A  <b>socket</b>  node  is  both  a  BSD  socket  and a netgraph node.  The <b>ng_socket</b> node type allows user-mode
       processes to participate in the kernel <u><a href="../man4/netgraph.4.html">netgraph</a></u>(4) networking subsystem using the BSD  socket  interface.
       The  process  must  have  root privileges to be able to create netgraph sockets however once created, any
       process that has one may use it.

       A new <b>ng_socket</b> node is created by creating a new socket  of  type  NG_CONTROL  in  the  protocol  family
       PF_NETGRAPH, using the <u><a href="../man2/socket.2.html">socket</a></u>(2) system call.  Any control messages received by the node and not having a
       cookie  value  of  NGM_SOCKET_COOKIE  are  received by the process, using <u><a href="../man2/recvfrom.2.html">recvfrom</a></u>(2); the socket address
       argument is a struct sockaddr_ng containing the sender's netgraph address.  Conversely, control  messages
       can  be sent to any node by calling <u><a href="../man2/sendto.2.html">sendto</a></u>(2), supplying the recipient's address in a struct sockaddr_ng.
       The <u><a href="../man2/bind.2.html">bind</a></u>(2) system call may be used to assign a global netgraph name to the node.

       To transmit and receive netgraph data packets, a NG_DATA socket must also be created using <u><a href="../man2/socket.2.html">socket</a></u>(2)  and
       associated  with a <b>ng_socket</b> node.  NG_DATA sockets do not automatically have nodes associated with them;
       they are bound to a specific node via the <u><a href="../man2/connect.2.html">connect</a></u>(2) system call.  The address argument is  the  netgraph
       address  of  the  <b>ng_socket</b> node already created.  Once a data socket is associated with a node, any data
       packets received by the node are read using <u><a href="../man2/recvfrom.2.html">recvfrom</a></u>(2) and any packets to be sent out from the node  are
       written  using  <u><a href="../man2/sendto.2.html">sendto</a></u>(2).   In the case of data sockets, the struct sockaddr_ng contains the name of the
       <u>hook</u> on which the data was received or should be sent.

       As a special case, to allow netgraph data sockets to be used as stdin or  stdout  on  naive  programs,  a
       <u><a href="../man2/sendto.2.html">sendto</a></u>(2)  with  a NULL sockaddr pointer, a <u><a href="../man2/send.2.html">send</a></u>(2) or a <u><a href="../man2/write.2.html">write</a></u>(2) will succeed in the case where there is
       exactly ONE hook attached to the socket node, (and thus the path is unambiguous).

       There is a user library that simplifies using netgraph sockets; see <u><a href="../man3/netgraph.3.html">netgraph</a></u>(3).

</pre><h4><b>HOOKS</b></h4><pre>
       This node type supports hooks with arbitrary names (as long as they are unique) and always  accepts  hook
       connection requests.

</pre><h4><b>CONTROL</b> <b>MESSAGES</b></h4><pre>
       This node type supports the generic control messages, plus the following:

       NGM_SOCK_CMD_NOLINGER
            When the last hook is removed from this node, it will shut down as if it had received a NGM_SHUTDOWN
            message.  Attempts to access the sockets associated will return ENOTCONN.

       NGM_SOCK_CMD_LINGER
            This  is the default mode.  When the last hook is removed, the node will continue to exist, ready to
            accept new hooks until it is explicitly shut down.

       All other messages with neither the NGM_SOCKET_COOKIE or NGM_GENERIC_COOKIE will be passed  unaltered  up
       the NG_CONTROL socket.

</pre><h4><b>SHUTDOWN</b></h4><pre>
       This  node  type  shuts  down and disappears when both the associated NG_CONTROL and NG_DATA sockets have
       been closed, or a NGM_SHUTDOWN control message is received.  In the latter case, attempts to write to the
       still-open sockets will return ENOTCONN.  If the NGM_SOCK_CMD_NOLINGER message has been received, closure
       of the last hook will also initiate a shutdown of the node.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/socket.2.html">socket</a></u>(2), <u><a href="../man3/netgraph.3.html">netgraph</a></u>(3), <u><a href="../man4/netgraph.4.html">netgraph</a></u>(4), <u><a href="../man4/ng_ksocket.4.html">ng_ksocket</a></u>(4), <u><a href="../man8/ngctl.8.html">ngctl</a></u>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>ng_socket</b> node type was implemented in FreeBSD 4.0.

</pre><h4><b>AUTHORS</b></h4><pre>
       Julian Elischer &lt;<u><a href="mailto:julian@FreeBSD.org">julian@FreeBSD.org</a></u>&gt;

</pre><h4><b>BUGS</b></h4><pre>
       It is not possible to reject the connection of a  hook,  though  any  data  received  on  that  hook  can
       certainly be ignored.

       The controlling process is not notified of all events that an in-kernel node would be notified of, e.g. a
       new  hook,  or hook removal.  Some node-initiated messages should be defined for this purpose (to be sent
       up the control socket).

Debian                                          January 19, 1999                                    <u><a href="../man4/NG_SOCKET.4.html">NG_SOCKET</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>