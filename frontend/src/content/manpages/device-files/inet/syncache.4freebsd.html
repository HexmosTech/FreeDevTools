<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>syncache, syncookies — sysctl(8) MIBs for controlling TCP SYN caching</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       syncache, syncookies — <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8) MIBs for controlling TCP SYN caching

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sysctl</b> <b>net.inet.tcp.syncookies</b>
       <b>sysctl</b> <b>net.inet.tcp.syncookies_only</b>

       <b>sysctl</b> <b>net.inet.tcp.syncache.hashsize</b>
       <b>sysctl</b> <b>net.inet.tcp.syncache.bucketlimit</b>
       <b>sysctl</b> <b>net.inet.tcp.syncache.cachelimit</b>
       <b>sysctl</b> <b>net.inet.tcp.syncache.rexmtlimit</b>
       <b>sysctl</b> <b>net.inet.tcp.syncache.count</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>syncache</b>  <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8)  MIB  is used to control the TCP SYN caching in the system, which is intended to
       handle SYN flood Denial of Service attacks.

       When a TCP SYN segment is received on a port corresponding to a listen socket, an entry is  made  in  the
       <b>syncache</b>,  and  a SYN,ACK segment is returned to the peer.  The <b>syncache</b> entry holds the TCP options from
       the initial SYN, enough state to perform a SYN,ACK retransmission, and takes up less  space  than  a  TCP
       control block endpoint.  An incoming segment which contains an ACK for the SYN,ACK and matches a <b>syncache</b>
       entry  will cause the system to create a TCP control block with the options stored in the <b>syncache</b> entry,
       which is then released.

       The <b>syncache</b> protects the system from SYN flood DoS attacks by minimizing the amount of state kept on the
       server, and by limiting the overall size of the <b>syncache</b>.

       <b>Syncookies</b> provides a way to virtually expand the size of the <b>syncache</b> by  keeping  state  regarding  the
       initial  SYN in the network.  Enabling <b>syncookies</b> sends a cryptographic value in the SYN,ACK reply to the
       client machine, which is then returned in the client's ACK.  If the corresponding entry is not  found  in
       the  <b>syncache</b>,  but  the value passes specific security checks, the connection will be accepted.  This is
       only used if the <b>syncache</b> is unable to handle the volume of incoming connections, and a prior  entry  has
       been evicted from the cache.

       <b>Syncookies</b> have a certain number of disadvantages that a paranoid administrator may wish to take note of.
       Since  the  TCP  options  from  the  initial  SYN  are not saved, they are not applied to the connection,
       precluding use of features like window scale, timestamps, or exact MSS  sizing.   As  the  returning  ACK
       establishes  the  connection,  it may be possible for an attacker to ACK flood a machine in an attempt to
       create a connection.  While steps have been taken to mitigate this risk, this may provide a way to bypass
       firewalls which filter incoming segments with the SYN bit set.

       To disable the <b>syncache</b> and run only with <b>syncookies</b>, set <u>net.inet.tcp.syncookies_only</u> to 1.

       The <b>syncache</b> implements a number of variables in the <u>net.inet.tcp.syncache</u> branch of the  <u><a href="../man3/sysctl.3.html">sysctl</a></u>(3)  MIB.
       Several of these may be tuned by setting the corresponding variable in the <u><a href="../man8/loader.8.html">loader</a></u>(8).

       <u>hashsize</u>     Size of the <b>syncache</b> hash table, must be a power of 2.  Read-only, tunable via <u><a href="../man8/loader.8.html">loader</a></u>(8).

       <u>bucketlimit</u>  Limit  on  the number of entries permitted in each bucket of the hash table.  This should be
                    left at a low value to minimize search time.  Read-only, tunable via <u><a href="../man8/loader.8.html">loader</a></u>(8).

       <u>cachelimit</u>   Limit on the total number of entries in the <b>syncache</b>.  Defaults to (<u>hashsize</u> × <u>bucketlimit</u>),
                    may be set lower to minimize memory consumption.  Read-only, tunable via <u><a href="../man8/loader.8.html">loader</a></u>(8).

       <u>rexmtlimit</u>   Maximum number of times a SYN,ACK is retransmitted before being discarded.  The default of 3
                    retransmits corresponds to a 45 second timeout, this value may be increased depending on the
                    RTT to client machines.  Tunable via <u><a href="../man3/sysctl.3.html">sysctl</a></u>(3).

       <u>count</u>        Number of entries present in the <b>syncache</b> (read-only).

       Statistics on the performance of the  <b>syncache</b>  may  be  obtained  via  <u><a href="../man1/netstat.1.html">netstat</a></u>(1),  which  provides  the
       following counts:

       <b>syncache</b> <b>entries</b> <b>added</b>
                         Entries successfully inserted in the <b>syncache</b>.

       <b>retransmitted</b>     SYN,ACK retransmissions due to a timeout expiring.

       <b>dupsyn</b>            Incoming SYN segment matching an existing entry.

       <b>dropped</b>           SYNs dropped because SYN,ACK could not be sent.

       <b>completed</b>         Successfully completed connections.

       <b>bucket</b> <b>overflow</b>   Entries dropped for exceeding per-bucket size.

       <b>cache</b> <b>overflow</b>    Entries dropped for exceeding overall cache size.

       <b>reset</b>             RST segment received.

       <b>stale</b>             Entries dropped due to maximum retransmissions or listen socket disappearance.

       <b>aborted</b>           New socket allocation failures.

       <b>badack</b>            Entries dropped due to bad ACK reply.

       <b>unreach</b>           Entries dropped due to ICMP unreachable messages.

       <b>zone</b> <b>failures</b>     Failures to allocate new <b>syncache</b> entry.

       <b>cookies</b> <b>received</b>  Connections created from segment containing ACK.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/netstat.1.html">netstat</a></u>(1), <u><a href="../man4/tcp.4.html">tcp</a></u>(4), <u><a href="../man8/loader.8.html">loader</a></u>(8), <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8)

</pre><h4><b>HISTORY</b></h4><pre>
       The  existing  <b>syncache</b> implementation first appeared in FreeBSD 4.5.  The original concept of a <b>syncache</b>
       originally appeared in BSD/OS, and was later modified by NetBSD, then further extended here.

</pre><h4><b>AUTHORS</b></h4><pre>
       The <b>syncache</b> code and manual page were written by Jonathan Lemon &lt;<u><a href="mailto:jlemon@FreeBSD.org">jlemon@FreeBSD.org</a></u>&gt;.

Debian                                          January 22, 2008                                     <u><a href="../man4/SYNCACHE.4.html">SYNCACHE</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>