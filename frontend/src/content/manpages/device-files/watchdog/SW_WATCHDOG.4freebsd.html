<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>watchdog — hardware and software watchdog</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       watchdog — hardware and software watchdog

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/watchdog.h&gt;</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>watchdog</b> facility is used for controlling hardware and software watchdogs.

       The device <u>/dev/fido</u> supports several optional <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2) calls for configuration, and responds to a single
       operational  <u>ioctl</u>  call,  WDIOCPATPAT.   It  takes  a  single  argument which represents a timeout value
       specified as a power of two nanoseconds, or-ed with a flag selecting active or  passive  control  of  the
       watchdog.

       WD_ACTIVE  indicates  that  the  <b>watchdog</b> will be kept from timing out from userland, for instance by the
       <u><a href="../man8/watchdogd.8.html">watchdogd</a></u>(8) daemon.  WD_PASSIVE indicates that the <b>watchdog</b> will  be  kept  from  timing  out  from  the
       kernel.

       The   WDIOCPATPAT   <u><a href="../man2/ioctl.2.html">ioctl</a></u>(2)  call  will  return  success  if  just  one  of  the  available  <u><a href="../man9/watchdog.9.html">watchdog</a></u>(9)
       implementations supports setting the timeout to the specified timeout.  This  means  that  at  least  one
       watchdog  is  armed.   By default, this will be a hardware watchdog if one is present, but if no hardware
       watchdog is able to process the request, a default software watchdog is enabled.  If the call fails,  for
       instance  if  none  of <u><a href="../man9/watchdog.9.html">watchdog</a></u>(9) implementations support the timeout length, all watchdogs are disabled
       and must be explicitly re-enabled.

       To disable the watchdogs pass WD_TO_NEVER.  If disarming the watchdog(s) failed  an  error  is  returned.
       The watchdog might still be armed!

       The  optional  configuration  <u>ioctl</u>  commands are listed here, along with the type of the parameter used.
       Examples of their use can be found in <u><a href="../man8/watchdogd.8.html">watchdogd</a></u>(8).

       WDIOC_SETTIMEOUT <u>int</u>           set/reset the timer

       WDIOC_GETTIMEOUT <u>int</u>           get total timeout

       WDIOC_GETTIMELEFT <u>int</u>          get time left

       WDIOC_GETPRETIMEOUT <u>int</u>        get the pre-timeout

       WDIOC_SETPRETIMEOUT <u>int</u>        set the pre-timeout

       WDIOC_SETPRETIMEOUTACT <u>int</u>     Set the action when a pre-timeout occurs (see <b>WD_SOFT_*</b> below).

       WDIOC_SETSOFT <u>int</u>              Use an internal software watchdog instead of hardware.  There is  also  an
                                      external  software  watchdog,  which  is  used  by  default if no hardware
                                      watchdog was attached.

       WDIOC_SETSOFTTIMEOUTACT <u>int</u>    Set the action whan a soft timeout occurs.

       The actions that may be specified for the pre-timeout or the internal software watchdog are listed  here.
       Multiple actions can be specified by ORing values together.

       WD_SOFT_PANIC  panic

       WD_SOFT_DDB    enter debugger

       WD_SOFT_LOG    <a href="../man9/log.9.html">log</a>(9)

       WD_SOFT_PRINT  <a href="../man9/printf.9.html">printf</a>(9)

</pre><h4><b>RETURN</b> <b>VALUES</b></h4><pre>
       The WDIOCPATPAT <u>ioctl</u> returns zero on success and non-zero on failure.

       [EOPNOTSUPP]       No  watchdog  present  in  the  kernel or none of the watchdogs supports the requested
                          timeout value (timeout value other than 0).

       [EOPNOTSUPP]       Watchdog could not be disabled (timeout value of 0).

       [EINVAL]           Invalid flag combination passed.

       The configuration <u>ioctl</u> operations return zero on success and non-zero on failure.

</pre><h4><b>EXAMPLES</b></h4><pre>
             #include &lt;<a href="file:/usr/include/paths.h">paths.h</a>&gt;
             #include &lt;sys/watchdog.h&gt;

             #define WDPATH  "<a href="file:/dev/">/dev/</a>" _PATH_WATCHDOG
             int wdfd = -1;

             static void
             wd_init(void)
             {
                     wdfd = open(WDPATH, O_RDWR);
                     if (wdfd == -1)
                             err(1, WDPATH);
             }
             static void
             wd_reset(u_int timeout)
             {
                     if (ioctl(wdfd, WDIOCPATPAT, &amp;timeout) == -1)
                             err(1, "WDIOCPATPAT");
             }

             /* in main() */
             wd_init();
             wd_reset(WD_ACTIVE|WD_TO_8SEC);
             /* potential freeze point */
             wd_reset(WD_TO_NEVER);

       Enables a watchdog to recover from a potentially freezing piece of code.

             <b>options</b> <b>SW_WATCHDOG</b>

       in your kernel config forces a software watchdog in the kernel  to  be  configured  even  if  a  hardware
       watchdog is configured, dropping to KDB or panicking when firing, depending on the KDB and KDB_UNATTENDED
       kernel configuration options.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man8/watchdogd.8.html">watchdogd</a></u>(8), <u><a href="../man9/watchdog.9.html">watchdog</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>watchdog</b> code first appeared in FreeBSD 5.1.

</pre><h4><b>AUTHORS</b></h4><pre>
       The <b>watchdog</b> facility was written by Poul-Henning Kamp &lt;<u><a href="mailto:phk@FreeBSD.org">phk@FreeBSD.org</a></u>&gt;.  The software watchdog code and
       this  manual page were written by Sean Kelly &lt;<u><a href="mailto:smkelly@FreeBSD.org">smkelly@FreeBSD.org</a></u>&gt;.  Some contributions were made by Jeff
       Roberson &lt;<u><a href="mailto:jeff@FreeBSD.org">jeff@FreeBSD.org</a></u>&gt;.

</pre><h4><b>BUGS</b></h4><pre>
       The WD_PASSIVE option has not yet been implemented.

Debian                                           January 2, 2018                                     <u><a href="../man4/WATCHDOG.4.html">WATCHDOG</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>