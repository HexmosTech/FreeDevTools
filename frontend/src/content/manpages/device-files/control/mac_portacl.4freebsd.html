<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mac_portacl — network port access control policy</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mac_portacl — network port access control policy

</pre><h4><b>SYNOPSIS</b></h4><pre>
       To  compile  the  port  access  control policy into your kernel, place the following lines in your kernel
       configuration file:

             <b>options</b> <b>MAC</b>
             <b>options</b> <b>MAC_PORTACL</b>

       Alternately, to load the port access control policy module at boot time, place the following line in your
       kernel configuration file:

             <b>options</b> <b>MAC</b>

       and in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             <b>mac_portacl_load="YES"</b>

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>mac_portacl</b> policy allows administrators to administratively limit binding to local UDP and TCP ports
       via the <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8) interface.

       In order to enable the <b>mac_portacl</b> policy, MAC policy must be enforced on sockets (see <u><a href="../man4/mac.4.html">mac</a></u>(4)),  and  the
       port(s)   protected   by   <b>mac_portacl</b>   must   not   be   included   in   the  range  specified  by  the
       <u>net.inet.ip.portrange.reservedlow</u> and <u>net.inet.ip.portrange.reservedhigh</u> <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8) MIBs.

       The  <b>mac_portacl</b>  policy  only  affects  ports  explicitly  bound  by  a  user  process  (either  for   a
       listen/outgoing  TCP  socket,  or  a  send/receive  UDP  socket).  This policy will not limit ports bound
       implicitly for outgoing connections where the process has not  explicitly  selected  a  port:  these  are
       automatically selected by the IP stack.

       When  <b>mac_portacl</b>  is  enabled,  it will control binding access to ports up to the port number set in the
       <u>security.mac.portacl.port_high</u> <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8) variable.  By default,  all  attempts  to  bind  to  <b>mac_portacl</b>
       controlled  ports  will fail if not explicitly allowed by the port access control list, though binding by
       the superuser will be allowed, if the <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8) variable <u>security.mac.portacl.suser_exempt</u> is  set  to  a
       non-zero value.

   <b>Runtime</b> <b>Configuration</b>
       The  following  <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8)  MIBs  are  available  for fine-tuning the enforcement of this MAC policy.  All
       <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8) variables, except  <u>security.mac.portacl.rules</u>,  can  also  be  set  as  <u><a href="../man8/loader.8.html">loader</a></u>(8)  tunables  in
       <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5).

       <u>security.mac.portacl.enabled</u>
               Enforce the <b>mac_portacl</b> policy.  (Default: 1).

       <u>security.mac.portacl.port_high</u>
               The highest port number <b>mac_portacl</b> will enforce rules for.  (Default: 1023).

       <u>security.mac.portacl.rules</u>
               The port access control list is specified in the following format:

                     <u>idtype</u>:<u>id</u>:<u>protocol</u>:<u>port</u>[,<u>idtype</u>:<u>id</u>:<u>protocol</u>:<u>port</u>,<u>...</u>]

               <u>idtype</u>    Describes  the type of subject match to be performed.  Either <b>uid</b> for user ID matching,
                         or <b>gid</b> for group ID matching.

               <u>id</u>        The user or group ID (depending on <u>idtype</u>) allowed  to  bind  to  the  specified  port.
                         <u>NOTE:</u> <u>User</u> <u>and</u> <u>group</u> <u>names</u> <u>are</u> <u>not</u> <u>valid;</u> <u>only</u> <u>the</u> <u>actual</u> <u>ID</u> <u>numbers</u> <u>may</u> <u>be</u> <u>used.</u>

               <u>protocol</u>  Describes which protocol this entry applies to.  Either <b>tcp</b> or <b>udp</b> are supported.

               <u>port</u>      Describes  which  port  this  entry  applies  to.   <u>NOTE:</u> <u>MAC</u> <u>security</u> <u>policies</u> <u>may</u> <u>not</u>
                         <u>override</u> <u>other</u> <u>security</u> <u>system</u> <u>policies</u> <u>by</u> <u>allowing</u> <u>accesses</u> <u>that</u> <u>they</u> <u>may</u>  <u>deny,</u>  <u>such</u>
                         <u>as</u>  <u>net.inet.ip.portrange.reservedlow</u>  <u>/</u>  <u>net.inet.ip.portrange.reservedhigh.</u>   If  the
                         specified port falls within  the  range  specified,  the  <b>mac_portacl</b>  entry  will  not
                         function  (i.e., even the specified user/group may not be able to bind to the specified
                         port).

       <u>security.mac.portacl.suser_exempt</u>
               Allow superuser (i.e., root) to bind to all <b>mac_portacl</b> protected ports, even if the port  access
               control list does not explicitly allow this.  (Default: 1).

       <u>security.mac.portacl.autoport_exempt</u>
               Allow  applications to use automatic binding to port 0.  Applications use port 0 as a request for
               automatic port allocation when binding an IP address to a socket.  This tunable will exempt  port
               0 allocation from rule checking.  (Default: 1).

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/mac.3.html">mac</a></u>(3),  <u><a href="../man4/ip.4.html">ip</a></u>(4), <u><a href="../man4/mac_biba.4.html">mac_biba</a></u>(4), <u><a href="../man4/mac_bsdextended.4.html">mac_bsdextended</a></u>(4), <u><a href="../man4/mac_ifoff.4.html">mac_ifoff</a></u>(4), <u><a href="../man4/mac_mls.4.html">mac_mls</a></u>(4), <u><a href="../man4/mac_none.4.html">mac_none</a></u>(4), <u><a href="../man4/mac_partition.4.html">mac_partition</a></u>(4),
       <u><a href="../man4/mac_seeotheruids.4.html">mac_seeotheruids</a></u>(4), <u><a href="../man4/mac_test.4.html">mac_test</a></u>(4), <u><a href="../man9/mac.9.html">mac</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       MAC first appeared in FreeBSD 5.0 and <b>mac_portacl</b> first appeared in FreeBSD 5.1.

</pre><h4><b>AUTHORS</b></h4><pre>
       This software was contributed to the FreeBSD Project by NAI  Labs,  the  Security  Research  Division  of
       Network  Associates  Inc.  under  DARPA/SPAWAR  contract N66001-01-C-8035 (“CBOSS”), as part of the DARPA
       CHATS research program.

Debian                                          December 9, 2004                                  <u><a href="../man4/MAC_PORTACL.4.html">MAC_PORTACL</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>