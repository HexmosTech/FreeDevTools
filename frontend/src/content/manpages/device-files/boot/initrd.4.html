<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>initrd - boot loader initialized RAM disk</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/manpages">manpages_6.9.1-1_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       initrd - boot loader initialized RAM disk

</pre><h4><b>CONFIGURATION</b></h4><pre>
       <u>/dev/initrd</u>  is  a  read-only  block  device  assigned  major  number  1 and minor number 250.  Typically
       <u>/dev/initrd</u> is owned by root:disk with mode 0400 (read access by root only).  If the  Linux  system  does
       not have <u>/dev/initrd</u> already created, it can be created with the following commands:

           mknod -m 400 /dev/initrd b 1 250
           chown root:disk /dev/initrd

       Also,   support   for   both   "RAM   disk"  and  "Initial  RAM  disk"  (e.g.,  <b>CONFIG_BLK_DEV_RAM=y</b>  and
       <b>CONFIG_BLK_DEV_INITRD=y</b>) must be compiled directly into the Linux kernel to use <u>/dev/initrd</u>.  When  using
       <u>/dev/initrd</u>, the RAM disk driver cannot be loaded as a module.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  special file <u>/dev/initrd</u> is a read-only block device.  This device is a RAM disk that is initialized
       (e.g., loaded) by the boot loader before the kernel is started.  The kernel then  can  use  <u>/dev/initrd</u>'s
       contents for a two-phase system boot-up.

       In  the first boot-up phase, the kernel starts up and mounts an initial root filesystem from the contents
       of <u>/dev/initrd</u> (e.g., RAM disk initialized by the boot loader).  In the second phase, additional  drivers
       or  other  modules  are  loaded  from  the  initial root device's contents.  After loading the additional
       modules, a new root filesystem (i.e., the normal root filesystem) is mounted from a different device.

   <b>Boot-up</b> <b>operation</b>
       When booting up with <b>initrd</b>, the system boots as follows:

       (1)  The boot loader loads the kernel program and <u>/dev/initrd</u>'s contents into memory.

       (2)  On kernel startup, the kernel uncompresses and copies the contents of the  device  <u>/dev/initrd</u>  onto
            device <u>/dev/ram0</u> and then frees the memory used by <u>/dev/initrd</u>.

       (3)  The kernel then read-write mounts the device <u>/dev/ram0</u> as the initial root filesystem.

       (4)  If  the  indicated normal root filesystem is also the initial root filesystem (e.g., <u>/dev/ram0</u>) then
            the kernel skips to the last step for the usual boot sequence.

       (5)  If the executable file <u>/linuxrc</u> is present in the initial root filesystem, <u>/linuxrc</u> is executed with
            UID 0.  (The file <u>/linuxrc</u> must have executable permission.  The file  <u>/linuxrc</u>  can  be  any  valid
            executable, including a shell script.)

       (6)  If <u>/linuxrc</u> is not executed or when <u>/linuxrc</u> terminates, the normal root filesystem is mounted.  (If
            <u>/linuxrc</u> exits with any filesystems mounted on the initial root filesystem, then the behavior of the
            kernel is <b>UNSPECIFIED</b>.  See the NOTES section for the current kernel behavior.)

       (7)  If  the  normal  root  filesystem  has  a directory <u>/initrd</u>, the device <u>/dev/ram0</u> is moved from <u>/</u> to
            <u>/initrd</u>.  Otherwise, if the directory <u>/initrd</u> does not exist, the  device  <u>/dev/ram0</u>  is  unmounted.
            (When moved from <u>/</u> to <u>/initrd</u>, <u>/dev/ram0</u> is not unmounted and therefore processes can remain running
            from <u>/dev/ram0</u>.  If directory <u>/initrd</u> does not exist on the normal root filesystem and any processes
            remain  running  from <u>/dev/ram0</u> when <u>/linuxrc</u> exits, the behavior of the kernel is <b>UNSPECIFIED</b>.  See
            the NOTES section for the current kernel behavior.)

       (8)  The usual boot sequence (e.g., invocation of <u><a href="file:/sbin/init">/sbin/init</a></u>) is performed on the normal root filesystem.

   <b>Options</b>
       The following boot loader options, when used with <b>initrd</b>, affect the kernel's boot-up operation:

       <b>initrd=</b><u>filename</u>
              Specifies the file to load as the contents of <u>/dev/initrd</u>.  For <b>LOADLIN</b>  this  is  a  command-line
              option.   For  <b>LILO</b>  you have to use this command in the <b>LILO</b> configuration file <u>/etc/lilo.config</u>.
              The filename specified with this option will typically be a gzipped filesystem image.

       <b>noinitrd</b>
              This boot option disables the two-phase boot-up operation.  The kernel  performs  the  usual  boot
              sequence  as  if  <u>/dev/initrd</u>  was not initialized.  With this option, any contents of <u>/dev/initrd</u>
              loaded into memory by the boot loader contents are preserved.  This option permits the contents of
              <u>/dev/initrd</u> to be any data and need not  be  limited  to  a  filesystem  image.   However,  device
              <u>/dev/initrd</u> is read-only and can be read only one time after system startup.

       <b>root=</b><u>device-name</u>
              Specifies the device to be used as the normal root filesystem.  For <b>LOADLIN</b> this is a command-line
              option.   For  <b>LILO</b>  this  is  a  boot  time  option  or can be used as an option line in the <b>LILO</b>
              configuration file <u>/etc/lilo.config</u>.  The device specified by this  option  must  be  a  mountable
              device having a suitable root filesystem.

   <b>Changing</b> <b>the</b> <b>normal</b> <b>root</b> <b>filesystem</b>
       By  default, the kernel's settings (e.g., set in the kernel file with <b><a href="../man8/rdev.8.html">rdev</a></b>(8) or compiled into the kernel
       file), or the boot loader option setting is used for the normal root  filesystems.   For  an  NFS-mounted
       normal  root filesystem, one has to use the <b>nfs_root_name</b> and <b>nfs_root_addrs</b> boot options to give the NFS
       settings.   For  more   information   on   NFS-mounted   root   see   the   kernel   documentation   file
       <u>Documentation/filesystems/nfs/nfsroot.txt</u> (or <u>Documentation/filesystems/nfsroot.txt</u> before Linux 2.6.33).
       For more information on setting the root filesystem see also the <b>LILO</b> and <b>LOADLIN</b> documentation.

       It is also possible for the <u>/linuxrc</u> executable to change the normal root device.  For <u>/linuxrc</u> to change
       the  normal  root  device, <u><a href="file:/proc">/proc</a></u> must be mounted.  After mounting <u><a href="file:/proc">/proc</a></u>, <u>/linuxrc</u> changes the normal root
       device by writing into the proc files <u><a href="file:/proc/sys/kernel/real-root-dev">/proc/sys/kernel/real-root-dev</a></u>, <u>/proc/sys/kernel/nfs-root-name</u>, and
       <u>/proc/sys/kernel/nfs-root-addrs</u>.  For a physical root device,  the  root  device  is  changed  by  having
       <u>/linuxrc</u>  write  the  new  root filesystem device number into <u><a href="file:/proc/sys/kernel/real-root-dev">/proc/sys/kernel/real-root-dev</a></u>.  For an NFS
       root filesystem, the root device is  changed  by  having  <u>/linuxrc</u>  write  the  NFS  setting  into  files
       <u>/proc/sys/kernel/nfs-root-name</u>  and  <u>/proc/sys/kernel/nfs-root-addrs</u>  and  then  writing  0xff (e.g., the
       pseudo-NFS-device number) into file <u><a href="file:/proc/sys/kernel/real-root-dev">/proc/sys/kernel/real-root-dev</a></u>.  For  example,  the  following  shell
       command line would change the normal root device to <u>/dev/hdb1</u>:

           echo 0x365 &gt;<a href="file:/proc/sys/kernel/real-root-dev">/proc/sys/kernel/real-root-dev</a>

       For  an  NFS  example,  the  following shell command lines would change the normal root device to the NFS
       directory <u>/var/nfsroot</u> on a local networked NFS server with IP number 193.8.232.7 for a  system  with  IP
       number 193.8.232.2 and named "idefix":

           echo /var/nfsroot &gt;/proc/sys/kernel/nfs-root-name
           echo 193.8.232.2:193.8.232.7::255.255.255.0:idefix \
               &gt;/proc/sys/kernel/nfs-root-addrs
           echo 255 &gt;<a href="file:/proc/sys/kernel/real-root-dev">/proc/sys/kernel/real-root-dev</a>

       <b>Note</b>: The use of <u><a href="file:/proc/sys/kernel/real-root-dev">/proc/sys/kernel/real-root-dev</a></u> to change the root filesystem is obsolete.  See the Linux
       kernel  source  file <u>Documentation/admin-guide/initrd.rst</u> (or <u>Documentation/initrd.txt</u> before Linux 4.10)
       as well as <b><a href="../man2/pivot_root.2.html">pivot_root</a></b>(2) and <b><a href="../man8/pivot_root.8.html">pivot_root</a></b>(8) for information on the modern  method  of  changing  the  root
       filesystem.

   <b>Usage</b>
       The  main  motivation  for  implementing  <b>initrd</b>  was to allow for modular kernel configuration at system
       installation.

       A possible system installation scenario is as follows:

       (1)  The loader program boots from floppy or other  media  with  a  minimal  kernel  (e.g.,  support  for
            <u>/dev/ram</u>,  <u>/dev/initrd</u>, and the ext2 filesystem) and loads <u>/dev/initrd</u> with a gzipped version of the
            initial filesystem.

       (2)  The executable <u>/linuxrc</u> determines what is needed to (1) mount the  normal  root  filesystem  (i.e.,
            device  type,  device  drivers,  filesystem)  and (2) the distribution media (e.g., CD-ROM, network,
            tape, ...).  This can be done by asking the user, by auto-probing, or by using a hybrid approach.

       (3)  The executable <u>/linuxrc</u> loads the necessary modules from the initial root filesystem.

       (4)  The executable <u>/linuxrc</u> creates and populates the root filesystem.  (At this stage the  normal  root
            filesystem does not have to be a completed system yet.)

       (5)  The  executable  <u>/linuxrc</u>  sets  <u><a href="file:/proc/sys/kernel/real-root-dev">/proc/sys/kernel/real-root-dev</a></u>,  unmounts  <u><a href="file:/proc">/proc</a></u>,  the  normal root
            filesystem and any other filesystems it has mounted, and then terminates.

       (6)  The kernel then mounts the normal root filesystem.

       (7)  Now that the filesystem is accessible and intact, the boot loader can be installed.

       (8)  The boot loader is configured to load into <u>/dev/initrd</u> a filesystem with the set of modules that was
            used to bring up the system.  (e.g., device <u>/dev/ram0</u> can be modified, then unmounted, and  finally,
            the image is written from <u>/dev/ram0</u> to a file.)

       (9)  The system is now bootable and additional installation tasks can be performed.

       The  key  role  of  <u>/dev/initrd</u>  in  the  above  is  to reuse the configuration data during normal system
       operation without requiring initial kernel selection, a large generic kernel or, recompiling the kernel.

       A second scenario is for installations where Linux runs on systems with different hardware configurations
       in a single administrative network.  In such cases, it may be desirable  to  use  only  a  small  set  of
       kernels  (ideally only one) and to keep the system-specific part of configuration information as small as
       possible.  In this case, create a common file with all needed modules.  Then, only the <u>/linuxrc</u> file or a
       file executed by <u>/linuxrc</u> would be different.

       A third scenario is more convenient recovery disks.  Because information like the location  of  the  root
       filesystem  partition  is  not  needed  at boot time, the system loaded from <u>/dev/initrd</u> can use a dialog
       and/or auto-detection followed by a possible sanity check.

       Last but not least, Linux distributions on CD-ROM may use <b>initrd</b> for easy installation from  the  CD-ROM.
       The  distribution  can  use  <b>LOADLIN</b>  to  directly  load  <u>/dev/initrd</u> from CD-ROM without the need of any
       floppies.  The distribution could also use a <b>LILO</b> boot floppy and then bootstrap a bigger  RAM  disk  via
       <u>/dev/initrd</u> from the CD-ROM.

</pre><h4><b>FILES</b></h4><pre>
       <u>/dev/initrd</u>
       <u>/dev/ram0</u>
       <u>/linuxrc</u>
       <u>/initrd</u>

</pre><h4><b>NOTES</b></h4><pre>
       •  With the current kernel, any filesystems that remain mounted when <u>/dev/ram0</u> is moved from <u>/</u> to <u>/initrd</u>
          continue to be accessible.  However, the <u><a href="file:/proc/mounts">/proc/mounts</a></u> entries are not updated.

       •  With  the  current  kernel,  if  directory  <u>/initrd</u>  does  not exist, then <u>/dev/ram0</u> will <b>not</b> be fully
          unmounted if <u>/dev/ram0</u> is used by any process or has any filesystem mounted on it.   If  <u>/dev/ram0</u>  is
          <b>not</b> fully unmounted, then <u>/dev/ram0</u> will remain in memory.

       •  Users  of  <u>/dev/initrd</u>  should  not depend on the behavior given in the above notes.  The behavior may
          change in future versions of the Linux kernel.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <b><a href="../man1/chown.1.html">chown</a></b>(1), <b><a href="../man1/mknod.1.html">mknod</a></b>(1), <b><a href="../man4/ram.4.html">ram</a></b>(4), <b><a href="../man8/freeramdisk.8.html">freeramdisk</a></b>(8), <b><a href="../man8/rdev.8.html">rdev</a></b>(8)

       <u>Documentation/admin-guide/initrd.rst</u> (or <u>Documentation/initrd.txt</u> before Linux 4.10) in the Linux  kernel
       source tree, the LILO documentation, the LOADLIN documentation, the SYSLINUX documentation

Linux man-pages 6.9.1                              2024-06-15                                          <u><a href="../man4/initrd.4.html">initrd</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>