<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tcp — Internet Transmission Control Protocol</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       tcp — Internet Transmission Control Protocol

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>#include</b> <b>&lt;sys/types.h&gt;</b>
       <b>#include</b> <b>&lt;sys/socket.h&gt;</b>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/netinet/in.h">netinet/in.h</a>&gt;</b>
       <b>#include</b> <b>&lt;<a href="file:/usr/include/netinet/tcp.h">netinet/tcp.h</a>&gt;</b>

       <u>int</u>
       <b>socket</b>(<u>AF_INET</u>, <u>SOCK_STREAM</u>, <u>0</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  TCP  protocol provides reliable, flow-controlled, two-way transmission of data.  It is a byte-stream
       protocol used to support the SOCK_STREAM abstraction.  TCP uses the standard Internet address format and,
       in addition, provides a per-host collection of “port addresses”.  Thus, each address is  composed  of  an
       Internet  address  specifying  the host and network, with a specific TCP port on the host identifying the
       peer entity.

       Sockets utilizing the TCP protocol are either “active” or “passive”.  Active sockets initiate connections
       to passive sockets.  By default, TCP sockets  are  created  active;  to  create  a  passive  socket,  the
       <u><a href="../man2/listen.2.html">listen</a></u>(2)  system  call must be used after binding the socket with the <u><a href="../man2/bind.2.html">bind</a></u>(2) system call.  Only passive
       sockets may use the <u><a href="../man2/accept.2.html">accept</a></u>(2) call to accept incoming connections.   Only  active  sockets  may  use  the
       <u><a href="../man2/connect.2.html">connect</a></u>(2) call to initiate connections.

       Passive  sockets  may  “underspecify”  their location to match incoming connection requests from multiple
       networks.  This technique, termed “wildcard addressing”, allows a single server  to  provide  service  to
       clients  on  multiple  networks.   To create a socket which listens on all networks, the Internet address
       INADDR_ANY must be bound.  The TCP port may still  be  specified  at  this  time;  if  the  port  is  not
       specified,  the  system will assign one.  Once a connection has been established, the socket's address is
       fixed by the peer entity's location.  The address assigned to the socket is the address  associated  with
       the  network  interface through which packets are being transmitted and received.  Normally, this address
       corresponds to the peer entity's network.

       TCP supports  a  number  of  socket  options  which  can  be  set  with  <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2)  and  tested  with
       <u><a href="../man2/getsockopt.2.html">getsockopt</a></u>(2):

       TCP_INFO          Information  about  a  socket's  underlying TCP session may be retrieved by passing the
                         read-only option TCP_INFO to <u><a href="../man2/getsockopt.2.html">getsockopt</a></u>(2).  It accepts a single argument: a pointer to
                         an instance of <u>struct</u> <u>tcp_info</u>.

                         This API is subject to change;  consult  the  source  to  determine  which  fields  are
                         currently  filled  out  by this option.  FreeBSD specific additions include send window
                         size, receive window size, and bandwidth-controlled window space.

       TCP_CCALGOOPT     Set or query congestion control  algorithm  specific  parameters.   See  <u><a href="../man4/mod_cc.4.html">mod_cc</a></u>(4)  for
                         details.

       TCP_CONGESTION    Select  or query the congestion control algorithm that TCP will use for the connection.
                         See <u><a href="../man4/mod_cc.4.html">mod_cc</a></u>(4) for details.

       TCP_FUNCTION_BLK  Select or query the set of functions that TCP  will  use  for  this  connection.   This
                         allows  a  user to select an alternate TCP stack.  The alternate TCP stack must already
                         be loaded in the kernel.  To list the available TCP stacks, see <u>functions_available</u>  in
                         the  “MIB  Variables”  section  further  down.   To  list  the  default  TCP stack, see
                         <u>functions_default</u> in the “MIB Variables” section.

       TCP_KEEPINIT      This <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2) option accepts a per-socket timeout argument of  <u>u_int</u>  in  seconds,
                         for  new,  non-established TCP connections.  For the global default in milliseconds see
                         <u>keepinit</u> in the “MIB Variables” section further down.

       TCP_KEEPIDLE      This <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2) option accepts an argument of <u>u_int</u>  for  the  amount  of  time,  in
                         seconds, that the connection must be idle before keepalive probes (if enabled) are sent
                         for  the  connection  of  this  socket.   If  set  on  a listening socket, the value is
                         inherited by the newly created socket  upon  <u><a href="../man2/accept.2.html">accept</a></u>(2).   For  the  global  default  in
                         milliseconds see <u>keepidle</u> in the “MIB Variables” section further down.

       TCP_KEEPINTVL     This  <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2) option accepts an argument of <u>u_int</u> to set the per-socket interval,
                         in seconds, between keepalive probes sent to a peer.  If set on a listening socket, the
                         value is inherited by the newly created socket upon <u><a href="../man2/accept.2.html">accept</a></u>(2).  For the global  default
                         in milliseconds see <u>keepintvl</u> in the “MIB Variables” section further down.

       TCP_KEEPCNT       This  <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2)  option accepts an argument of <u>u_int</u> and allows a per-socket tuning
                         of the number of probes sent, with no response, before the connection will be  dropped.
                         If  set  on a listening socket, the value is inherited by the newly created socket upon
                         <u><a href="../man2/accept.2.html">accept</a></u>(2).  For the global default see the  <u>keepcnt</u>  in  the  “MIB  Variables”  section
                         further down.

       TCP_NODELAY       Under  most  circumstances,  TCP sends data when it is presented; when outstanding data
                         has not yet been acknowledged, it gathers small amounts of  output  to  be  sent  in  a
                         single packet once an acknowledgement is received.  For a small number of clients, such
                         as  window  systems  that  send a stream of mouse events which receive no replies, this
                         packetization may cause significant delays.  The  boolean  option  TCP_NODELAY  defeats
                         this algorithm.

       TCP_MAXSEG        By default, a sender- and receiver-TCP will negotiate among themselves to determine the
                         maximum  segment size to be used for each connection.  The TCP_MAXSEG option allows the
                         user to determine the result of this negotiation, and to reduce it if desired.

       TCP_NOOPT         TCP usually sends a number of options in each  packet,  corresponding  to  various  TCP
                         extensions  which are provided in this implementation.  The boolean option TCP_NOOPT is
                         provided to disable TCP option use on a per-connection basis.

       TCP_NOPUSH        By convention,  the  sender-TCP  will  set  the  “push”  bit,  and  begin  transmission
                         immediately  (if  permitted)  at  the  end of every user call to <u><a href="../man2/write.2.html">write</a></u>(2) or <u><a href="../man2/writev.2.html">writev</a></u>(2).
                         When this option is set to a non-zero value, TCP will delay sending  any  data  at  all
                         until either the socket is closed, or the internal send buffer is filled.

       TCP_MD5SIG        This  option  enables  the  use of MD5 digests (also known as TCP-MD5) on writes to the
                         specified socket.  Outgoing traffic  is  digested;  digests  on  incoming  traffic  are
                         verified.   When  this  option  is  enabled  on  a socket, all inbound and outgoing TCP
                         segments must be signed with MD5 digests.

                         One common use for this in a FreeBSD router deployment is to enable  based  routers  to
                         interwork with Cisco equipment at peering points.  Support for this feature conforms to
                         RFC 2385.

                         In  order  for this option to function correctly, it is necessary for the administrator
                         to add a tcp-md5 key entry to the system's security associations database (SADB)  using
                         the  <u><a href="../man8/setkey.8.html">setkey</a></u>(8)  utility.   This entry can only be specified on a per-host basis at this
                         time.

                         If an SADB entry cannot be found for the destination, the  system  does  not  send  any
                         outgoing segments and drops any inbound segments.

                         Each dropped segment is taken into account in the TCP protocol statistics.

       The   option  level  for  the  <u><a href="../man2/setsockopt.2.html">setsockopt</a></u>(2)  call  is  the  protocol  number  for  TCP,  available  from
       <u><a href="../man3/getprotobyname.3.html">getprotobyname</a></u>(3), or IPPROTO_TCP.  All options are declared in &lt;<u>netinet/tcp.h</u>&gt;.

       Options at the IP transport level may be used with TCP; see <u><a href="../man4/ip.4.html">ip</a></u>(4).  Incoming connection requests that are
       source-routed are noted, and the reverse source route is used in responding.

       The default congestion control algorithm for TCP is <u><a href="../man4/cc_newreno.4.html">cc_newreno</a></u>(4).  Other congestion  control  algorithms
       can be made available using the <u><a href="../man4/mod_cc.4.html">mod_cc</a></u>(4) framework.

   <b>MIB</b> <b>Variables</b>
       The TCP protocol implements a number of variables in the <u>net.inet.tcp</u> branch of the <u><a href="../man3/sysctl.3.html">sysctl</a></u>(3) MIB.

       TCPCTL_DO_RFC1323  (<u>rfc1323</u>)  Implement  the window scaling and timestamp options of RFC 1323 (default is
                          true).

       TCPCTL_MSSDFLT     (<u>mssdflt</u>) The default value used for the maximum segment size (“MSS”) when  no  advice
                          to the contrary is received from MSS negotiation.

       TCPCTL_SENDSPACE   (<u>sendspace</u>) Maximum TCP send window.

       TCPCTL_RECVSPACE   (<u>recvspace</u>) Maximum TCP receive window.

       <u>log_in_vain</u>        Log  any  connection  attempts  to  ports  where  there  is  not  a  socket  accepting
                          connections.  The value of 1 limits the  logging  to  SYN  (connection  establishment)
                          packets only.  That of 2 results in any TCP packets to closed ports being logged.  Any
                          value  unlisted  above  disables  the  logging  (default  is  0,  i.e., the logging is
                          disabled).

       <u>msl</u>                The Maximum Segment Lifetime, in milliseconds, for a packet.

       <u>keepinit</u>           Timeout, in milliseconds, for new, non-established TCP connections.   The  default  is
                          75000 msec.

       <u>keepidle</u>           Amount  of  time,  in  milliseconds, that the connection must be idle before keepalive
                          probes (if enabled) are sent.  The default is 7200000 msec (2 hours).

       <u>keepintvl</u>          The interval, in milliseconds, between keepalive probes sent to remote machines,  when
                          no response is received on a <u>keepidle</u> probe.  The default is 75000 msec.

       <u>keepcnt</u>            Number  of probes sent, with no response, before a connection is dropped.  The default
                          is 8 packets.

       <u>always_keepalive</u>   Assume that SO_KEEPALIVE is set on all TCP connections, the kernel  will  periodically
                          send a packet to the remote host to verify the connection is still up.

       <u>icmp_may_rst</u>       Certain ICMP unreachable messages may abort connections in SYN-SENT state.

       <u>do_tcpdrain</u>        Flush packets in the TCP reassembly queue if the system is low on mbufs.

       <u>blackhole</u>          If  enabled,  disable  sending  of  RST when a connection is attempted to a port where
                          there is not a socket accepting connections.  See <u><a href="../man4/blackhole.4.html">blackhole</a></u>(4).

       <u>delayed_ack</u>        Delay ACK to try and piggyback it onto a data packet.

       <u>delacktime</u>         Maximum amount of time, in milliseconds, before a delayed ACK is sent.

       <u>path_mtu_discovery</u>
                          Enable Path MTU Discovery.

       <u>tcbhashsize</u>        Size of the TCP control-block hash table (read-only).  This may  be  tuned  using  the
                          kernel option TCBHASHSIZE or by setting <u>net.inet.tcp.tcbhashsize</u> in the <u><a href="../man8/loader.8.html">loader</a></u>(8).

       <u>pcbcount</u>           Number of active process control blocks (read-only).

       <u>syncookies</u>         Determines  whether  or  not  SYN  cookies  should  be  generated for outbound SYN-ACK
                          packets.  SYN cookies are a great help during SYN flood attacks, and  are  enabled  by
                          default.  (See <u><a href="../man4/syncookies.4.html">syncookies</a></u>(4).)

       <u>isn_reseed_interval</u>
                          The  interval  (in  seconds)  specifying  how  often  the secret data used in RFC 1948
                          initial sequence number calculations should be reseeded.  By default, this variable is
                          set to zero, indicating that  no  reseeding  will  occur.   Reseeding  should  not  be
                          necessary, and will break TIME_WAIT recycling for a few minutes.

       <u>reass.cursegments</u>  The current total number of segments present in all reassembly queues.

       <u>reass.maxsegments</u>  The  maximum  limit on the total number of segments across all reassembly queues.  The
                          limit can be adjusted as a tunable.

       <u>reass.maxqueuelen</u>  The maximum number of segments allowed in each  reassembly  queue.   By  default,  the
                          system  chooses a limit based on each TCP connection's receive buffer size and maximum
                          segment size (MSS).  The actual limit applied to a session's reassembly queue will  be
                          the   lower   of   the   system-calculated  automatic  limit  and  the  user-specified
                          <u>reass.maxqueuelen</u> limit.

       <u>rexmit_initial</u>, <u>rexmit_min</u>, <u>rexmit_slop</u>
                          Adjust the retransmit timer calculation for TCP.  The slop is typically added  to  the
                          raw  calculation  to  take  into  account occasional variances that the SRTT (smoothed
                          round-trip time) is unable to accommodate, while the  minimum  specifies  an  absolute
                          minimum.   While  a  number of TCP RFCs suggest a 1 second minimum, these RFCs tend to
                          focus on streaming behavior, and fail to deal with the fact that a  1  second  minimum
                          has  severe  detrimental effects over lossy interactive connections, such as a 802.11b
                          wireless link, and over very fast but lossy connections for those cases not covered by
                          the fast retransmit code.  For this reason, we use 200ms of slop and a near-0 minimum,
                          which gives us an effective minimum of 200ms (similar to Linux).  The initial value is
                          used before an RTT measurement has been performed.

       <u>initcwnd_segments</u>  Enable the ability to specify initial congestion window in number  of  segments.   The
                          default  value  is  10  as suggested by RFC 6928.  Changing the value on fly would not
                          affect  connections  using  congestion  window  from  the  hostcache.   Caution:  This
                          regulates  the burst of packets allowed to be sent in the first RTT.  The value should
                          be relative to the link capacity.  Start with small values for  lower-capacity  links.
                          Large  bursts can cause buffer overruns and packet drops if routers have small buffers
                          or the link is experiencing congestion.

       <u>rfc6675_pipe</u>       Calculate the bytes in flight using the algorithm described in RFC 6675, and is also a
                          prerequisite to enable Proportional Rate Reduction.

       <u>rfc3042</u>            Enable the Limited Transmit algorithm as  described  in  RFC  3042.   It  helps  avoid
                          timeouts  on  lossy  links and also when the congestion window is small, as happens on
                          short transfers.

       <u>rfc3390</u>            Enable support for RFC 3390, which allows for  a  variable-sized  starting  congestion
                          window  on  new  connections,  depending  on  the  maximum  segment  size.  This helps
                          throughput in general, but particularly affects  short  transfers  and  high-bandwidth
                          large propagation-delay connections.

       <u>sack.enable</u>        Enable  support  for  RFC  2018, TCP Selective Acknowledgment option, which allows the
                          receiver to inform the sender about all successfully arrived  segments,  allowing  the
                          sender to retransmit the missing segments only.

       <u>sack.maxholes</u>      Maximum number of SACK holes per connection.  Defaults to 128.

       <u>sack.globalmaxholes</u>
                          Maximum number of SACK holes per system, across all connections.  Defaults to 65536.

       <u>maxtcptw</u>           When  a  TCP connection enters the TIME_WAIT state, its associated socket structure is
                          freed, since it is of negligible size and use, and a new  structure  is  allocated  to
                          contain  a minimal amount of information necessary for sustaining a connection in this
                          state, called the compressed TCP TIME_WAIT state.  Since  this  structure  is  smaller
                          than  a  socket  structure,  it  can  save a significant amount of system memory.  The
                          <u>net.inet.tcp.maxtcptw</u> MIB variable controls the maximum  number  of  these  structures
                          allocated.  By default, it is initialized to <u>kern.ipc.maxsockets</u> / 5.

       <u>nolocaltimewait</u>    Suppress  creating  of  compressed  TCP TIME_WAIT states for connections in which both
                          endpoints are local.

       <u>fast_finwait2_recycle</u>
                          Recycle TCP FIN_WAIT_2 connections faster when the socket is marked as SBS_CANTRCVMORE
                          (no user process has the socket open, data received on the  socket  cannot  be  read).
                          The timeout used here is <u>finwait2_timeout</u>.

       <u>finwait2_timeout</u>   Timeout  to  use  for  fast  recycling  of TCP FIN_WAIT_2 connections.  Defaults to 60
                          seconds.

       <u>ecn.enable</u>         Enable support for TCP Explicit Congestion  Notification  (ECN).   ECN  allows  a  TCP
                          sender to reduce the transmission rate in order to avoid packet drops.  Settings:
                          0       Disable ECN.
                          1       Allow  incoming connections to request ECN.  Outgoing connections will request
                                  ECN.
                          2       Allow incoming connections to request  ECN.   Outgoing  connections  will  not
                                  request ECN.

       <u>ecn.maxretries</u>     Number  of  retries  (SYN  or  SYN/ACK retransmits) before disabling ECN on a specific
                          connection.  This is needed to  help  with  connection  establishment  when  a  broken
                          firewall is in the network path.

       <u>pmtud_blackhole_detection</u>
                          Turn  on automatic path MTU blackhole detection.  In case of retransmits OS will lower
                          the MSS to check if it's MTU problem.  If current MSS is greater than configured value
                          to try, it will be set to configured value, otherwise, MSS  will  be  set  to  default
                          values (<u>net.inet.tcp.mssdflt</u> and <u>net.inet.tcp.v6mssdflt</u>).

       <u>pmtud_blackhole_mss</u>
                          MSS to try for IPv4 if PMTU blackhole detection is turned on.

       <u>v6pmtud_blackhole_mss</u>
                          MSS to try for IPv6 if PMTU blackhole detection is turned on.

       <u>pmtud_blackhole_activated</u>
                          Number of times configured values were used in an attempt to downshift.

       <u>pmtud_blackhole_activated_min_mss</u>
                          Number of times default MSS was used in an attempt to downshift.

       <u>pmtud_blackhole_failed</u>
                          Number of connections for which retransmits continued even after MSS downshift.

       <u>functions_available</u>
                          List of available TCP function blocks (TCP stacks).

       <u>functions_default</u>  The default TCP function block (TCP stack).

       <u>functions_inherit_listen_socket_stack</u>
                          Determines  whether  to  inherit  listen  socket's tcp stack or use the current system
                          default tcp stack, as defined by <u>functions_default</u>
                          ).  Default is true.

       <u>insecure_rst</u>       Use criteria defined in RFC793 instead of RFC5961 for accepting RST segments.  Default
                          is false.

       <u>insecure_syn</u>       Use criteria defined in RFC793 instead of RFC5961 for accepting SYN segments.  Default
                          is false.

       <u>ts_offset_per_conn</u>
                          When initializing the TCP timestamps, use a per connection offset  instead  of  a  per
                          host  pair  offset.   Default  is  to use per connection offsets as recommended in RFC
                          7323.

</pre><h4><b>ERRORS</b></h4><pre>
       A socket operation may fail with one of the following errors returned:

       [EISCONN]          when trying to establish a connection on a socket which already has one;

       [ENOBUFS] or [ENOMEM]
                          when the system runs out of memory for an internal data structure;

       [ETIMEDOUT]        when a connection was dropped due to excessive retransmissions;

       [ECONNRESET]       when the remote peer forces the connection to be closed;

       [ECONNREFUSED]     when the remote peer actively refuses connection  establishment  (usually  because  no
                          process is listening to the port);

       [EADDRINUSE]       when  an  attempt  is  made  to  create  a  socket  with a port which has already been
                          allocated;

       [EADDRNOTAVAIL]    when an attempt is made to create a socket with a network address for which no network
                          interface exists;

       [EAFNOSUPPORT]     when an attempt is made to bind or connect a socket to a multicast address.

       [EINVAL]           when trying to change TCP function blocks at an invalid point in the session;

       [ENOENT]           when trying to use a TCP function block that is not available;

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man2/getsockopt.2.html">getsockopt</a></u>(2),  <u><a href="../man2/socket.2.html">socket</a></u>(2),  <u><a href="../man3/sysctl.3.html">sysctl</a></u>(3),  <u><a href="../man4/blackhole.4.html">blackhole</a></u>(4),  <u><a href="../man4/inet.4.html">inet</a></u>(4),  <u><a href="../man4/intro.4.html">intro</a></u>(4),  <u><a href="../man4/ip.4.html">ip</a></u>(4),  <u><a href="../man4/mod_cc.4.html">mod_cc</a></u>(4),  <u><a href="../man4/siftr.4.html">siftr</a></u>(4),
       <u><a href="../man4/syncache.4.html">syncache</a></u>(4), <u><a href="../man8/setkey.8.html">setkey</a></u>(8), <u><a href="../man9/tcp_functions.9.html">tcp_functions</a></u>(9)

       V. Jacobson, R. Braden, and D. Borman, <u>TCP</u> <u>Extensions</u> <u>for</u> <u>High</u> <u>Performance</u>, RFC 1323.

       A. Heffernan, <u>Protection</u> <u>of</u> <u>BGP</u> <u>Sessions</u> <u>via</u> <u>the</u> <u>TCP</u> <u>MD5</u> <u>Signature</u> <u>Option</u>, RFC 2385.

       K.  Ramakrishnan,  S.  Floyd, and D. Black, <u>The</u> <u>Addition</u> <u>of</u> <u>Explicit</u> <u>Congestion</u> <u>Notification</u> <u>(ECN)</u> <u>to</u> <u>IP</u>,
       RFC 3168.

</pre><h4><b>HISTORY</b></h4><pre>
       The TCP protocol appeared in 4.2BSD.  The RFC 1323 extensions for  window  scaling  and  timestamps  were
       added in 4.4BSD.  The TCP_INFO option was introduced in Linux 2.6 and is <u>subject</u> <u>to</u> <u>change</u>.

Debian                                          December 1, 2019                                          <u><a href="../man4/TCP.4.html">TCP</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>