<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nvme — NVM Express core driver</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       nvme — NVM Express core driver

</pre><h4><b>SYNOPSIS</b></h4><pre>
       To compile this driver into your kernel, place the following line in your kernel configuration file:

             <b>device</b> <b>nvme</b>

       Or, to load the driver as a module at boot, place the following line in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             nvme_load="YES"

       Most  users  will  also  want to enable <u><a href="../man4/nvd.4.html">nvd</a></u>(4) or <u><a href="../man4/nda.4.html">nda</a></u>(4) to expose NVM Express namespaces as disk devices
       which can be partitioned.  Note that in NVM Express terms, a namespace is roughly equivalent  to  a  SCSI
       LUN.

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>nvme</b> driver provides support for NVM Express (NVMe) controllers, such as:

       <b>•</b>   Hardware initialization

       <b>•</b>   Per-CPU IO queue pairs

       <b>•</b>   API for registering NVMe namespace consumers such as <u><a href="../man4/nvd.4.html">nvd</a></u>(4) or <u><a href="../man4/nda.4.html">nda</a></u>(4)

       <b>•</b>   API for submitting NVM commands to namespaces

       <b>•</b>   Ioctls for controller and namespace configuration and management

       The  <b>nvme</b>  driver  creates controller device nodes in the format <u>/dev/nvmeX</u> and namespace device nodes in
       the format <u>/dev/nvmeXnsY</u>.  Note that the NVM Express specification starts numbering namespaces at 1,  not
       0, and this driver follows that convention.

</pre><h4><b>CONFIGURATION</b></h4><pre>
       By default, <b>nvme</b> will create an I/O queue pair for each CPU, provided enough MSI-X vectors and NVMe queue
       pairs  can  be allocated.  If not enough vectors or queue pairs are available, <a href="../man4/nvme.4.html">nvme</a>(4) will use a smaller
       number of queue pairs and assign multiple CPUs per queue pair.

       To force a single I/O queue pair shared by all CPUs, set the following tunable value in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             hw.nvme.per_cpu_io_queues=0

       To assign more than one CPU per I/O queue pair, thereby reducing the number of MSI-X vectors consumed  by
       the device, set the following tunable value in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             hw.nvme.min_cpus_per_ioq=X

       To  force  legacy  interrupts  for  all  <b>nvme</b>  driver  instances,  set  the  following  tunable  value in
       <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             hw.nvme.force_intx=1

       Note that use of INTx implies disabling of per-CPU I/O queue pairs.

       To control maximum amount of system RAM in bytes to use as Host Memory Buffer for  capable  devices,  set
       the following tunable:

             hw.nvme.hmb_max

       The default value is 5% of physical memory size per device.

       The  <u><a href="../man4/nvd.4.html">nvd</a></u>(4) driver is used to provide a disk driver to the system by default.  The <u><a href="../man4/nda.4.html">nda</a></u>(4) driver can also
       be used instead.  The <u><a href="../man4/nvd.4.html">nvd</a></u>(4) driver performs better with smaller transactions and few TRIM commands.   It
       sends  all  commands  directly  to  the drive immediately.  The <u><a href="../man4/nda.4.html">nda</a></u>(4) driver performs better with larger
       transactions and also collapses TRIM commands giving better performance.  It can queue  commands  to  the
       drive;  combine BIO_DELETE commands into a single trip; and use the CAM I/O scheduler to bias one type of
       operation over another.  To select the <u><a href="../man4/nda.4.html">nda</a></u>(4) driver, set the following tunable value in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             hw.nvme.verbose_cmd_dump=1

</pre><h4><b>SYSCTL</b> <b>VARIABLES</b></h4><pre>
       The following controller-level sysctls are currently implemented:

       <u>dev.nvme.0.num_cpus_per_ioq</u>
               (R) Number of CPUs associated with each I/O queue pair.

       <u>dev.nvme.0.int_coal_time</u>
               (R/W) Interrupt coalescing timer period in microseconds.  Set to 0 to disable.

       <u>dev.nvme.0.int_coal_threshold</u>
               (R/W) Interrupt coalescing threshold in number of command completions.  Set to 0 to disable.

       The following queue pair-level sysctls are currently implemented.  Admin queue sysctls take the format of
       dev.nvme.0.adminq and I/O queue sysctls take the format of dev.nvme.0.ioq0.

       <u>dev.nvme.0.ioq0.num_entries</u>
               (R) Number of entries in this queue pair's command and completion queue.

       <u>dev.nvme.0.ioq0.num_tr</u>
               (R) Number of nvme_tracker structures currently allocated for this queue pair.

       <u>dev.nvme.0.ioq0.num_prp_list</u>
               (R) Number of nvme_prp_list structures currently allocated for this queue pair.

       <u>dev.nvme.0.ioq0.sq_head</u>
               (R) Current location of the submission queue head pointer as observed by the  driver.   The  head
               pointer is incremented by the controller as it takes commands off of the submission queue.

       <u>dev.nvme.0.ioq0.sq_tail</u>
               (R)  Current location of the submission queue tail pointer as observed by the driver.  The driver
               increments the tail pointer after writing a command into the submission queue to  signal  that  a
               new command is ready to be processed.

       <u>dev.nvme.0.ioq0.cq_head</u>
               (R)  Current location of the completion queue head pointer as observed by the driver.  The driver
               increments the head pointer after finishing with a  completion  entry  that  was  posted  by  the
               controller.

       <u>dev.nvme.0.ioq0.num_cmds</u>
               (R) Number of commands that have been submitted on this queue pair.

       <u>dev.nvme.0.ioq0.dump_debug</u>
               (W)  Writing 1 to this sysctl will dump the full contents of the submission and completion queues
               to the console.

       In addition to the typical pci attachment, the <b>nvme</b>  driver  supports  attaching  to  a  <u><a href="../man4/ahci.4.html">ahci</a></u>(4)  device.
       Intel's Rapid Storage Technology (RST) hides the nvme device behind the AHCI device due to limitations in
       Windows.   However,  this  effectively hides it from the FreeBSD kernel.  To work around this limitation,
       FreeBSD detects that the AHCI device supports RST and when it is enabled.  See <u><a href="../man4/ahci.4.html">ahci</a></u>(4) for more details.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/nda.4.html">nda</a></u>(4), <u><a href="../man4/nvd.4.html">nvd</a></u>(4), <u><a href="../man4/pci.4.html">pci</a></u>(4), <u><a href="../man8/nvmecontrol.8.html">nvmecontrol</a></u>(8), <u><a href="../man9/disk.9.html">disk</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>nvme</b> driver first appeared in FreeBSD 9.2.

</pre><h4><b>AUTHORS</b></h4><pre>
       The <b>nvme</b> driver was developed by Intel and originally written by Jim Harris &lt;<u><a href="mailto:jimharris@FreeBSD.org">jimharris@FreeBSD.org</a></u>&gt;, with
       contributions from Joe Golio at EMC.

       This man page was written by Jim Harris &lt;<u><a href="mailto:jimharris@FreeBSD.org">jimharris@FreeBSD.org</a></u>&gt;.

Debian                                            June 6, 2020                                           <u><a href="../man4/NVME.4.html">NVME</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>