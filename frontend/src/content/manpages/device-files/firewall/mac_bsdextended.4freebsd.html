<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mac_bsdextended — file system firewall policy</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       mac_bsdextended — file system firewall policy

</pre><h4><b>SYNOPSIS</b></h4><pre>
       To  compile  the  file  system firewall policy into your kernel, place the following lines in your kernel
       configuration file:

             <b>options</b> <b>MAC</b>
             <b>options</b> <b>MAC_BSDEXTENDED</b>

       Alternately, to load the file system firewall policy module at boot time, place  the  following  line  in
       your kernel configuration file:

             <b>options</b> <b>MAC</b>

       and in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             mac_bsdextended_load="YES"

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  <b>mac_bsdextended</b>  security policy module provides an interface for the system administrator to impose
       mandatory rules regarding users and some system objects.  Rules are uploaded  to  the  module  (typically
       using  <u><a href="../man8/ugidfw.8.html">ugidfw</a></u>(8), or some other tool utilizing <u><a href="../man3/libugidfw.3.html">libugidfw</a></u>(3)) where they are stored internally and used to
       determine whether to allow or deny specific accesses (see <u><a href="../man8/ugidfw.8.html">ugidfw</a></u>(8)).

</pre><h4><b>IMPLEMENTATION</b> <b>NOTES</b></h4><pre>
       While the traditional <u><a href="../man9/mac.9.html">mac</a></u>(9) entry points are implemented, policy labels are not  used;  instead,  access
       control  decisions are made by iterating through the internal list of rules until a rule which denies the
       particular access is found, or the end of the list is reached.  The <b>mac_bsdextended</b> policy works  similar
       to <u><a href="../man8/ipfw.8.html">ipfw</a></u>(8) or by using a <u>first</u> <u>match</u> <u>semantic</u>.  This means that not all rules are applied, only the first
       matched rule; thus if Rule A allows access and Rule B blocks access, Rule B will never be applied.

   <b>Sysctls</b>
       The following sysctls may be used to tweak the behavior of <b>mac_bsdextended</b>:

       <u>security.mac.bsdextended.enabled</u>
               Set to zero or one to toggle the policy off or on.

       <u>security.mac.bsdextended.rule_count</u>
               List the number of defined rules, the maximum rule count is current set at 256.

       <u>security.mac.bsdextended.rule_slots</u>
               List the number of rule slots currently being used.

       <u>security.mac.bsdextended.firstmatch_enabled</u>
               Toggle   between  the  old  all  rules  match  functionality  and  the  new  first  rule  matches
               functionality.  This is enabled by default.

       <u>security.mac.bsdextended.logging</u>
               Log all access violations via the AUTHPRIV <u><a href="../man3/syslog.3.html">syslog</a></u>(3) facility.

       <u>security.mac.bsdextended.rules</u>
               Currently does nothing interesting.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man3/libugidfw.3.html">libugidfw</a></u>(3),  <u><a href="../man3/syslog.3.html">syslog</a></u>(3),  <u><a href="../man4/mac.4.html">mac</a></u>(4),  <u><a href="../man4/mac_biba.4.html">mac_biba</a></u>(4),  <u><a href="../man4/mac_ifoff.4.html">mac_ifoff</a></u>(4),  <u><a href="../man4/mac_lomac.4.html">mac_lomac</a></u>(4),  <u><a href="../man4/mac_mls.4.html">mac_mls</a></u>(4),  <u><a href="../man4/mac_none.4.html">mac_none</a></u>(4),
       <u><a href="../man4/mac_partition.4.html">mac_partition</a></u>(4), <u><a href="../man4/mac_portacl.4.html">mac_portacl</a></u>(4), <u><a href="../man4/mac_seeotheruids.4.html">mac_seeotheruids</a></u>(4), <u><a href="../man4/mac_test.4.html">mac_test</a></u>(4), <u><a href="../man8/ipfw.8.html">ipfw</a></u>(8), <u><a href="../man8/ugidfw.8.html">ugidfw</a></u>(8), <u><a href="../man9/mac.9.html">mac</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       The  <b>mac_bsdextended</b>  policy  module  first  appeared  in FreeBSD 5.0 and was developed by the TrustedBSD
       Project.

       The "match first case" and logging capabilities were later added by Tom Rhodes &lt;<u><a href="mailto:trhodes@FreeBSD.org">trhodes@FreeBSD.org</a></u>&gt;.

</pre><h4><b>AUTHORS</b></h4><pre>
       This software was contributed to the FreeBSD Project by NAI  Labs,  the  Security  Research  Division  of
       Network  Associates  Inc.  under  DARPA/SPAWAR  contract N66001-01-C-8035 (“CBOSS”), as part of the DARPA
       CHATS research program.

Debian                                            May 21, 2005                                <u><a href="../man4/MAC_BSDEXTENDED.4.html">MAC_BSDEXTENDED</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>