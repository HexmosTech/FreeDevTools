<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dtrace_sched — a DTrace provider for tracing CPU scheduling events</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       dtrace_sched — a DTrace provider for tracing CPU scheduling events

</pre><h4><b>SYNOPSIS</b></h4><pre>
       <b>sched:::change-pri</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>, <u>uint8_t</u>);

       <b>sched:::dequeue</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>, <u>void</u> <u>*</u>);

       <b>sched:::enqueue</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>, <u>void</u> <u>*</u>, <u>int</u>);

       <b>sched:::lend-pri</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>, <u>uint8_t</u>, <u>struct</u> <u>thread</u> <u>*</u>);

       <b>sched:::load-change</b>(<u>int</u>, <u>int</u>);

       <b>sched:::off-cpu</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>);

       <b>sched:::on-cpu</b>();

       <b>sched:::preempt</b>();

       <b>sched:::remain-cpu</b>();

       <b>sched:::surrender</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>);

       <b>sched:::sleep</b>();

       <b>sched:::tick</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>);

       <b>sched:::wakeup</b>(<u>struct</u> <u>thread</u> <u>*</u>, <u>struct</u> <u>proc</u> <u>*</u>);

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The  DTrace  <b>sched</b>  provider  allows  the tracing of events related to CPU scheduling in the 4BSD and ULE
       schedulers.

       The <b>sched:::change-pri</b>() probe fires when a thread's active scheduling priority is about to  be  updated.
       The  first  two  arguments  are  the  thread whose priority is about to be changed, and the corresponding
       process.  The third argument is the new absolute priority for the thread,  while  the  current  value  is
       given  by  args[0]-&gt;td_priority.   The  <b>sched:::lend-pri</b>()  probe fires when the currently-running thread
       elevates the priority of another thread via priority lending.  The first two  arguments  are  the  thread
       whose  priority  is  about  to  be changed, and the corresponding process.  The third argument is the new
       absolute priority for the thread.  The fourth argument is the currently-running thread.

       The <b>sched:::dequeue</b>() probe fires immediately before a runnable thread is removed from  a  scheduler  run
       queue.   This  may  occur  when the thread is about to begin execution on a CPU, or because the thread is
       being migrated to a different run queue.  The latter  event  may  occur  in  several  circumstances:  the
       scheduler may be attempting to rebalance load between multiple CPUs, the thread's scheduling priority may
       have  changed,  or  the  thread's  CPU  affinity  settings  may have changed.  The first two arguments to
       <b>sched:::dequeue</b>() are the thread and corresponding process.  The third argument is currently always NULL.
       The <b>sched:::enqueue</b>() probe fires when a runnable thread is about to be added to a scheduler  run  queue.
       Its first two arguments are the thread and corresponding process.  The third argument is currently always
       NULL.  The fourth argument is a boolean value that is non-zero if the thread is enqueued at the beginning
       of its run queue slot, and zero if the thread is instead enqueued at the end.

       The  <b>sched:::load-change</b>()  probe fires after the load of a thread queue is adjusted.  The first argument
       is the cpuid for the CPU associated with the thread queue, and the second argument is the  adjusted  load
       of the thread queue, i.e., the number of elements in the queue.

       The  <b>sched:::off-cpu</b>()  probe is triggered by the scheduler suspending execution of the currently-running
       thread, and the <b>sched:::on-cpu</b>() probe fires when the current thread has been selected to run  on  a  CPU
       and  is  about  to  begin  or  resume  execution.   The arguments to <b>sched:::off-cpu</b>() are the thread and
       corresponding process selected to run following the currently-running thread.  If these two  threads  are
       the same, the <b>sched:::remain-cpu</b>() probe will fire instead.

       The  <b>sched:::surrender</b>() probe fires when the scheduler is called upon to make a scheduling decision by a
       thread running on a different CPU, via an interprocessor interrupt.  The arguments to this probe are  the
       interrupted  thread  and  its corresponding process.  This probe currently always fires in the context of
       the interrupted thread.

       The <b>sched:::preempt</b>() probe will fire immediately before the currently-running thread is preempted.  When
       this occurs, the scheduler will select a  new  thread  to  run,  and  one  of  the  <b>sched:::off-cpu</b>()  or
       <b>sched:::remain-cpu</b>() probes will subsequently fire, depending on whether or not the scheduler selects the
       preempted thread.

       The  <b>sched:::sleep</b>()  probe  fires  immediately  before  the currently-running thread is about to suspend
       execution and begin waiting for a condition to be met.  The <b>sched:::wakeup</b>() probe fires when a thread is
       set up to resume execution after having gone to sleep.  Its arguments are the thread  being  awoken,  and
       the corresponding process.

       The  <b>sched:::tick</b>()  fires  before  each  scheduler  clock tick.  Its arguments are the currently-running
       thread and its corresponding process.

</pre><h4><b>ARGUMENTS</b></h4><pre>
       The <b>sched</b> provider probes use the kernel types <u>struct</u> <u>proc</u> and <u>struct</u> <u>thread</u> to represent  processes  and
       threads,  respectively.   These  structures  have  many fields and are defined in <u>sys/proc.h</u>.  In a probe
       body, the currently-running thread can always be obtained with the <u>curthread</u> global variable,  which  has
       type  <u>struct</u>  <u>thread</u>  <u>*</u>.  For example, when a running thread is about to sleep, the <b>sched:::sleep</b>() probe
       fires in the context of that thread, which can be accessed using <u>curthread</u>.  The <u>curcpu</u>  global  variable
       contains the cpuid of the CPU on which the currently-running thread is executing.

</pre><h4><b>EXAMPLES</b></h4><pre>
       The following script gives a breakdown of CPU utilization by process name:

             sched:::on-cpu
             {
                     self-&gt;ts = timestamp;
             }

             sched:::off-cpu
             /self-&gt;ts != 0/
             {
                     @[execname] = sum((timestamp - self-&gt;ts) / 1000);
                     self-&gt;ts = 0;
             }

       Here,  DTrace stores a timestamp each time a thread is scheduled to run, and computes the time elapsed in
       microseconds when it is descheduled.  The results are summed by process name.

</pre><h4><b>COMPATIBILITY</b></h4><pre>
       This provider is not compatible with the <b>sched</b> provider found  in  Solaris.   In  particular,  the  probe
       argument  types  are  native  FreeBSD  types,  and the <b>sched:::cpucaps-sleep</b>(), <b>sched:::cpucaps-wakeup</b>(),
       <b>sched:::schedctl-nopreempt</b>(), <b>sched:::schedctl-preempt</b>(), and  <b>sched:::schedctl-yield</b>()  probes  are  not
       available in FreeBSD.

       The <b>sched:::lend-pri</b>() and <b>sched:::load-change</b>() probes are specific to FreeBSD.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man1/dtrace.1.html">dtrace</a></u>(1), <u><a href="../man4/sched_4bsd.4.html">sched_4bsd</a></u>(4), <u><a href="../man4/sched_ule.4.html">sched_ule</a></u>(4), <u><a href="../man9/SDT.9.html">SDT</a></u>(9), <u><a href="../man9/sleepqueue.9.html">sleepqueue</a></u>(9)

</pre><h4><b>HISTORY</b></h4><pre>
       The <b>sched</b> provider first appeared in FreeBSD 8.4 and 9.1.

</pre><h4><b>AUTHORS</b></h4><pre>
       This manual page was written by Mark Johnston &lt;<u><a href="mailto:markj@FreeBSD.org">markj@FreeBSD.org</a></u>&gt;.

Debian                                           April 18, 2015                                  <u><a href="../man4/DTRACE_SCHED.4.html">DTRACE_SCHED</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>