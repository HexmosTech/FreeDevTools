<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gre — encapsulating network device</title>
    <style>
        body { font-family: monospace; margin: 20px; line-height: 1.4; }
        a { color: #0066cc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div id="main-content">
<section class="p-strip is-bordered">
<div class="row">
<div class="col-3 u-hide--small u-hide" id="toc">
</div>
<div id="tableWrapper">
<p id="distroAndSection"></p>

Provided by: <a href="https://launchpad.net/ubuntu/plucky/+package/freebsd-manpages">freebsd-manpages_12.2-2_all</a> <br><br><pre>
</pre><h4><b>NAME</b></h4><pre>
       gre — encapsulating network device

</pre><h4><b>SYNOPSIS</b></h4><pre>
       To compile the driver into the kernel, place the following line in the kernel configuration file:

             <b>device</b> <b>gre</b>

       Alternatively, to load the driver as a module at boot time, place the following line in <u><a href="../man5/loader.conf.5.html">loader.conf</a></u>(5):

             if_gre_load="YES"

</pre><h4><b>DESCRIPTION</b></h4><pre>
       The <b>gre</b> network interface pseudo device encapsulates datagrams into IP.  These encapsulated datagrams are
       routed  to a destination host, where they are decapsulated and further routed to their final destination.
       The “tunnel” appears to the inner datagrams as one hop.

       <b>gre</b> interfaces are dynamically created and destroyed with the <u><a href="../man8/ifconfig.8.html">ifconfig</a></u>(8) <b>create</b> and <b>destroy</b> subcommands.

       This driver corresponds to RFC 2784.  Encapsulated datagrams are prepended an outer datagram  and  a  GRE
       header.   The  GRE  header  specifies the type of the encapsulated datagram and thus allows for tunneling
       other protocols than IP.  GRE mode is also the default tunnel mode on Cisco routers.  <b>gre</b>  also  supports
       Cisco WCCP protocol, both version 1 and version 2.

       The <b>gre</b> interfaces support a number of additional parameters to the <u><a href="../man8/ifconfig.8.html">ifconfig</a></u>(8):

       <u>grekey</u>       Set the GRE key used for outgoing packets.  A value of 0 disables the key option.

       <u>enable_csum</u>  Enables checksum calculation for outgoing packets.

       <u>enable_seq</u>   Enables use of sequence number field in the GRE header for outgoing packets.

       <u>udpencap</u>     Enables  UDP-in-GRE  encapsulation  (see  the  “GRE-IN-UDP  ENCAPSULATION” Section below for
                    details).

       <u>udpport</u>      Set the source UDP port for outgoing packets.  A value of  0  disables  the  persistence  of
                    source  UDP port for outgoing packets.  See the “GRE-IN-UDP ENCAPSULATION” Section below for
                    details.

</pre><h4><b>GRE-IN-UDP</b> <b>ENCAPSULATION</b></h4><pre>
       The <b>gre</b> supports GRE in UDP encapsulation as defined in RFC  8086.   A  GRE  in  UDP  tunnel  offers  the
       possibility  of better performance for load-balancing GRE traffic in transit networks.  Encapsulating GRE
       in UDP enables use of the UDP source port to provide entropy to ECMP hashing.

       The GRE in UDP tunnel uses single value 4754 as UDP destination port.  The UDP  source  port  contains  a
       14-bit  entropy  value  that  is  generated  by  the encapsulator to identify a flow for the encapsulated
       packet.  The <u>udpport</u> option can be used to disable this behaviour and use single source UDP  port  value.
       The value of <u>udpport</u> should be within the ephemeral port range, i.e., 49152 to 65535 by default.

       Note  that  a GRE in UDP tunnel is unidirectional; the tunnel traffic is not expected to be returned back
       to the UDP source port values used to generate entropy.  This  may  impact  NAPT  (Network  Address  Port
       Translator)  middleboxes.  If such tunnels are expected to be used on a path with a middlebox, the tunnel
       can be configured either to disable use of the UDP source port for entropy or to  enable  middleboxes  to
       pass packets with UDP source port entropy.

</pre><h4><b>EXAMPLES</b></h4><pre>
       192.168.1.* --- Router A  -------tunnel-------- Router B --- 192.168.2.*
                          \                              /
                           \                            /
                            +------ the Internet ------+

       Assuming  router  A  has the (external) IP address A and the internal address 192.168.1.1, while router B
       has external address B and internal address  192.168.2.1,  the  following  commands  will  configure  the
       tunnel:

       On router A:

             ifconfig greN create
             ifconfig greN inet 192.168.1.1 192.168.2.1
             ifconfig greN inet tunnel A B
             route add -net 192.168.2 -netmask 255.255.255.0 192.168.2.1

       On router B:

             ifconfig greN create
             ifconfig greN inet 192.168.2.1 192.168.1.1
             ifconfig greN inet tunnel B A
             route add -net 192.168.1 -netmask 255.255.255.0 192.168.1.1

       In  case  when  internal and external IP addresses are the same, different routing tables (FIB) should be
       used.  The default FIB will be applied to IP packets before GRE encapsulation.  After  encapsulation  GRE
       interface should set different FIB number to outgoing packet.  Then different FIB will be applied to such
       encapsulated packets.  According to this FIB packet should be routed to tunnel endpoint.

       Host X -- Host A (198.51.100.1) ---tunnel--- Cisco D (203.0.113.1) -- Host E
                          \                                   /
                           \                                 /
                            +----- Host B ----- Host C -----+
                              (198.51.100.254)

       On Host A (FreeBSD):

       First of multiple FIBs should be configured via loader.conf:

             net.fibs=2
             net.add_addr_allfibs=0

       Then routes to the gateway and remote tunnel endpoint via this gateway should be added to the second FIB:

             route add -net 198.51.100.0 -netmask 255.255.255.0 -fib 1 -iface em0
             route add -host 203.0.113.1 -fib 1 198.51.100.254

       And GRE tunnel should be configured to change FIB for encapsulated packets:

             ifconfig greN create
             ifconfig greN inet 198.51.100.1 203.0.113.1
             ifconfig greN inet tunnel 198.51.100.1 203.0.113.1 tunnelfib 1

</pre><h4><b>NOTES</b></h4><pre>
       The  MTU of <b>gre</b> interfaces is set to 1476 by default, to match the value used by Cisco routers.  This may
       not be an optimal value, depending on the link between the two tunnel endpoints.  It can be adjusted  via
       <u><a href="../man8/ifconfig.8.html">ifconfig</a></u>(8).

       For  correct operation, the <b>gre</b> device needs a route to the decapsulating host that does not run over the
       tunnel, as this would be a loop.

       The kernel must be set to forward datagrams by setting the <u>net.inet.ip.forwarding</u> <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8)  variable  to
       non-zero.

       By  default,  <b>gre</b>  tunnels  may  not  be nested.  This behavior may be modified at runtime by setting the
       <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8) variable <u>net.link.gre.max_nesting</u> to the desired level of nesting.

</pre><h4><b>SEE</b> <b>ALSO</b></h4><pre>
       <u><a href="../man4/gif.4.html">gif</a></u>(4), <u><a href="../man4/inet.4.html">inet</a></u>(4), <u><a href="../man4/ip.4.html">ip</a></u>(4), <u><a href="../man4/me.4.html">me</a></u>(4), <u><a href="../man4/netintro.4.html">netintro</a></u>(4), <u><a href="../man5/protocols.5.html">protocols</a></u>(5), <u><a href="../man8/ifconfig.8.html">ifconfig</a></u>(8), <u><a href="../man8/sysctl.8.html">sysctl</a></u>(8)

</pre><h4><b>STANDARDS</b></h4><pre>
       S. Hanks, T. Li, D. Farinacci, and P. Traina, <u>Generic</u> <u>Routing</u>  <u>Encapsulation</u>  <u>(GRE)</u>,  RFC  1701,  October
       1994.

       S. Hanks, T. Li, D. Farinacci, and P. Traina, <u>Generic</u> <u>Routing</u> <u>Encapsulation</u> <u>over</u> <u>IPv4</u> <u>networks</u>, RFC 1702,
       October 1994.

       D.  Farinacci,  T.  Li, S. Hanks, D. Meyer, and P. Traina, <u>Generic</u> <u>Routing</u> <u>Encapsulation</u> <u>(GRE)</u>, RFC 2784,
       March 2000.

       G. Dommety, <u>Key</u> <u>and</u> <u>Sequence</u> <u>Number</u> <u>Extensions</u> <u>to</u> <u>GRE</u>, RFC 2890, September 2000.

</pre><h4><b>AUTHORS</b></h4><pre>
       Andrey V. Elsukov &lt;<u><a href="mailto:ae@FreeBSD.org">ae@FreeBSD.org</a></u>&gt;
       Heiko W.Rupp &lt;<u><a href="mailto:hwr@pilhuhn.de">hwr@pilhuhn.de</a></u>&gt;

</pre><h4><b>BUGS</b></h4><pre>
       The current implementation uses the key only for outgoing packets.  Incoming packets with a different key
       or without a key will be treated as if they would belong to this interface.

       The sequence number field also used only for outgoing packets.

Debian                                           August 21, 2020                                          <u><a href="../man4/GRE.4.html">GRE</a></u>(4)
</pre>
 </div>
</div></section>
</div>
</body>
</html>