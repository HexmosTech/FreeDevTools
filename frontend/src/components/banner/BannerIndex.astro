---
import type { Banner as BannerType } from '../../../db/banner/banner-schema';
import {
  getRandomBanner,
  getRandomBannerByType,
} from '../../../db/banner/banner-utils';
import Banner from './Banner.tsx';

interface Props {
  type?: 'banner' | 'text' | 'evergreen';
}

const { type } = Astro.props;

// Get a random banner from the database
let banner: BannerType | null = null;

try {
  banner = type ? getRandomBannerByType(type) : getRandomBanner();
} catch (error) {
  console.error('[Banner] Error loading banner:', error);
  // Continue without banner - don't block page rendering
}

// Prepare banner data for React component
const bannerData = banner
  ? {
      id: banner.id,
      name: banner.name,
      link_type: banner.link_type,
      html_link: banner.html_link,
      js_links: banner.js_links,
    }
  : null;
---

<Banner client:load banner={bannerData} />
