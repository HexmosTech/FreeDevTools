<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loki Promtail Configuration - Log Aggregation Setup</title>
    <meta name="description" content="Configure Loki Promtail for efficient log aggregation. Explore settings for server, ingester, storage, and ruler for robust log management.">
    <meta name="keywords" content="loki, promtail, log aggregation, configuration, logging, devops, sysadmin, log management, prometheus, grafana, yaml">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://your-domain.com/loki/promtail-loki.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-domain.com/loki/promtail-loki.html">
    <meta property="og:title" content="Loki Promtail Configuration - Log Aggregation Setup">
    <meta property="og:description" content="Configure Loki Promtail for efficient log aggregation. Explore settings for server, ingester, storage, and ruler for robust log management.">
    <meta property="og:image" content="https://your-domain.com/path/to/og-image.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://your-domain.com/loki/promtail-loki.html">
    <meta name="twitter:title" content="Loki Promtail Configuration - Log Aggregation Setup">
    <meta name="twitter:description" content="Configure Loki Promtail for efficient log aggregation. Explore settings for server, ingester, storage, and ruler for robust log management.">
    <meta name="twitter:image" content="https://your-domain.com/path/to/twitter-image.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Loki Promtail Configuration</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <p>This document outlines a typical configuration for Loki Promtail, a log collection agent for Loki. Proper configuration is crucial for efficient log aggregation and management within your infrastructure. Below is a detailed breakdown of key settings.</p>

                <h2>Promtail Server Configuration</h2>
                <p>The server section defines how Promtail listens for incoming data and its operational parameters. Key settings include the HTTP listen port.</p>

                <h2>Ingester Settings for Log Processing</h2>
                <p>The ingester configuration dictates how Promtail processes and prepares logs before sending them to Loki. This includes settings for chunking, retention, and retry mechanisms.</p>

                <h2>Storage and Schema Configuration</h2>
                <p>This section details how logs are stored and indexed. It covers the use of boltdb for indexing and filesystem for chunk storage, along with schema versioning and index periods.</p>

                <h2>Ruler and Alerting Setup</h2>
                <p>The ruler configuration enables Promtail to fetch and apply alerting rules. It specifies the rule storage location, alertmanager URL, and API enablement.</p>

                <h2>External Resources for Loki and Promtail</h2>
                <ul>
                    <li><a href="https://grafana.com/docs/loki/latest/clients/promtail/" target="_blank" rel="noopener noreferrer">Promtail Official Documentation</a></li>
                    <li><a href="https://grafana.com/docs/loki/latest/" target="_blank" rel="noopener noreferrer">Loki Official Documentation</a></li>
                    <li><a href="https://prometheus.io/docs/alerting/latest/configuration/" target="_blank" rel="noopener noreferrer">Prometheus Alerting Configuration</a></li>
                    <li><a href="https://github.com/grafana/loki" target="_blank" rel="noopener noreferrer">Loki GitHub Repository</a></li>
                    <li><a href="https://www.json.org/json-en.html" target="_blank" rel="noopener noreferrer">JSON Standard</a></li>
                </ul>

                <pre><code class="language-yaml">auth_enabled: false

server:
  http_listen_port: 3100

ingester:
  lifecycler:
    address: 127.0.0.1
    ring:
      kvstore:
        store: inmemory
      replication_factor: 1
    final_sleep: 0s
  chunk_idle_period: 5m
  chunk_retain_period: 30s
  max_transfer_retries: 0

schema_config:
  configs:
    - from: 2018-04-15
      store: boltdb
      object_store: filesystem
      schema: v11
      index:
        prefix: index_
        period: 168h

storage_config:
  boltdb:
    directory: /tmp/loki/index

  filesystem:
    directory: /tmp/loki/chunks

limits_config:
  enforce_metric_name: false
  reject_old_samples: true
  reject_old_samples_max_age: 168h

chunk_store_config:
  #max_look_back_period: 0s
  max_look_back_period: 168h

table_manager:
  retention_deletes_enabled: true
  #retention_period: 0s
  retention_period: 168h
  
ruler:
  storage:
    type: local
    local:
      directory: /etc/loki/rules
  rule_path: /tmp/loki/rules-temp
  alertmanager_url: http://alertmanager:9090
  ring:
    kvstore:
      store: inmemory
  enable_api: true
</code></pre>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>