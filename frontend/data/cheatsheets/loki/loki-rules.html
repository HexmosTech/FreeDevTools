<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loki Rules - Prometheus Alerting Rules</title>
    <meta name="description" content="Explore and manage Loki alerting rules for Prometheus. Understand HighThroughputLogStreams alerts and optimize your logging infrastructure.">
    <meta name="keywords" content="loki rules, prometheus alerts, log streams, high throughput, alerting, monitoring, grafana, logging, observability, HighThroughputLogStreams">
    <link rel="canonical" href="https://yourdomain.com/loki/loki-rules.html">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/loki/loki-rules.html">
    <meta property="og:title" content="Loki Rules - Prometheus Alerting Rules">
    <meta property="og:description" content="Explore and manage Loki alerting rules for Prometheus. Understand HighThroughputLogStreams alerts and optimize your logging infrastructure.">
    <meta property="og:image" content="https://yourdomain.com/path/to/your/og-image.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://yourdomain.com/loki/loki-rules.html">
    <meta name="twitter:title" content="Loki Rules - Prometheus Alerting Rules">
    <meta name="twitter:description" content="Explore and manage Loki alerting rules for Prometheus. Understand HighThroughputLogStreams alerts and optimize your logging infrastructure.">
    <meta name="twitter:image" content="https://yourdomain.com/path/to/your/twitter-image.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-bottom: 1px solid #34495e;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .content {
            padding: 20px;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
            margin: 0;
        }
        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
        }
        .markdown-content {
            line-height: 1.7;
        }
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
        .markdown-content pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 16px;
            overflow-x: auto;
        }
        .markdown-content code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Loki Rules</h1>
        </div>
        <div class="content">
            <div class="markdown-content">
                <h2>Prometheus Alerting Rules for Loki</h2>
                <p>This section details example Prometheus alerting rules configured for Loki. These rules help in monitoring and alerting on specific log patterns or conditions within your logging infrastructure. Effective alerting is crucial for maintaining the health and performance of your systems.</p>
                
                <h3>HighThroughputLogStreams Alert</h3>
                <p>The following rule, <code>HighThroughputLogStreams</code>, is designed to detect a high volume of log streams within a specified time frame. This can indicate an issue such as excessive logging, a potential denial-of-service attack, or a misbehaving application.</p>
                <pre><code class="language-yaml">groups:
  - name: example
    rules:
    - alert: HighThroughputLogStreams
      expr: sum by (container_name) (count_over_time({container_name=~".*"} |regexp`(?P.*)` [1h])&gt;0)
      for: 20s
      labels:
        severity: "2"
      annotations:
        description: '{{ $labels.instance }} {{ $labels.msg }} memory.'
</code></pre>

                <h3>Understanding the Alert Expression</h3>
                <p>The <code>expr</code> field defines the condition for triggering the alert. In this case, it sums the count of log entries over the last hour for each <code>container_name</code>. If this sum is greater than 0, and the condition persists for 20 seconds (<code>for: 20s</code>), the alert is fired. The <code>regexp</code> part is a placeholder and should be replaced with a specific pattern relevant to your logs.</p>

                <h3>Alert Labels and Annotations</h3>
                <p><code>labels</code> provide metadata for the alert, such as its severity. <code>annotations</code> offer more detailed information, like a descriptive message that can include dynamic labels from the log data, helping operators quickly understand the context of the alert.</p>

                <h3>Best Practices for Loki Alerting</h3>
                <p>When defining Loki alerting rules, consider the following:</p>
                <ul>
                    <li><strong>Specificity:</strong> Make your log pattern matching (<code>regexp</code>) as specific as possible to avoid false positives.</li>
                    <li><strong>Thresholds:</strong> Carefully tune the thresholds (e.g., the time window and count) to match your system's normal behavior.</li>
                    <li><strong>Context:</strong> Ensure your annotations provide enough context for quick diagnosis.</li>
                    <li><strong>Severity:</strong> Assign appropriate severity levels to prioritize responses.</li>
                </ul>
                <p>For more advanced configurations and best practices regarding Prometheus alerting rules, refer to the <a href="https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/" target="_blank" rel="noopener noreferrer">Prometheus Alerting Rules documentation</a> and <a href="https://grafana.com/docs/loki/latest/logql/log_queries/" target="_blank" rel="noopener noreferrer">Loki LogQL documentation</a>.</p>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>